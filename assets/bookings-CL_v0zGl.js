import{c as J,r as p,a as De,j as e,B as N,d as B,l as Me,k as ue,h as xe,t as q}from"./index-Dv1JWxNr.js";import{c as $,u as Te,b as pe,q as U,H as Be,S as _e,a as Pe,T as Fe,P as He,M as Ae}from"./header-company-dropdown--Awgxzay.js";import{n as Ve,C as Ee,s as Ie,e as Oe,a as de,i as Ge,b as G}from"./calendar-C9rlufx7.js";import{P as Z,a as ee,b as se}from"./popover-UlTbB9Ed.js";import{C as te,M as Le}from"./map-pin-DlQzezPx.js";import{c as $e,f as w,s as me}from"./format-BvUxDbfm.js";import{C as je,a as ge,b as fe,c as z,d as W,e as R,D as ae,g as ne,h as re,i as oe,j as le,k as ie}from"./command-DcTOLZl5.js";import{B as _}from"./badge-KVwFvJ3A.js";import{E as L}from"./avatar-BAwvz_Zl.js";import{B as qe,U as X,M as Ue,P as ze}from"./user-CS86DQZu.js";import{C as ye}from"./chevrons-up-down-9TPJUjFl.js";import{C as Y}from"./check-BqR35Gvj.js";import{u as Ne,a as ve,F as we,b,c as C,d as S,e as D,f as M}from"./form-CZQoOBB7.js";import{I as ke}from"./input-B_unVzQI.js";import{T as be}from"./textarea-C-bf1LMq.js";import{S as H,a as A,b as V,c as E,d as I}from"./select-C_Vy9nNB.js";import{o as We,s as Q,e as Re,d as Ye}from"./types-Wky072k2.js";import{S as F}from"./separator-C7xfAAuo.js";import{F as Je}from"./file-text-BOcEHdKV.js";import{P as Ke}from"./plus-DFeVdjI_.js";import"./createReactComponent-DEfHJg2M.js";import"./index-DF1ouENV.js";import"./index-CEbF_H-L.js";import"./index-CHnWnazZ.js";import"./index-GwslycKq.js";import"./index-jslwB8KE.js";import"./index-D-kAnGCt.js";import"./index-BmzB4KP7.js";import"./index-mCotDcwq.js";import"./index-Bx3FAcJY.js";/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],Xe=J("calendar-clock",Qe);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],es=J("calendar-days",Ze);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]],ts=J("calendar-range",ss);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],ns=J("clock",as);function he(t,n){const{start:s,end:m}=Ve(n?.in,t);let d=+s>+m;const o=d?+s:+m,a=d?m:s;a.setHours(0,0,0,0);let r=1;const x=[];for(;+a<=o;)x.push($e(s,a)),a.setDate(a.getDate()+r),a.setHours(0,0,0,0);return d?x.reverse():x}const Ce=p.createContext(void 0);function rs({children:t}){const n=De({strict:!1}),[s,m]=p.useState("calendar"),[d,o]=p.useState("dayGridMonth"),[a,r]=p.useState(new Date),[x,h]=p.useState(null),[i,u]=p.useState(!1),[y,v]=p.useState(!1),[g,j]=p.useState(!1),c=new Date,l=new Date(c.getFullYear(),c.getMonth(),1),f=new Date(c.getFullYear(),c.getMonth()+1,0,23,59,59),[k,P]=p.useState({startTime:Math.floor(l.getTime()/1e3),endTime:Math.floor(f.getTime()/1e3),companies:n.company||void 0});return p.useEffect(()=>{P(K=>({...K,companies:n.company||void 0}))},[n.company]),e.jsx(Ce.Provider,{value:{view:s,setView:m,calendarView:d,setCalendarView:o,filters:k,setFilters:P,selectedDate:a,setSelectedDate:r,selectedBooking:x,setSelectedBooking:h,showCreateModal:i,setShowCreateModal:u,showEditModal:y,setShowEditModal:v,showDetailsModal:g,setShowDetailsModal:j},children:t})}function T(){const t=p.useContext(Ce);if(!t)throw new Error("useBookingsContext must be used within BookingsProvider");return t}function os(){const{selectedDate:t,setSelectedDate:n,filters:s,setFilters:m,calendarView:d}=T(),o=a=>{if(!a)return;n(a);let r,x;switch(d){case"dayGridMonth":{const h=new Date(a.getFullYear(),a.getMonth(),1),i=new Date(a.getFullYear(),a.getMonth()+1,0,23,59,59);r=Math.floor(h.getTime()/1e3),x=Math.floor(i.getTime()/1e3);break}case"timeGridWeek":{const h=new Date(a);h.setDate(a.getDate()-a.getDay()),h.setHours(0,0,0,0);const i=new Date(h);i.setDate(h.getDate()+6),i.setHours(23,59,59,999),r=Math.floor(h.getTime()/1e3),x=Math.floor(i.getTime()/1e3);break}case"timeGridDay":{const h=new Date(a);h.setHours(0,0,0,0);const i=new Date(a);i.setHours(23,59,59,999),r=Math.floor(h.getTime()/1e3),x=Math.floor(i.getTime()/1e3);break}default:return}m({...s,startTime:r,endTime:x})};return e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:B("w-[280px] justify-start text-left font-normal",!t&&"text-muted-foreground"),children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),t?w(t,"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(se,{className:"w-auto p-0",children:e.jsx(Ee,{mode:"single",selected:t,onSelect:o,initialFocus:!0})})]})}function ls(){const{filters:t,setFilters:n}=T(),[s,m]=p.useState(!1),[d,o]=p.useState([]),[a,r]=p.useState(!1),[x,h]=p.useState(""),i=t.properties?.split(",").filter(Boolean)||[];p.useEffect(()=>{u()},[]);const u=async()=>{r(!0);try{const c=await $.post("/api/property/admin/search",{page:1,limit:100,searchTerm:""});o(c.properties||[])}catch{}finally{r(!1)}},y=c=>{const l=i.includes(c);let f;l?f=i.filter(k=>k!==c):f=[...i,c],n({...t,properties:f.join(",")})},v=()=>{i.length===d.length?n({...t,properties:""}):n({...t,properties:d.map(c=>c._id).join(",")})},g=()=>{n({...t,properties:""})},j=d.filter(c=>c.address.toLowerCase().includes(x.toLowerCase())||c.city?.toLowerCase().includes(x.toLowerCase()));return e.jsxs(Z,{open:s,onOpenChange:m,children:[e.jsx(ee,{asChild:!0,children:e.jsxs(N,{variant:"outline",role:"combobox","aria-expanded":s,className:"justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"h-4 w-4"}),e.jsx("span",{children:"Properties"}),i.length>0&&e.jsx(_,{variant:"secondary",className:"ml-2",children:i.length})]}),e.jsx(ye,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(se,{className:"w-[300px] p-0",children:e.jsxs(je,{children:[e.jsx(ge,{placeholder:"Search properties...",value:x,onValueChange:h}),e.jsx(fe,{children:a?e.jsx(z,{children:"Loading..."}):j.length===0?e.jsx(z,{children:"No properties found."}):e.jsxs(e.Fragment,{children:[e.jsx(W,{children:e.jsxs(R,{onSelect:v,className:"justify-between",children:[e.jsx("span",{children:"Select All"}),e.jsx(Y,{className:B("h-4 w-4",i.length===d.length?"opacity-100":"opacity-0")})]})}),e.jsx(W,{heading:"Properties",children:e.jsx(L,{className:"h-[200px]",children:j.map(c=>e.jsxs(R,{onSelect:()=>y(c._id),className:"justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:c.address}),c.city&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[c.city,", ",c.state]})]}),e.jsx(Y,{className:B("h-4 w-4",i.includes(c._id)?"opacity-100":"opacity-0")})]},c._id))})})]})}),i.length>0&&e.jsx("div",{className:"border-t p-2",children:e.jsx(N,{variant:"ghost",size:"sm",onClick:g,className:"w-full",children:"Clear selection"})})]})})]})}function is(){const{filters:t,setFilters:n}=T(),{auth:s}=Me(),[m,d]=p.useState(!1),[o,a]=p.useState([]),[r,x]=p.useState(!1),[h,i]=p.useState(""),u=t.agents?.split(",").filter(Boolean)||[];p.useEffect(()=>{y()},[]);const y=async()=>{x(!0);try{const l=await $.post("/api/users/admin/agents/all",{page:1,limit:100,select:"firstName lastName email company"});a(l.agents||[])}catch{}finally{x(!1)}},v=l=>{const f=u.includes(l);let k;f?k=u.filter(P=>P!==l):k=[...u,l],n({...t,agents:k.join(",")})},g=()=>{u.length===o.length?n({...t,agents:""}):n({...t,agents:o.map(l=>l._id).join(",")})},j=()=>{n({...t,agents:""})},c=o.filter(l=>`${l.firstName} ${l.lastName}`.toLowerCase().includes(h.toLowerCase())||l.email&&l.email.toLowerCase().includes(h.toLowerCase()));return e.jsxs(Z,{open:m,onOpenChange:d,children:[e.jsx(ee,{asChild:!0,children:e.jsxs(N,{variant:"outline",role:"combobox","aria-expanded":m,className:"justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{children:"Agents"}),u.length>0&&e.jsx(_,{variant:"secondary",className:"ml-2",children:u.length})]}),e.jsx(ye,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(se,{className:"w-[300px] p-0",children:e.jsxs(je,{children:[e.jsx(ge,{placeholder:"Search agents...",value:h,onValueChange:i}),e.jsx(fe,{children:r?e.jsx(z,{children:"Loading..."}):c.length===0?e.jsx(z,{children:"No agents found."}):e.jsxs(e.Fragment,{children:[e.jsx(W,{children:e.jsxs(R,{onSelect:g,className:"justify-between",children:[e.jsx("span",{children:"Select All"}),e.jsx(Y,{className:B("h-4 w-4",u.length===o.length?"opacity-100":"opacity-0")})]})}),e.jsx(W,{heading:"Agents",children:e.jsx(L,{className:"h-[200px]",children:c.map(l=>e.jsxs(R,{onSelect:()=>v(l._id),className:"justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-sm",children:[l.firstName," ",l.lastName,l._id===s.user?.userId&&e.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"(You)"})]}),l.email&&e.jsx("span",{className:"text-xs text-muted-foreground",children:l.email})]}),e.jsx(Y,{className:B("h-4 w-4",u.includes(l._id)?"opacity-100":"opacity-0")})]},l._id))})})]})}),u.length>0&&e.jsx("div",{className:"border-t p-2",children:e.jsx(N,{variant:"ghost",size:"sm",onClick:j,className:"w-full",children:"Clear selection"})})]})})]})}function cs(){const{calendarView:t,setCalendarView:n,setSelectedDate:s,filters:m,setFilters:d}=T(),o=a=>{if(a==="today"){const r=new Date;s(r),n("timeGridDay");const x=new Date(r);x.setHours(0,0,0,0);const h=new Date(r);h.setHours(23,59,59,999),d({...m,startTime:Math.floor(x.getTime()/1e3),endTime:Math.floor(h.getTime()/1e3)})}else{n(a);const r=new Date;let x,h;switch(a){case"dayGridMonth":{const i=new Date(r.getFullYear(),r.getMonth(),1),u=new Date(r.getFullYear(),r.getMonth()+1,0,23,59,59);x=Math.floor(i.getTime()/1e3),h=Math.floor(u.getTime()/1e3);break}case"timeGridWeek":{const i=new Date(r);i.setDate(r.getDate()-r.getDay()),i.setHours(0,0,0,0);const u=new Date(i);u.setDate(i.getDate()+6),u.setHours(23,59,59,999),x=Math.floor(i.getTime()/1e3),h=Math.floor(u.getTime()/1e3);break}case"timeGridDay":{const i=new Date(r);i.setHours(0,0,0,0);const u=new Date(r);u.setHours(23,59,59,999),x=Math.floor(i.getTime()/1e3),h=Math.floor(u.getTime()/1e3);break}}d({...m,startTime:x,endTime:h})}};return e.jsxs("div",{className:"flex rounded-md shadow-sm",role:"group",children:[e.jsxs(N,{type:"button",variant:"outline",size:"sm",onClick:()=>o("today"),className:"rounded-r-none",children:[e.jsx(Xe,{className:"h-4 w-4 mr-1"}),"Today"]}),e.jsxs(N,{type:"button",variant:t==="timeGridDay"?"default":"outline",size:"sm",onClick:()=>o("timeGridDay"),className:"rounded-none border-l-0",children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),"Day"]}),e.jsxs(N,{type:"button",variant:t==="timeGridWeek"?"default":"outline",size:"sm",onClick:()=>o("timeGridWeek"),className:"rounded-none border-l-0",children:[e.jsx(ts,{className:"h-4 w-4 mr-1"}),"Week"]}),e.jsxs(N,{type:"button",variant:t==="dayGridMonth"?"default":"outline",size:"sm",onClick:()=>o("dayGridMonth"),className:"rounded-l-none border-l-0",children:[e.jsx(es,{className:"h-4 w-4 mr-1"}),"Month"]})]})}const ce="/api/booking",ds=async t=>{const n=new URLSearchParams;return n.append("companies",t.companies||""),n.append("properties",t.properties||""),n.append("agents",t.agents||""),n.append("firstName",t.firstName||""),n.append("lastName",t.lastName||""),t.startTime&&n.append("startTime",t.startTime.toString()),t.endTime&&n.append("endTime",t.endTime.toString()),t.status&&n.append("status",t.status),t.outcome&&n.append("outcome",t.outcome),await $.get(`${ce}/admin/calendar?${n.toString()}`)},ms=async t=>await $.post(ce,{...t,startTime:Math.floor(t.startTime.getTime()/1e3)}),hs=async(t,n)=>{const s={...n};return n.startTime&&(s.startTime=Math.floor(n.startTime.getTime()/1e3)),await $.patch(`${ce}/${t}`,s)},us=t=>Te({queryKey:U.bookings.list(t),queryFn:()=>ds(t)}),xs=()=>{const t=ue();return pe({mutationFn:ms,onSuccess:()=>{t.invalidateQueries({queryKey:U.bookings.all})}})},ps=()=>{const t=ue();return pe({mutationFn:({id:n,data:s})=>hs(n,s),onSuccess:(n,{id:s})=>{t.invalidateQueries({queryKey:U.bookings.lists()}),t.invalidateQueries({queryKey:U.bookings.detail(s)})}})};function js(){const{filters:t,selectedDate:n,calendarView:s,setSelectedBooking:m,setShowDetailsModal:d}=T(),{data:o=[],isLoading:a}=us(t),r=()=>{const i=Ie(n),u=Oe(n),y=me(i),v=de(u),g=he({start:y,end:v}),j=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],c=l=>o.filter(f=>{const k=new Date(f.startTime*1e3);return G(k,l)});return e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-7 gap-px bg-muted rounded-lg overflow-hidden",children:[j.map(l=>e.jsx("div",{className:"bg-background p-2 text-center text-sm font-medium text-muted-foreground",children:l},l)),g.map((l,f)=>{const k=c(l),P=Ge(l,n),K=G(l,new Date);return e.jsxs("div",{className:B("bg-background min-h-[100px] p-2 border-t",!P&&"text-muted-foreground bg-muted/50"),children:[e.jsx("div",{className:B("text-sm font-medium mb-1",K&&"text-primary"),children:w(l,"d")}),e.jsx(L,{className:"h-[80px]",children:e.jsxs("div",{className:"space-y-1",children:[k.slice(0,3).map(O=>e.jsx("div",{className:"cursor-pointer",onClick:()=>{m(O),d(!0)},children:e.jsxs(_,{variant:O.status==="cancelled"?"destructive":"secondary",className:"w-full justify-start text-xs truncate",children:[w(new Date(O.startTime*1e3),"HH:mm")," - ",O.contact.firstName]})},O._id)),k.length>3&&e.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:["+",k.length-3," more"]})]})})]},f)})]})})},x=()=>{const i=me(n),u=de(n),y=he({start:i,end:u}),v=Array.from({length:24},(j,c)=>c),g=(j,c)=>o.filter(l=>{const f=new Date(l.startTime*1e3);return G(f,j)&&f.getHours()===c});return e.jsx(L,{className:"h-[600px]",children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-8 gap-px bg-muted rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-background p-2"}),y.map(j=>e.jsxs("div",{className:"bg-background p-2 text-center text-sm font-medium",children:[e.jsx("div",{children:w(j,"EEE")}),e.jsx("div",{className:B("text-lg",G(j,new Date)&&"text-primary font-bold"),children:w(j,"d")})]},j.toISOString())),v.map(j=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-background p-2 text-right text-sm text-muted-foreground border-t",children:w(new Date().setHours(j,0,0,0),"HH:mm")},`hour-${j}`),y.map(c=>{const l=g(c,j);return e.jsx("div",{className:"bg-background p-1 border-t border-l min-h-[50px]",children:l.map(f=>e.jsxs(_,{variant:f.status==="cancelled"?"destructive":"secondary",className:"w-full text-xs truncate cursor-pointer mb-1",onClick:()=>{m(f),d(!0)},children:[f.contact.firstName," ",f.contact.lastName]},f._id))},`${c.toISOString()}-${j}`)})]}))]})})})},h=()=>{const i=Array.from({length:24},(y,v)=>v),u=y=>o.filter(v=>{const g=new Date(v.startTime*1e3);return G(g,n)&&g.getHours()===y});return e.jsx(L,{className:"h-[600px]",children:e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"space-y-px",children:i.map(y=>{const v=u(y);return e.jsxs("div",{className:"grid grid-cols-12 gap-4 p-2 border-b",children:[e.jsx("div",{className:"col-span-1 text-right text-sm text-muted-foreground",children:w(new Date().setHours(y,0,0,0),"HH:mm")}),e.jsx("div",{className:"col-span-11 min-h-[50px]",children:v.map(g=>e.jsxs(_,{variant:g.status==="cancelled"?"destructive":"default",className:"cursor-pointer mr-2 mb-2",onClick:()=>{m(g),d(!0)},children:[w(new Date(g.startTime*1e3),"HH:mm")," -",g.contact.firstName," ",g.contact.lastName," -",g.property.address]},g._id))})]},y)})})})})};return a?e.jsx("div",{className:"flex items-center justify-center h-[600px]",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading bookings..."})}):e.jsxs("div",{className:"bg-background rounded-lg border",children:[s==="dayGridMonth"&&r(),s==="timeGridWeek"&&x(),s==="timeGridDay"&&h()]})}const Se=We({propertyId:Q().min(1,"Property is required"),contactId:Q().min(1,"Contact is required"),startTime:Ye({required_error:"Start time is required"}),status:Re(["active","archived","attended","cancelled","incomplete","missed","pending","rescheduled","scheduled","show"]),notes:Q().optional()}),gs=[{_id:"1",address:"123 Main St, Apt 4B"},{_id:"2",address:"456 Oak Ave, Unit 2"},{_id:"3",address:"789 Pine Rd, Suite 100"}],fs=[{_id:"1",firstName:"John",lastName:"Doe",email:"john@example.com"},{_id:"2",firstName:"Jane",lastName:"Smith",email:"jane@example.com"},{_id:"3",firstName:"Bob",lastName:"Johnson",email:"bob@example.com"}],ys=[{value:"scheduled",label:"Scheduled"},{value:"pending",label:"Pending"},{value:"active",label:"Active"},{value:"attended",label:"Attended"},{value:"missed",label:"Missed"},{value:"cancelled",label:"Cancelled"},{value:"rescheduled",label:"Rescheduled"},{value:"show",label:"Show"},{value:"incomplete",label:"Incomplete"},{value:"archived",label:"Archived"}];function Ns(){const{showCreateModal:t,setShowCreateModal:n}=T(),s=xs(),m=Ne({resolver:ve(Se),defaultValues:{propertyId:"",contactId:"",startTime:new Date,status:"scheduled",notes:""}}),d=async o=>{try{await s.mutateAsync(o),q.success("Booking created successfully"),m.reset(),n(!1)}catch{q.error("Failed to create booking")}};return e.jsx(ae,{open:t,onOpenChange:n,children:e.jsxs(ne,{className:"sm:max-w-[625px]",children:[e.jsxs(re,{children:[e.jsx(oe,{children:"Create Booking"}),e.jsx(le,{children:"Schedule a new property showing or appointment."})]}),e.jsx(we,{...m,children:e.jsxs("form",{onSubmit:m.handleSubmit(d),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(b,{control:m.control,name:"propertyId",render:({field:o})=>e.jsxs(C,{children:[e.jsx(S,{children:"Property *"}),e.jsxs(H,{onValueChange:o.onChange,defaultValue:o.value,children:[e.jsx(D,{children:e.jsx(A,{children:e.jsx(V,{placeholder:"Select a property"})})}),e.jsx(E,{children:gs.map(a=>e.jsx(I,{value:a._id,children:a.address},a._id))})]}),e.jsx(M,{})]})}),e.jsx(b,{control:m.control,name:"contactId",render:({field:o})=>e.jsxs(C,{children:[e.jsx(S,{children:"Contact *"}),e.jsxs(H,{onValueChange:o.onChange,defaultValue:o.value,children:[e.jsx(D,{children:e.jsx(A,{children:e.jsx(V,{placeholder:"Select a contact"})})}),e.jsx(E,{children:fs.map(a=>e.jsxs(I,{value:a._id,children:[a.firstName," ",a.lastName]},a._id))})]}),e.jsx(M,{})]})}),e.jsx(b,{control:m.control,name:"startTime",render:({field:o})=>e.jsxs(C,{children:[e.jsx(S,{children:"Date & Time *"}),e.jsx(D,{children:e.jsx(ke,{type:"datetime-local",value:o.value?w(o.value,"yyyy-MM-dd'T'HH:mm"):"",onChange:a=>o.onChange(new Date(a.target.value))})}),e.jsx(M,{})]})}),e.jsx(b,{control:m.control,name:"status",render:({field:o})=>e.jsxs(C,{children:[e.jsx(S,{children:"Status *"}),e.jsxs(H,{onValueChange:o.onChange,defaultValue:o.value,children:[e.jsx(D,{children:e.jsx(A,{children:e.jsx(V,{placeholder:"Select status"})})}),e.jsx(E,{children:ys.map(a=>e.jsx(I,{value:a.value,children:a.label},a.value))})]}),e.jsx(M,{})]})}),e.jsx(b,{control:m.control,name:"notes",render:({field:o})=>e.jsxs(C,{className:"col-span-2",children:[e.jsx(S,{children:"Notes"}),e.jsx(D,{children:e.jsx(be,{placeholder:"Add any additional notes about this booking",className:"resize-none",rows:3,...o})}),e.jsx(M,{})]})})]}),e.jsxs(ie,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsxs(N,{type:"submit",disabled:s.isPending,children:[s.isPending&&e.jsx(xe,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Booking"]})]})]})})]})})}const vs=[{_id:"1",address:"123 Main St, Apt 4B"},{_id:"2",address:"456 Oak Ave, Unit 2"},{_id:"3",address:"789 Pine Rd, Suite 100"}],ws=[{_id:"1",firstName:"John",lastName:"Doe",email:"john@example.com"},{_id:"2",firstName:"Jane",lastName:"Smith",email:"jane@example.com"},{_id:"3",firstName:"Bob",lastName:"Johnson",email:"bob@example.com"}],ks=[{value:"scheduled",label:"Scheduled"},{value:"pending",label:"Pending"},{value:"active",label:"Active"},{value:"attended",label:"Attended"},{value:"missed",label:"Missed"},{value:"cancelled",label:"Cancelled"},{value:"rescheduled",label:"Rescheduled"},{value:"show",label:"Show"},{value:"incomplete",label:"Incomplete"},{value:"archived",label:"Archived"}];function bs(){const{showEditModal:t,setShowEditModal:n,selectedBooking:s}=T(),m=ps(),d=Ne({resolver:ve(Se),defaultValues:{propertyId:"",contactId:"",startTime:new Date,status:"scheduled",notes:""}});p.useEffect(()=>{s&&d.reset({propertyId:s.property._id,contactId:s.contact._id,startTime:new Date(s.startTime*1e3),status:s.status,notes:s.notes||""})},[s,d]);const o=async a=>{if(s)try{await m.mutateAsync({id:s._id,data:a}),q.success("Booking updated successfully"),n(!1)}catch{q.error("Failed to update booking")}};return s?e.jsx(ae,{open:t,onOpenChange:n,children:e.jsxs(ne,{className:"sm:max-w-[625px]",children:[e.jsxs(re,{children:[e.jsx(oe,{children:"Edit Booking"}),e.jsx(le,{children:"Update the booking details below."})]}),e.jsx(we,{...d,children:e.jsxs("form",{onSubmit:d.handleSubmit(o),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(b,{control:d.control,name:"propertyId",render:({field:a})=>e.jsxs(C,{children:[e.jsx(S,{children:"Property *"}),e.jsxs(H,{onValueChange:a.onChange,value:a.value,children:[e.jsx(D,{children:e.jsx(A,{children:e.jsx(V,{placeholder:"Select a property"})})}),e.jsx(E,{children:vs.map(r=>e.jsx(I,{value:r._id,children:r.address},r._id))})]}),e.jsx(M,{})]})}),e.jsx(b,{control:d.control,name:"contactId",render:({field:a})=>e.jsxs(C,{children:[e.jsx(S,{children:"Contact *"}),e.jsxs(H,{onValueChange:a.onChange,value:a.value,children:[e.jsx(D,{children:e.jsx(A,{children:e.jsx(V,{placeholder:"Select a contact"})})}),e.jsx(E,{children:ws.map(r=>e.jsxs(I,{value:r._id,children:[r.firstName," ",r.lastName]},r._id))})]}),e.jsx(M,{})]})}),e.jsx(b,{control:d.control,name:"startTime",render:({field:a})=>e.jsxs(C,{children:[e.jsx(S,{children:"Date & Time *"}),e.jsx(D,{children:e.jsx(ke,{type:"datetime-local",value:a.value?w(a.value,"yyyy-MM-dd'T'HH:mm"):"",onChange:r=>a.onChange(new Date(r.target.value))})}),e.jsx(M,{})]})}),e.jsx(b,{control:d.control,name:"status",render:({field:a})=>e.jsxs(C,{children:[e.jsx(S,{children:"Status *"}),e.jsxs(H,{onValueChange:a.onChange,value:a.value,children:[e.jsx(D,{children:e.jsx(A,{children:e.jsx(V,{placeholder:"Select status"})})}),e.jsx(E,{children:ks.map(r=>e.jsx(I,{value:r.value,children:r.label},r.value))})]}),e.jsx(M,{})]})}),e.jsx(b,{control:d.control,name:"notes",render:({field:a})=>e.jsxs(C,{className:"col-span-2",children:[e.jsx(S,{children:"Notes"}),e.jsx(D,{children:e.jsx(be,{placeholder:"Add any additional notes about this booking",className:"resize-none",rows:3,...a})}),e.jsx(M,{})]})})]}),e.jsxs(ie,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsxs(N,{type:"submit",disabled:m.isPending,children:[m.isPending&&e.jsx(xe,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Booking"]})]})]})})]})}):null}const Cs={scheduled:"default",pending:"secondary",active:"default",attended:"default",missed:"destructive",cancelled:"destructive",rescheduled:"secondary",show:"default",incomplete:"secondary",archived:"secondary"};function Ss(){const{showDetailsModal:t,setShowDetailsModal:n,selectedBooking:s,setShowEditModal:m}=T();if(!s)return null;const d=()=>{n(!1),m(!0)};return e.jsx(ae,{open:t,onOpenChange:n,children:e.jsxs(ne,{className:"sm:max-w-[625px]",children:[e.jsxs(re,{children:[e.jsx(oe,{children:"Booking Details"}),e.jsx(le,{children:"View complete information about this booking."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{variant:Cs[s.status],children:s.status.charAt(0).toUpperCase()+s.status.slice(1)}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(te,{className:"mr-1 h-4 w-4"}),w(new Date(s.startTime*1e3),"PPP"),e.jsx(ns,{className:"ml-3 mr-1 h-4 w-4"}),w(new Date(s.startTime*1e3),"p")]})]}),e.jsx(F,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"font-semibold flex items-center",children:[e.jsx(Le,{className:"mr-2 h-4 w-4"}),"Property"]}),e.jsxs("div",{className:"ml-6 space-y-1",children:[e.jsx("p",{className:"text-sm",children:s.property.address}),s.property.unitNumber&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Unit: ",s.property.unitNumber]}),s.property.city&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.property.city,", ",s.property.state," ",s.property.zipCode]})]})]}),e.jsx(F,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"font-semibold flex items-center",children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Contact"]}),e.jsxs("div",{className:"ml-6 space-y-1",children:[e.jsxs("p",{className:"text-sm font-medium",children:[s.contact.firstName," ",s.contact.lastName]}),s.contact.email&&e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center",children:[e.jsx(Ue,{className:"mr-2 h-3 w-3"}),s.contact.email]}),s.contact.phone&&e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center",children:[e.jsx(ze,{className:"mr-2 h-3 w-3"}),s.contact.phone]})]})]}),e.jsx(F,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"font-semibold flex items-center",children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Agent"]}),e.jsxs("div",{className:"ml-6 space-y-1",children:[e.jsxs("p",{className:"text-sm font-medium",children:[s.user.firstName," ",s.user.lastName]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.user.email}),s.user.company&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.user.company.name})]})]}),s.notes&&e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"font-semibold flex items-center",children:[e.jsx(Je,{className:"mr-2 h-4 w-4"}),"Notes"]}),e.jsx("p",{className:"ml-6 text-sm text-muted-foreground",children:s.notes})]})]}),s.outcome&&e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold",children:"Outcome"}),e.jsx(_,{variant:"outline",className:"ml-6",children:s.outcome.replace(/_/g," ").charAt(0).toUpperCase()+s.outcome.replace(/_/g," ").slice(1)})]})]}),e.jsx(F,{}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Created: ",w(new Date(s.createdAt),"PPp")]}),e.jsxs("span",{children:["Updated: ",w(new Date(s.updatedAt),"PPp")]})]})]}),e.jsxs(ie,{children:[e.jsx(N,{variant:"outline",onClick:()=>n(!1),children:"Close"}),e.jsx(N,{onClick:d,children:"Edit Booking"})]})]})})}function Ds(){const{setShowCreateModal:t}=T();return e.jsxs(e.Fragment,{children:[e.jsxs(Be,{fixed:!0,children:[e.jsx(_e,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(Pe,{}),e.jsx(Fe,{}),e.jsx(He,{})]})]}),e.jsxs(Ae,{children:[e.jsxs("div",{className:"mb-2 flex flex-wrap items-center justify-between space-y-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Bookings Calendar"}),e.jsx("p",{className:"text-muted-foreground",children:"View and manage all property showings and appointments"})]}),e.jsxs(N,{onClick:()=>t(!0),children:[e.jsx(Ke,{className:"mr-2 h-4 w-4"}),"New Booking"]})]}),e.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[e.jsx(os,{}),e.jsx(ls,{}),e.jsx(is,{}),e.jsx("div",{className:"ml-auto",children:e.jsx(cs,{})})]}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1",children:e.jsx(js,{})})]}),e.jsx(Ns,{}),e.jsx(bs,{}),e.jsx(Ss,{})]})}function Ms(){return e.jsx(rs,{children:e.jsx(Ds,{})})}const rt=Ms;export{rt as component};
