import{o as u,D as p,Q as g,p as f,q as x,z as h,C,E as P,F as j,I as F,J as E,K as y,r as w,m as v,j as e,d as I,B as D,t as d,L as A}from"./index-cvfesu4Z.js";import{C as S,a as N,b as U,d as b,c as R,e as T}from"./card-DM8jAgIW.js";import{A as L}from"./auth-layout-DV7iAPdQ.js";import{u as _,a as M,F as V,b as O,c as k,d as z,e as H,f as B}from"./form-CYFI6-M3.js";import{I as W}from"./input-BiF3jSXw.js";import{a as q,A as G}from"./assertValidationError-DfcZDcsF.js";import{o as J,s as K}from"./types-Wky072k2.js";import"./index-BCdlhwW_.js";const Q=r=>u(x,f("ForgotPassword"),g(),{...p,...r});async function X(r){const{username:o}=r;q(!!o,G.EmptyResetPasswordUsername);const t=h.getConfig().Auth?.Cognito;C(t);const{userPoolClientId:n,userPoolId:l,userPoolEndpoint:i}=t,c=r.options?.clientMetadata,a=P({username:o,userPoolId:l,userPoolClientId:n}),m=(await Q({endpointResolver:y({endpointOverride:i})})({region:F(l),userAgentValue:j(E.ResetPassword)},{Username:o,ClientMetadata:c,ClientId:n,UserContextData:a})).CodeDeliveryDetails;return{isPasswordReset:!1,nextStep:{resetPasswordStep:"CONFIRM_RESET_PASSWORD_WITH_CODE",codeDeliveryDetails:{deliveryMedium:m?.DeliveryMedium,destination:m?.Destination,attributeName:m?.AttributeName}}}}const Y=J({email:K().min(1,{message:"Please enter your email"}).email({message:"Invalid email address"})});function Z({className:r,...o}){const[t,n]=w.useState(!1),l=v(),i=_({resolver:M(Y),defaultValues:{email:""}});async function c(a){n(!0);try{await X({username:a.email}),d.success("Password reset code sent to your email"),l({to:"/otp",search:{email:a.email}})}catch(s){s instanceof Error&&s.name==="UserNotFoundException"?d.error("No account found with this email address"):s instanceof Error&&s.name==="InvalidParameterException"?d.error("Invalid email format"):d.error(s instanceof Error?s.message:"Failed to send reset code")}finally{n(!1)}}return e.jsx(V,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(c),className:I("grid gap-2",r),...o,children:[e.jsx(O,{control:i.control,name:"email",render:({field:a})=>e.jsxs(k,{className:"space-y-1",children:[e.jsx(z,{children:"Email"}),e.jsx(H,{children:e.jsx(W,{placeholder:"name@example.com",...a})}),e.jsx(B,{})]})}),e.jsx(D,{className:"mt-2",disabled:t,children:t?"Sending...":"Continue"})]})})}function $(){return e.jsx(L,{children:e.jsxs(S,{className:"gap-4",children:[e.jsxs(N,{children:[e.jsx(U,{className:"text-lg tracking-tight",children:"Forgot Password"}),e.jsxs(b,{children:["Enter your registered email and ",e.jsx("br",{})," we will send you a link to reset your password."]})]}),e.jsx(R,{children:e.jsx(Z,{})}),e.jsx(T,{children:e.jsxs("p",{className:"text-muted-foreground px-8 text-center text-sm",children:["Don't have an account?"," ",e.jsx(A,{to:"/sign-up",className:"hover:text-primary underline underline-offset-4",children:"Sign up"}),"."]})})]})})}const de=$;export{de as component};
