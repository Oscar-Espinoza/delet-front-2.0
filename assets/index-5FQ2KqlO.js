import{r as D,f as W,t as O,j as e,B as V,e as J,d as z}from"./index-CsPbyjqq.js";import{A as ke,I as be,a as we}from"./alert-BtjweUsc.js";import{u as U,b as X,q as H,H as fe,S as Ie,a as Ce,T as Se,P as De,M as Ne}from"./theme-switch-BkO31Og6.js";import{s as Ve}from"./show-submitted-data-BHqgJZrc.js";import{A as Fe,a as He,b as Me,c as Le,d as Te,e as _e,f as Ae,g as Ee}from"./alert-dialog-DWkdR42t.js";import{u as Z,a as ee,F as ae,b as u,c as h,d as x,e as m,f as p}from"./form-DKoAMwr-.js";import{D as re,a as se,b as oe,c as ne,d as le,e as te,C as Oe,f as ze,g as Pe,h as Ke,i as Q,j as $,k as Re}from"./command-DOxIIFlo.js";import{I as k}from"./input-5SQVrAtH.js";import{S as w,a as f,b as I,c as C,d as j}from"./select-CcSKRIFJ.js";import{T as P}from"./textarea-DKq9H4p7.js";import{h as _}from"./hardware-api-i12_pP4F.js";import{e as S,o as g,s as t,a as B,c as E,b as qe}from"./types-Wky072k2.js";import{u as Be,D as Ue}from"./use-data-table-Cl1qhkDL.js";import{B as M}from"./badge-Dwoct147.js";import{C as Y}from"./checkbox-CKYs508e.js";import{D as N}from"./data-table-column-header-CQlxrAjV.js";import{D as ie,e as Qe,f as ce,g as de,h as ue,i as R,$ as $e,B as Ye,z as Ge}from"./avatar-Dwr00yMn.js";import{c as F}from"./createReactComponent-BW_frDSn.js";import{I as We}from"./IconEye-CgK0acQ6.js";import{I as Je}from"./IconEdit-CxoO5XKc.js";import{I as Xe}from"./IconTrash-CGWt8tjB.js";import{P as Ze,C as ea,M as aa,a as ra}from"./react-icons.esm-B0xYXpOp.js";import{P as sa,a as oa,b as na}from"./popover-segQm2pA.js";import{S as la}from"./separator-c02Ge6Zo.js";import{I as ta}from"./IconPlus-DZ4QqQhf.js";import"./index-D3GDyaHS.js";import"./index-BjDkRKFr.js";import"./index-BWqx2Go7.js";import"./index-DMmlQz9C.js";import"./index-DSb8P5hH.js";import"./index-DMPFB69W.js";import"./index-DZz0vwHh.js";import"./index-BB0IJgGb.js";import"./check-D2987ydO.js";import"./table-D4KWq3W4.js";import"./index-CzDhUyC5.js";/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ia=F("outline","box","IconBox",[["path",{d:"M12 3l8 4.5l0 9l-8 4.5l-8 -4.5l0 -9l8 -4.5",key:"svg-0"}],["path",{d:"M12 12l8 -4.5",key:"svg-1"}],["path",{d:"M12 12l0 9",key:"svg-2"}],["path",{d:"M12 12l-8 -4.5",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ca=F("outline","broadcast","IconBroadcast",[["path",{d:"M18.364 19.364a9 9 0 1 0 -12.728 0",key:"svg-0"}],["path",{d:"M15.536 16.536a5 5 0 1 0 -7.072 0",key:"svg-1"}],["path",{d:"M12 13m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var da=F("outline","camera","IconCamera",[["path",{d:"M5 7h1a2 2 0 0 0 2 -2a1 1 0 0 1 1 -1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-9a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M9 13a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ua=F("outline","device-tablet","IconDeviceTablet",[["path",{d:"M5 4a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v16a1 1 0 0 1 -1 1h-12a1 1 0 0 1 -1 -1v-16z",key:"svg-0"}],["path",{d:"M11 17a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ha=F("outline","dots","IconDots",[["path",{d:"M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var xa=F("outline","keyboard","IconKeyboard",[["path",{d:"M2 6m0 2a2 2 0 0 1 2 -2h16a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-16a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M6 10l0 .01",key:"svg-1"}],["path",{d:"M10 10l0 .01",key:"svg-2"}],["path",{d:"M14 10l0 .01",key:"svg-3"}],["path",{d:"M18 10l0 .01",key:"svg-4"}],["path",{d:"M6 14l0 .01",key:"svg-5"}],["path",{d:"M18 14l0 .01",key:"svg-6"}],["path",{d:"M10 14l4 .01",key:"svg-7"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ma=F("outline","radar","IconRadar",[["path",{d:"M21 12h-8a1 1 0 1 0 -1 1v8a9 9 0 0 0 9 -9",key:"svg-0"}],["path",{d:"M16 9a5 5 0 1 0 -7 7",key:"svg-1"}],["path",{d:"M20.486 9a9 9 0 1 0 -11.482 11.495",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var pa=F("outline","router","IconRouter",[["path",{d:"M3 13m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v4a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M17 17l0 .01",key:"svg-1"}],["path",{d:"M13 17l0 .01",key:"svg-2"}],["path",{d:"M15 13l0 -2",key:"svg-3"}],["path",{d:"M11.75 8.75a4 4 0 0 1 6.5 0",key:"svg-4"}],["path",{d:"M8.5 6.5a8 8 0 0 1 13 0",key:"svg-5"}]]);const he=D.createContext(void 0);function L(){const r=D.useContext(he);if(!r)throw new Error("useHardwareContext must be used within HardwareProvider");return r}function ja(r){return U({queryKey:H.hardware.list(r),queryFn:()=>_.list(r),staleTime:5*60*1e3})}function ga(){const r=W();return X({mutationFn:n=>_.create(n),onSuccess:()=>{r.invalidateQueries({queryKey:H.hardware.all}),O.success("Hardware created successfully")},onError:()=>{O.error("Failed to create hardware")}})}function va(){const r=W();return X({mutationFn:({id:n,data:o})=>_.update(n,o),onMutate:async({id:n,data:o})=>{await r.cancelQueries({queryKey:H.hardware.detail(n)});const i=r.getQueryData(H.hardware.detail(n));return i&&r.setQueryData(H.hardware.detail(n),{...i,...o}),{previousHardware:i}},onError:(n,o,i)=>{i?.previousHardware&&r.setQueryData(H.hardware.detail(o.id),i.previousHardware),O.error("Failed to update hardware")},onSuccess:()=>{r.invalidateQueries({queryKey:H.hardware.all}),O.success("Hardware updated successfully")}})}function ya(){return U({queryKey:["august-locks"],queryFn:()=>_.getLocksList(),staleTime:5*60*1e3,enabled:!1})}function ka(){return U({queryKey:["august-serial-numbers"],queryFn:()=>_.getSNList(),staleTime:5*60*1e3,enabled:!1})}const xe=S(["router","tablet","camera","lock","lockbox","keypad","hub","sensor"]),me=S(["active","disabled"]),ba=S(["online","offline","unknown"]),wa=S(["online","offline","unknown"]),K=S(["august","switchbot","yale"]),pe=S(["igloo","puroma","master-lock"]),je=S(["switchbot"]),ge=S(["twilio","agora"]),ve=S(["v1","v2"]),fa=S(["lock_state_battery_warning_none","lock_state_battery_warning_2week","lock_state_battery_warning_1week","lock_state_battery_warning_2day","keypad_battery_none","keypad_battery_warning","keypad_battery_critical"]);g({_id:t(),name:t().optional(),description:t().optional(),notes:t().optional(),inventoryId:t().optional(),tags:B(t()).optional(),category:xe.optional(),status:me.default("active"),user:g({_id:t(),name:t().optional(),email:t().optional()}).optional(),kit:g({_id:t(),name:t().optional()}).optional(),account:g({_id:t(),name:t().optional()}).optional(),org:g({_id:t(),name:t().optional()}).optional(),property:g({_id:t(),name:t().optional(),address:t().optional()}).optional(),model:t().optional(),serial:t().optional(),router:g({id:t().optional(),status:wa.default("unknown")}).optional(),lock:g({id:t().optional(),vendor:K.optional()}).optional(),lockbox:g({id:t().optional(),vendor:pe.optional()}).optional(),hub:g({lockId:t().optional()}).optional(),sensor:g({lockId:t().optional()}).optional(),button:g({id:t().optional(),time:E().optional(),vendor:je.optional()}).optional(),keypad:g({id:t().optional(),vendor:K.optional()}).optional(),tablet:g({dropin:ge.optional()}).optional(),cameraFirmware:ve.optional(),zm:g({status:t().optional(),active:qe().default(!1),monitorId:E().optional()}).optional(),structure:g({_id:t(),name:t().optional()}).optional(),make:t().default("ezvizdirect"),accounts:B(g({_id:t(),name:t().optional()})).optional(),battery:g({warningLevel:g({message:fa.optional(),lastUpdated:t().optional()}).optional(),level:E().default(100)}).optional(),operationalStatus:ba.default("online"),createdAt:t().optional(),updatedAt:t().optional()});const ye=g({name:t().min(1,"Name is required"),description:t().optional(),notes:t().optional(),inventoryId:t().optional(),tags:B(t()).optional(),category:xe.optional(),status:me.optional(),userId:t().optional(),kitId:t().optional(),accountId:t().optional(),orgId:t().optional(),propertyId:t().optional(),model:t().optional(),serial:t().optional(),structureId:t().optional(),make:t().optional(),routerId:t().optional(),routerStatus:S(["online","offline","unknown"]).optional(),lockId:t().optional(),lockVendor:K.optional(),lockboxId:t().optional(),lockboxVendor:pe.optional(),hubLockId:t().optional(),sensorLockId:t().optional(),buttonId:t().optional(),buttonTime:E().optional(),buttonVendor:je.optional(),keypadId:t().optional(),keypadVendor:K.optional(),tabletDropin:ge.optional(),cameraFirmware:ve.optional()}),Ia=[{value:"router",label:"Router"},{value:"tablet",label:"Tablet"},{value:"camera",label:"Camera"},{value:"lock",label:"Lock"},{value:"lockbox",label:"Lockbox"},{value:"keypad",label:"Keypad"},{value:"hub",label:"Hub"},{value:"sensor",label:"Sensor"}],Ca=[{value:"active",label:"Active"},{value:"disabled",label:"Disabled"}];function Sa(){const{isCreateDialogOpen:r,setIsCreateDialogOpen:n}=L(),o=ga(),i=ya(),c=ka(),l=Z({resolver:ee(ye),defaultValues:{name:"",description:"",notes:"",inventoryId:"",tags:[],status:"active",make:"ezvizdirect"}}),y=async a=>{try{const d={name:a.name,description:a.description,notes:a.notes,inventoryId:a.inventoryId,tags:a.tags,category:a.category,status:a.status,model:a.model,serial:a.serial,make:a.make};a.category==="router"&&(a.routerId||a.routerStatus)&&(d.router={id:a.routerId,status:a.routerStatus||"unknown"}),a.category==="lock"&&(a.lockId||a.lockVendor)&&(d.lock={id:a.lockId,vendor:a.lockVendor}),a.category==="lockbox"&&(a.lockboxId||a.lockboxVendor)&&(d.lockbox={id:a.lockboxId,vendor:a.lockboxVendor}),a.category==="hub"&&a.hubLockId&&(d.hub={lockId:a.hubLockId}),a.category==="sensor"&&a.sensorLockId&&(d.sensor={lockId:a.sensorLockId}),a.category==="keypad"&&(a.keypadId||a.keypadVendor)&&(d.keypad={id:a.keypadId,vendor:a.keypadVendor}),a.category==="tablet"&&a.tabletDropin&&(d.tablet={dropin:a.tabletDropin}),a.category==="camera"&&a.cameraFirmware&&(d.cameraFirmware=a.cameraFirmware),await o.mutateAsync(d),l.reset(),n(!1)}catch{}},v=l.watch("category"),b=l.watch("lockVendor");D.useEffect(()=>{v==="lock"&&(b==="august"||b==="yale")&&(i.refetch(),c.refetch())},[v,b,i,c]);const s=a=>{const d=i.data?.find(T=>T.id===a),A=c.data?.find(T=>T.LockID===a);if(d){l.setValue("name",d.name,{shouldDirty:!0,shouldTouch:!0,shouldValidate:!0}),l.setValue("lockId",a,{shouldDirty:!0,shouldTouch:!0,shouldValidate:!0});const T=A?A.serialNumber:"";l.setValue("serial",T,{shouldDirty:!0,shouldTouch:!0,shouldValidate:!0}),l.trigger(["name","serial","lockId"])}};return e.jsx(re,{open:r,onOpenChange:n,children:e.jsxs(se,{className:"sm:max-w-[625px]",children:[e.jsxs(oe,{children:[e.jsx(ne,{children:"Add Hardware"}),e.jsx(le,{children:"Create a new hardware device in the system."})]}),e.jsx(ae,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(y),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(u,{control:l.control,name:"name",render:({field:a})=>e.jsxs(h,{children:[e.jsx(x,{children:"Name *"}),e.jsx(m,{children:e.jsx(k,{placeholder:"Enter hardware name",...a})}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"category",render:({field:a})=>e.jsxs(h,{children:[e.jsx(x,{children:"Category"}),e.jsxs(w,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(m,{children:e.jsx(f,{children:e.jsx(I,{placeholder:"Select category"})})}),e.jsx(C,{children:Ia.map(d=>e.jsx(j,{value:d.value,children:d.label},d.value))})]}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"inventoryId",render:({field:a})=>e.jsxs(h,{children:[e.jsx(x,{children:"Inventory ID"}),e.jsx(m,{children:e.jsx(k,{placeholder:"Enter inventory ID",...a})}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"status",render:({field:a})=>e.jsxs(h,{children:[e.jsx(x,{children:"Status"}),e.jsxs(w,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(m,{children:e.jsx(f,{children:e.jsx(I,{placeholder:"Select status"})})}),e.jsx(C,{children:Ca.map(d=>e.jsx(j,{value:d.value,children:d.label},d.value))})]}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"model",render:({field:a})=>e.jsxs(h,{children:[e.jsx(x,{children:"Model"}),e.jsx(m,{children:e.jsx(k,{placeholder:"Enter model",...a})}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"serial",render:({field:a})=>e.jsxs(h,{children:[e.jsx(x,{children:"Serial Number"}),e.jsx(m,{children:e.jsx(k,{placeholder:"Enter serial number",...a})}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"description",render:({field:a})=>e.jsxs(h,{className:"col-span-2",children:[e.jsx(x,{children:"Description"}),e.jsx(m,{children:e.jsx(P,{placeholder:"Enter hardware description",className:"resize-none",rows:3,...a})}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"notes",render:({field:a})=>e.jsxs(h,{className:"col-span-2",children:[e.jsx(x,{children:"Notes"}),e.jsx(m,{children:e.jsx(P,{placeholder:"Add any additional notes",className:"resize-none",rows:3,...a})}),e.jsx(p,{})]})}),v==="router"&&e.jsxs(e.Fragment,{children:[e.jsx(u,{control:l.control,name:"routerId",render:({field:a})=>e.jsxs(h,{children:[e.jsx(x,{children:"Router ID"}),e.jsx(m,{children:e.jsx(k,{placeholder:"Enter router ID",...a})}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"routerStatus",render:({field:a})=>e.jsxs(h,{children:[e.jsx(x,{children:"Router Status"}),e.jsxs(w,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(m,{children:e.jsx(f,{children:e.jsx(I,{placeholder:"Select status"})})}),e.jsxs(C,{children:[e.jsx(j,{value:"online",children:"Online"}),e.jsx(j,{value:"offline",children:"Offline"}),e.jsx(j,{value:"unknown",children:"Unknown"})]})]}),e.jsx(p,{})]})})]}),v==="lock"&&e.jsxs(e.Fragment,{children:[e.jsx(u,{control:l.control,name:"lockVendor",render:({field:a})=>e.jsxs(h,{children:[e.jsx(x,{children:"Lock Vendor"}),e.jsxs(w,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(m,{children:e.jsx(f,{children:e.jsx(I,{placeholder:"Select vendor"})})}),e.jsxs(C,{children:[e.jsx(j,{value:"august",children:"August"}),e.jsx(j,{value:"switchbot",children:"SwitchBot"}),e.jsx(j,{value:"yale",children:"Yale"})]})]}),e.jsx(p,{})]})}),b==="august"||b==="yale"?e.jsx(u,{control:l.control,name:"lockId",render:({field:a})=>e.jsxs(h,{children:[e.jsx(x,{children:"Select Lock"}),e.jsxs(w,{onValueChange:d=>{a.onChange(d),!i.isLoading&&!c.isLoading&&i.data&&c.data&&s(d)},defaultValue:a.value,disabled:i.isLoading||c.isLoading,children:[e.jsx(m,{children:e.jsx(f,{children:e.jsx(I,{placeholder:i.isLoading?"Loading locks...":"Select lock"})})}),e.jsxs(C,{children:[i.isError&&e.jsx(j,{value:"",disabled:!0,children:"Error loading locks"}),i.data?.map(d=>e.jsx(j,{value:d.id,children:d.name},d.id)),i.data?.length===0&&e.jsx(j,{value:"",disabled:!0,children:"No locks available"})]})]}),e.jsx(p,{})]})}):e.jsx(u,{control:l.control,name:"lockId",render:({field:a})=>e.jsxs(h,{children:[e.jsx(x,{children:"Lock ID"}),e.jsx(m,{children:e.jsx(k,{placeholder:"Enter lock ID",...a})}),e.jsx(p,{})]})})]}),v==="camera"&&e.jsx(u,{control:l.control,name:"cameraFirmware",render:({field:a})=>e.jsxs(h,{className:"col-span-2",children:[e.jsx(x,{children:"Camera Firmware"}),e.jsxs(w,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(m,{children:e.jsx(f,{children:e.jsx(I,{placeholder:"Select firmware"})})}),e.jsxs(C,{children:[e.jsx(j,{value:"v1",children:"Version 1"}),e.jsx(j,{value:"v2",children:"Version 2"})]})]}),e.jsx(p,{})]})})]}),e.jsxs(te,{children:[e.jsx(V,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsxs(V,{type:"submit",disabled:o.isPending,children:[o.isPending&&e.jsx(J,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Hardware"]})]})]})})]})})}const Da=[{value:"router",label:"Router"},{value:"tablet",label:"Tablet"},{value:"camera",label:"Camera"},{value:"lock",label:"Lock"},{value:"lockbox",label:"Lockbox"},{value:"keypad",label:"Keypad"},{value:"hub",label:"Hub"},{value:"sensor",label:"Sensor"}],Na=[{value:"active",label:"Active"},{value:"disabled",label:"Disabled"}];function Va(){const{isEditDialogOpen:r,setIsEditDialogOpen:n,editingHardware:o,setEditingHardware:i}=L(),c=va(),l=Z({resolver:ee(ye),defaultValues:{name:"",description:"",notes:"",inventoryId:"",tags:[],status:"active",make:"ezvizdirect"}});D.useEffect(()=>{o&&l.reset({name:o.name||"",description:o.description||"",notes:o.notes||"",inventoryId:o.inventoryId||"",tags:o.tags||[],category:o.category,status:o.status||"active",model:o.model||"",serial:o.serial||"",make:o.make||"ezvizdirect",userId:o.user?._id,kitId:o.kit?._id,accountId:o.account?._id,orgId:o.org?._id,propertyId:o.property?._id,structureId:o.structure?._id,routerId:o.router?.id,routerStatus:o.router?.status,lockId:o.lock?.id,lockVendor:o.lock?.vendor,lockboxId:o.lockbox?.id,lockboxVendor:o.lockbox?.vendor,hubLockId:o.hub?.lockId,sensorLockId:o.sensor?.lockId,buttonId:o.button?.id,buttonTime:o.button?.time,buttonVendor:o.button?.vendor,keypadId:o.keypad?.id,keypadVendor:o.keypad?.vendor,tabletDropin:o.tablet?.dropin,cameraFirmware:o.cameraFirmware})},[o,l]);const y=async s=>{if(o)try{const a={name:s.name,description:s.description,notes:s.notes,inventoryId:s.inventoryId,tags:s.tags,category:s.category,status:s.status,model:s.model,serial:s.serial,make:s.make};s.category==="router"&&(s.routerId||s.routerStatus)&&(a.router={id:s.routerId,status:s.routerStatus||"unknown"}),s.category==="lock"&&(s.lockId||s.lockVendor)&&(a.lock={id:s.lockId,vendor:s.lockVendor}),s.category==="lockbox"&&(s.lockboxId||s.lockboxVendor)&&(a.lockbox={id:s.lockboxId,vendor:s.lockboxVendor}),s.category==="hub"&&s.hubLockId&&(a.hub={lockId:s.hubLockId}),s.category==="sensor"&&s.sensorLockId&&(a.sensor={lockId:s.sensorLockId}),s.category==="keypad"&&(s.keypadId||s.keypadVendor)&&(a.keypad={id:s.keypadId,vendor:s.keypadVendor}),s.category==="tablet"&&s.tabletDropin&&(a.tablet={dropin:s.tabletDropin}),s.category==="camera"&&s.cameraFirmware&&(a.cameraFirmware=s.cameraFirmware),await c.mutateAsync({id:o._id,data:a}),n(!1),i(null)}catch{}},v=s=>{s||i(null),n(s)},b=l.watch("category");return e.jsx(re,{open:r,onOpenChange:v,children:e.jsxs(se,{className:"sm:max-w-[625px]",children:[e.jsxs(oe,{children:[e.jsx(ne,{children:"Edit Hardware"}),e.jsx(le,{children:"Update the hardware device information."})]}),e.jsx(ae,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(y),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(u,{control:l.control,name:"name",render:({field:s})=>e.jsxs(h,{children:[e.jsx(x,{children:"Name *"}),e.jsx(m,{children:e.jsx(k,{placeholder:"Enter hardware name",...s})}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"category",render:({field:s})=>e.jsxs(h,{children:[e.jsx(x,{children:"Category"}),e.jsxs(w,{onValueChange:s.onChange,value:s.value,children:[e.jsx(m,{children:e.jsx(f,{children:e.jsx(I,{placeholder:"Select category"})})}),e.jsx(C,{children:Da.map(a=>e.jsx(j,{value:a.value,children:a.label},a.value))})]}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"inventoryId",render:({field:s})=>e.jsxs(h,{children:[e.jsx(x,{children:"Inventory ID"}),e.jsx(m,{children:e.jsx(k,{placeholder:"Enter inventory ID",...s})}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"status",render:({field:s})=>e.jsxs(h,{children:[e.jsx(x,{children:"Status"}),e.jsxs(w,{onValueChange:s.onChange,value:s.value,children:[e.jsx(m,{children:e.jsx(f,{children:e.jsx(I,{placeholder:"Select status"})})}),e.jsx(C,{children:Na.map(a=>e.jsx(j,{value:a.value,children:a.label},a.value))})]}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"model",render:({field:s})=>e.jsxs(h,{children:[e.jsx(x,{children:"Model"}),e.jsx(m,{children:e.jsx(k,{placeholder:"Enter model",...s})}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"serial",render:({field:s})=>e.jsxs(h,{children:[e.jsx(x,{children:"Serial Number"}),e.jsx(m,{children:e.jsx(k,{placeholder:"Enter serial number",...s})}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"description",render:({field:s})=>e.jsxs(h,{className:"col-span-2",children:[e.jsx(x,{children:"Description"}),e.jsx(m,{children:e.jsx(P,{placeholder:"Enter hardware description",className:"resize-none",rows:3,...s})}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"notes",render:({field:s})=>e.jsxs(h,{className:"col-span-2",children:[e.jsx(x,{children:"Notes"}),e.jsx(m,{children:e.jsx(P,{placeholder:"Add any additional notes",className:"resize-none",rows:3,...s})}),e.jsx(p,{})]})}),b==="router"&&e.jsxs(e.Fragment,{children:[e.jsx(u,{control:l.control,name:"routerId",render:({field:s})=>e.jsxs(h,{children:[e.jsx(x,{children:"Router ID"}),e.jsx(m,{children:e.jsx(k,{placeholder:"Enter router ID",...s})}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"routerStatus",render:({field:s})=>e.jsxs(h,{children:[e.jsx(x,{children:"Router Status"}),e.jsxs(w,{onValueChange:s.onChange,value:s.value,children:[e.jsx(m,{children:e.jsx(f,{children:e.jsx(I,{placeholder:"Select status"})})}),e.jsxs(C,{children:[e.jsx(j,{value:"online",children:"Online"}),e.jsx(j,{value:"offline",children:"Offline"}),e.jsx(j,{value:"unknown",children:"Unknown"})]})]}),e.jsx(p,{})]})})]}),b==="lock"&&e.jsxs(e.Fragment,{children:[e.jsx(u,{control:l.control,name:"lockId",render:({field:s})=>e.jsxs(h,{children:[e.jsx(x,{children:"Lock ID"}),e.jsx(m,{children:e.jsx(k,{placeholder:"Enter lock ID",...s})}),e.jsx(p,{})]})}),e.jsx(u,{control:l.control,name:"lockVendor",render:({field:s})=>e.jsxs(h,{children:[e.jsx(x,{children:"Lock Vendor"}),e.jsxs(w,{onValueChange:s.onChange,value:s.value,children:[e.jsx(m,{children:e.jsx(f,{children:e.jsx(I,{placeholder:"Select vendor"})})}),e.jsxs(C,{children:[e.jsx(j,{value:"august",children:"August"}),e.jsx(j,{value:"switchbot",children:"SwitchBot"}),e.jsx(j,{value:"yale",children:"Yale"})]})]}),e.jsx(p,{})]})})]}),b==="camera"&&e.jsx(u,{control:l.control,name:"cameraFirmware",render:({field:s})=>e.jsxs(h,{className:"col-span-2",children:[e.jsx(x,{children:"Camera Firmware"}),e.jsxs(w,{onValueChange:s.onChange,value:s.value,children:[e.jsx(m,{children:e.jsx(f,{children:e.jsx(I,{placeholder:"Select firmware"})})}),e.jsxs(C,{children:[e.jsx(j,{value:"v1",children:"Version 1"}),e.jsx(j,{value:"v2",children:"Version 2"})]})]}),e.jsx(p,{})]})})]}),e.jsxs(te,{children:[e.jsx(V,{type:"button",variant:"outline",onClick:()=>v(!1),children:"Cancel"}),e.jsxs(V,{type:"submit",disabled:c.isPending,children:[c.isPending&&e.jsx(J,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Hardware"]})]})]})})]})})}function Fa(){const{isDeleteDialogOpen:r,setIsDeleteDialogOpen:n,deletingHardware:o,setDeletingHardware:i}=L(),c=()=>{o&&(Ve({action:"delete",hardwareId:o._id,hardwareName:o.name}),n(!1),i(null))};return e.jsxs(e.Fragment,{children:[e.jsx(Sa,{}),e.jsx(Va,{}),e.jsx(Fe,{open:r,onOpenChange:n,children:e.jsxs(He,{children:[e.jsxs(Me,{children:[e.jsx(Le,{children:"Are you absolutely sure?"}),e.jsxs(Te,{children:["This action cannot be undone. This will permanently delete the hardware",o?.name&&e.jsxs(e.Fragment,{children:[" ",e.jsx("span",{className:"font-semibold",children:o.name})]})," ","from the system."]})]}),e.jsxs(_e,{children:[e.jsx(Ae,{onClick:()=>i(null),children:"Cancel"}),e.jsx(Ee,{onClick:c,children:"Delete"})]})]})})]})}function Ha({children:r}){const[n,o]=D.useState([]),[i,c]=D.useState(!1),[l,y]=D.useState(!1),[v,b]=D.useState(!1),[s,a]=D.useState(null),[d,A]=D.useState(null);return e.jsx(he.Provider,{value:{selectedHardware:n,setSelectedHardware:o,isCreateDialogOpen:i,setIsCreateDialogOpen:c,isEditDialogOpen:l,setIsEditDialogOpen:y,isDeleteDialogOpen:v,setIsDeleteDialogOpen:b,editingHardware:s,setEditingHardware:a,deletingHardware:d,setDeletingHardware:A},children:r})}function Ma({row:r}){const n=r.original,{setEditingHardware:o,setIsEditDialogOpen:i,setDeletingHardware:c,setIsDeleteDialogOpen:l}=L(),y=()=>{o(n),i(!0)},v=()=>{c(n),l(!0)};return e.jsxs(ie,{children:[e.jsx(Qe,{asChild:!0,children:e.jsxs(V,{variant:"ghost",size:"icon",className:"h-8 w-8",children:[e.jsx(ha,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(ce,{align:"end",children:[e.jsx(de,{children:"Actions"}),e.jsx(ue,{}),e.jsxs(R,{className:"cursor-pointer",children:[e.jsx(We,{className:"mr-2 h-4 w-4"}),"View Details"]}),e.jsxs(R,{className:"cursor-pointer",onClick:y,children:[e.jsx(Je,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(R,{className:"text-destructive hover:text-destructive cursor-pointer",onClick:v,children:[e.jsx(Xe,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})}const La={router:pa,tablet:ua,camera:da,lock:$e,lockbox:ia,keypad:xa,hub:ca,sensor:ma},G=[{id:"select",size:40,header:({table:r})=>e.jsx(Y,{checked:r.getIsAllPageRowsSelected()||r.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:n=>r.toggleAllPageRowsSelected(!!n),"aria-label":"Select all"}),cell:({row:r})=>e.jsx(Y,{checked:r.getIsSelected(),onCheckedChange:n=>r.toggleSelected(!!n),"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:({column:r})=>e.jsx(N,{column:r,title:"Name"}),cell:({row:r})=>{const n=r.original.category,o=n?La[n]:null;return e.jsxs("div",{className:"flex items-center gap-2",children:[o&&e.jsx(o,{className:"text-muted-foreground h-4 w-4"}),e.jsx("span",{className:"font-medium",children:r.getValue("name")||"Unnamed"})]})}},{accessorKey:"category",header:({column:r})=>e.jsx(N,{column:r,title:"Category"}),cell:({row:r})=>{const n=r.getValue("category");return n?e.jsx(M,{variant:"outline",className:"capitalize",children:n}):"-"},filterFn:(r,n,o)=>o.includes(r.getValue(n))},{accessorKey:"inventoryId",header:({column:r})=>e.jsx(N,{column:r,title:"Inventory ID"}),cell:({row:r})=>r.getValue("inventoryId")||"-"},{accessorKey:"model",header:({column:r})=>e.jsx(N,{column:r,title:"Model"}),cell:({row:r})=>r.getValue("model")||"-"},{accessorKey:"serial",header:({column:r})=>e.jsx(N,{column:r,title:"Serial"}),cell:({row:r})=>r.getValue("serial")||"-"},{accessorKey:"property",header:({column:r})=>e.jsx(N,{column:r,title:"Property"}),cell:({row:r})=>r.original.property?.name||"-"},{accessorKey:"user",header:({column:r})=>e.jsx(N,{column:r,title:"Assigned To"}),cell:({row:r})=>{const n=r.original.user;return n?.name||n?.email||"-"}},{accessorKey:"status",header:({column:r})=>e.jsx(N,{column:r,title:"Status"}),cell:({row:r})=>{const n=r.getValue("status");return e.jsx(M,{variant:n==="active"?"default":"secondary",className:z(n==="active"&&"bg-green-500/10 text-green-500 hover:bg-green-500/20",n==="disabled"&&"bg-gray-500/10 text-gray-500 hover:bg-gray-500/20"),children:n})}},{accessorKey:"operationalStatus",header:({column:r})=>e.jsx(N,{column:r,title:"Operational Status"}),cell:({row:r})=>{const n=r.getValue("operationalStatus"),o=r.original.battery;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{variant:"outline",className:z(n==="online"&&"border-green-500 text-green-500",n==="offline"&&"border-red-500 text-red-500",n==="unknown"&&"border-gray-500 text-gray-500"),children:n}),o&&o.level<20&&e.jsxs(M,{variant:"destructive",className:"text-xs",children:[o.level,"%"]})]})}},{id:"actions",size:50,cell:({row:r})=>e.jsx(Ma,{row:r})}];function q({column:r,title:n,options:o}){const i=r?.getFacetedUniqueValues(),c=new Set(r?.getFilterValue());return e.jsxs(sa,{children:[e.jsx(oa,{asChild:!0,children:e.jsxs(V,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[e.jsx(Ze,{className:"h-4 w-4"}),n,c?.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(la,{orientation:"vertical",className:"mx-2 h-4"}),e.jsx(M,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:c.size}),e.jsx("div",{className:"hidden space-x-1 lg:flex",children:c.size>2?e.jsxs(M,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[c.size," selected"]}):o.filter(l=>c.has(l.value)).map(l=>e.jsx(M,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:l.label},l.value))})]})]})}),e.jsx(na,{className:"w-[200px] p-0",align:"start",children:e.jsxs(Oe,{children:[e.jsx(ze,{placeholder:n}),e.jsxs(Pe,{children:[e.jsx(Ke,{children:"No results found."}),e.jsx(Q,{children:o.map(l=>{const y=c.has(l.value);return e.jsxs($,{onSelect:()=>{y?c.delete(l.value):c.add(l.value);const v=Array.from(c);r?.setFilterValue(v.length?v:void 0)},children:[e.jsx("div",{className:z("border-primary flex h-4 w-4 items-center justify-center rounded-sm border",y?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(ea,{className:z("h-4 w-4")})}),l.icon&&e.jsx(l.icon,{className:"text-muted-foreground h-4 w-4"}),e.jsx("span",{children:l.label}),i?.get?.(l.value)?e.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:i.get(l.value)}):null]},l.value)})}),c.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(Re,{}),e.jsx(Q,{children:e.jsx($,{onSelect:()=>r?.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}function Ta({table:r}){return e.jsxs(ie,{modal:!1,children:[e.jsx(Ye,{asChild:!0,children:e.jsxs(V,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(aa,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsxs(ce,{align:"end",className:"w-[150px]",children:[e.jsx(de,{children:"Toggle columns"}),e.jsx(ue,{}),r.getAllColumns().filter(n=>typeof n.accessorFn<"u"&&n.getCanHide()).map(n=>e.jsx(Ge,{className:"capitalize",checked:n.getIsVisible(),onCheckedChange:o=>n.toggleVisibility(!!o),children:n.id},n.id))]})]})}const _a=[{value:"router",label:"Router"},{value:"tablet",label:"Tablet"},{value:"camera",label:"Camera"},{value:"lock",label:"Lock"},{value:"lockbox",label:"Lockbox"},{value:"keypad",label:"Keypad"},{value:"hub",label:"Hub"},{value:"sensor",label:"Sensor"}],Aa=[{value:"active",label:"Active"},{value:"disabled",label:"Disabled"}],Ea=[{value:"online",label:"Online"},{value:"offline",label:"Offline"},{value:"unknown",label:"Unknown"}];function Oa({table:r}){const n=r.getState().columnFilters.length>0,{setIsCreateDialogOpen:o}=L();return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 items-center space-x-2",children:[e.jsx(k,{placeholder:"Search hardware...",value:r.getColumn("name")?.getFilterValue()??"",onChange:i=>r.getColumn("name")?.setFilterValue(i.target.value),className:"h-8 w-[150px] lg:w-[250px]"}),r.getColumn("category")&&e.jsx(q,{column:r.getColumn("category"),title:"Category",options:_a}),r.getColumn("status")&&e.jsx(q,{column:r.getColumn("status"),title:"Status",options:Aa}),r.getColumn("operationalStatus")&&e.jsx(q,{column:r.getColumn("operationalStatus"),title:"Operational",options:Ea}),n&&e.jsxs(V,{variant:"ghost",onClick:()=>r.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(ra,{className:"ml-2 h-4 w-4"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ta,{table:r}),e.jsxs(V,{size:"sm",className:"h-8",onClick:()=>o(!0),children:[e.jsx(ta,{className:"mr-2 h-4 w-4"}),"Add Hardware"]})]})]})}function za({data:r,isLoading:n}){const{setSelectedHardware:o}=L(),{table:i,rowSelection:c}=Be({data:r,columns:G}),l=Object.keys(c).filter(y=>c[y]).map(y=>r[parseInt(y)]).filter(Boolean);return l.length!==i.getSelectedRowModel().rows.length&&o(l),e.jsx(Ue,{table:i,columns:G,isLoading:n,toolbar:e.jsx(Oa,{table:i}),showToolbar:!0})}function Pa(){const{data:r=[],isLoading:n,error:o}=ja();return e.jsxs(Ha,{children:[e.jsxs(fe,{fixed:!0,children:[e.jsx(Ie,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(Ce,{}),e.jsx(Se,{}),e.jsx(De,{})]})]}),e.jsxs(Ne,{children:[e.jsx("div",{className:"mb-2 flex items-center justify-between space-y-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Hardware Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and monitor all hardware devices"})]})}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-y-0 lg:space-x-12",children:o?e.jsxs(ke,{variant:"destructive",children:[e.jsx(be,{className:"h-4 w-4"}),e.jsx(we,{children:"Failed to load hardware. Please try again later."})]}):e.jsx(za,{data:r,isLoading:n})})]}),e.jsx(Fa,{})]})}const fr=Pa;export{fr as component};
