import{r as O,j as e,a9 as K,B as x,d as y,h as ce,t as k,a as de}from"./index-CvyRkeE5.js";import{u as me,q as pe,H as he,S as ue,a as xe,T as ge,P as je,M as fe}from"./header-company-dropdown-CQYbnI8v.js";import{B as w}from"./badge-Ce5hJyxp.js";import{C as A}from"./checkbox-DQAukn5y.js";import{D as f}from"./data-table-column-header-DAw5f9Xg.js";import{L as U}from"./long-text-B2UXBo_g.js";import{c as N}from"./createReactComponent-DcxUhOxs.js";import{u as C,l as h,f as B,s as i,o as S,b as D,a as Ne,Z as v}from"./types-Wky072k2.js";import{D as ve,P as ye,C as be,M as we,a as Ce}from"./react-icons.esm-hx67oMTw.js";import{D as $,e as Se,f as G,i as V,p as z,h as J,J as Ie,B as ke,g as Pe,z as De}from"./avatar-_2VmutPB.js";import{u as Te,S as T,C as Me}from"./confirm-dialog-DzAkMMFy.js";import{I as Fe}from"./IconEdit-ndTsYmJu.js";import{I as Ae}from"./IconTrash-Cb89azM9.js";import{u as Z,a as Q,F as W,b as c,c as d,d as m,e as u,f as p,L as Ue}from"./form-BBbFGrnZ.js";import{D as X,g as Y,h as ee,i as se,j as ae,k as le,l as Ve,C as ze,a as _e,b as Re,c as Ee,d as _,e as R,f as Le}from"./command-DTdQs4HX.js";import{I as j}from"./input-5vX5qBNK.js";import{P as E}from"./password-input-CUpVFB6t.js";import{C as qe}from"./company-select-SvYvuKDB.js";import{u as He,g as Oe}from"./users-api-BAS-TyLE.js";import{s as re}from"./show-submitted-data-BsY0sSLU.js";import{A as ne,b as Ke,a as te,I as Be}from"./alert-D1mu7eGo.js";import{T as $e}from"./textarea-DtY41fJS.js";import{I as Ge}from"./IconSend-ngZM6aqk.js";import{u as Je,D as Ze}from"./use-data-table-BURvSaac.js";import{P as Qe,a as We,b as Xe}from"./popover-NdNb9ebW.js";import{S as Ye}from"./separator-D1ovcUFg.js";import"./select-yRulkKwZ.js";import"./index-Bb0YeX9p.js";import"./index-DCzpbC7R.js";import"./index-bd6ufVwP.js";import"./index-Bt6K678h.js";import"./index-fHPixuyN.js";import"./index-Qfb_IjkA.js";import"./index-BYO_HMiJ.js";import"./check-DOj7a-5i.js";import"./index-ChHWVpPk.js";import"./index-rpDruwTI.js";import"./alert-dialog-DBJIasGu.js";import"./IconEye-D0cYwAOz.js";import"./table-CtXYL8Fg.js";/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var es=N("outline","alert-triangle","IconAlertTriangle",[["path",{d:"M12 9v4",key:"svg-0"}],["path",{d:"M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ss=N("outline","cash","IconCash",[["path",{d:"M7 15h-3a1 1 0 0 1 -1 -1v-8a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v3",key:"svg-0"}],["path",{d:"M7 9m0 1a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v8a1 1 0 0 1 -1 1h-12a1 1 0 0 1 -1 -1z",key:"svg-1"}],["path",{d:"M12 14a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var oe=N("outline","mail-plus","IconMailPlus",[["path",{d:"M12 19h-7a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v5.5",key:"svg-0"}],["path",{d:"M16 19h6",key:"svg-1"}],["path",{d:"M19 16v6",key:"svg-2"}],["path",{d:"M3 7l9 6l9 -6",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var as=N("outline","shield","IconShield",[["path",{d:"M12 3a12 12 0 0 0 8.5 3a12 12 0 0 1 -8.5 15a12 12 0 0 1 -8.5 -15a12 12 0 0 0 8.5 -3",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var L=N("outline","user-shield","IconUserShield",[["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h2",key:"svg-0"}],["path",{d:"M22 16c0 4 -2.5 6 -3.5 6s-3.5 -2 -3.5 -6c1 0 2.5 -.5 3.5 -1.5c1 1 2.5 1.5 3.5 1.5z",key:"svg-1"}],["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var P=N("outline","users-group","IconUsersGroup",[["path",{d:"M10 13a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M8 21v-1a2 2 0 0 1 2 -2h4a2 2 0 0 1 2 2v1",key:"svg-1"}],["path",{d:"M15 5a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-2"}],["path",{d:"M17 10h2a2 2 0 0 1 2 2v1",key:"svg-3"}],["path",{d:"M5 5a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-4"}],["path",{d:"M3 13v-1a2 2 0 0 1 2 -2h2",key:"svg-5"}]]);const ls=new Map([["active","bg-teal-100/30 text-teal-900 dark:text-teal-200 border-teal-200"],["inactive","bg-neutral-300/40 border-neutral-300"],["pending","bg-sky-200/40 text-sky-900 dark:text-sky-100 border-sky-300"]]),M=[{label:"Superadmin",value:"superadmin",icon:as},{label:"Admin",value:"admin",icon:L},{label:"Owner",value:"owner",icon:L},{label:"Organization",value:"org",icon:P},{label:"Manager",value:"manager",icon:P},{label:"Leasing Agent",value:"leasingAgent",icon:P},{label:"Agent",value:"agent",icon:ss}],rs=C([h("agent"),h("admin"),h("org"),h("superadmin"),h("owner"),h("leasingAgent"),h("manager")]),ns=C([h("superadmin"),h("leasingAgent"),h("admin"),h(""),B()]),ts=C([i(),S({_id:i(),name:i()})]),os=S({_id:i(),email:i().email(),firstName:i().optional(),lastName:i().optional(),role:rs,adminPanelRole:ns.optional(),active:D(),pending:D(),phone:i().optional(),jobTitle:i().optional(),profileImage:i().optional(),description:i().optional(),company:ts,createdAt:i(),updatedAt:i()});Ne(os);const is=s=>s.active?s.pending?"pending":"active":"inactive",ie=K.createContext(null);function cs({children:s}){const[a,l]=Te(null),[r,o]=O.useState(null);return e.jsx(ie,{value:{open:a,setOpen:l,currentRow:r,setCurrentRow:o},children:s})}const F=()=>{const s=K.useContext(ie);if(!s)throw new Error("useUsers has to be used within <UsersContext>");return s};function ds({row:s}){const{setOpen:a,setCurrentRow:l}=F();return e.jsx(e.Fragment,{children:e.jsxs($,{modal:!1,children:[e.jsx(Se,{asChild:!0,children:e.jsxs(x,{variant:"ghost",className:"data-[state=open]:bg-muted flex h-8 w-8 p-0",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(G,{align:"end",className:"w-[160px]",children:[e.jsxs(V,{onClick:()=>{l(s.original),a("edit")},children:["Edit",e.jsx(z,{children:e.jsx(Fe,{size:16})})]}),e.jsx(J,{}),e.jsxs(V,{onClick:()=>{l(s.original),a("delete")},className:"text-red-500!",children:["Delete",e.jsx(z,{children:e.jsx(Ae,{size:16})})]})]})]})})}const ms=[{id:"select",header:({table:s})=>e.jsx(A,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:a=>s.toggleAllPageRowsSelected(!!a),"aria-label":"Select all",className:"translate-y-[2px]"}),meta:{className:y("sticky md:table-cell left-0 z-10 rounded-tl","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted")},cell:({row:s})=>e.jsx(A,{checked:s.getIsSelected(),onCheckedChange:a=>s.toggleSelected(!!a),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"email",header:({column:s})=>e.jsx(f,{column:s,title:"Email"}),cell:({row:s})=>e.jsx(U,{className:"max-w-48",children:s.getValue("email")}),meta:{className:y("drop-shadow-[0_1px_2px_rgb(0_0_0_/_0.1)] dark:drop-shadow-[0_1px_2px_rgb(255_255_255_/_0.1)] lg:drop-shadow-none","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted","sticky left-6 md:table-cell")},enableHiding:!1},{id:"fullName",header:({column:s})=>e.jsx(f,{column:s,title:"Name"}),cell:({row:s})=>{const{firstName:a="",lastName:l=""}=s.original,r=`${a} ${l}`.trim()||"No Name";return e.jsx(U,{className:"max-w-36",children:r})},meta:{className:"w-36"}},{id:"company",header:({column:s})=>e.jsx(f,{column:s,title:"Company"}),cell:({row:s})=>{const a=s.original.company,l=typeof a=="object"?a.name:"N/A";return e.jsx("div",{className:"w-fit text-nowrap",children:l})}},{accessorKey:"phone",header:({column:s})=>e.jsx(f,{column:s,title:"Phone Number"}),cell:({row:s})=>e.jsx("div",{children:s.getValue("phone")||"N/A"}),enableSorting:!1},{accessorKey:"status",accessorFn:s=>is(s),header:({column:s})=>e.jsx(f,{column:s,title:"Status"}),cell:({row:s})=>{const a=s.getValue("status"),l=ls.get(a);return e.jsx("div",{className:"flex space-x-2",children:e.jsx(w,{variant:"outline",className:y("capitalize",l),children:a})})},filterFn:(s,a,l)=>l.includes(s.getValue(a)),enableHiding:!1,enableSorting:!1},{accessorKey:"role",header:({column:s})=>e.jsx(f,{column:s,title:"Role"}),cell:({row:s})=>{const{role:a}=s.original,l=M.find(({value:r})=>r===a);return l?e.jsxs("div",{className:"flex items-center gap-x-2",children:[l.icon&&e.jsx(l.icon,{size:16,className:"text-muted-foreground"}),e.jsx("span",{className:"text-sm capitalize",children:s.getValue("role")})]}):null},filterFn:(s,a,l)=>l.includes(s.getValue(a)),enableSorting:!1,enableHiding:!1},{accessorKey:"adminPanelRole",header:({column:s})=>e.jsx(f,{column:s,title:"Admin Panel Role"}),cell:({row:s})=>{const a=s.getValue("adminPanelRole");return!a||a===""?e.jsx("span",{className:"text-muted-foreground",children:"N/A"}):e.jsx("span",{className:"text-sm capitalize",children:a})},enableSorting:!1},{id:"actions",cell:ds}],ps=S({firstName:i().min(1,{message:"First Name is required."}),lastName:i().min(1,{message:"Last Name is required."}),username:i().min(1,{message:"Username is required."}),phoneNumber:i().optional(),email:i().min(1,{message:"Email is required."}).email({message:"Email is invalid."}),password:i().transform(s=>s.trim()),role:i().min(1,{message:"Role is required."}),adminPanelRole:C([i(),B()]).optional(),company:i().nullable().optional(),confirmPassword:i().transform(s=>s.trim()),isEdit:D()}).superRefine(({isEdit:s,password:a,confirmPassword:l},r)=>{(!s||s&&a!=="")&&(a===""&&r.addIssue({code:v.custom,message:"Password is required.",path:["password"]}),a.length<8&&r.addIssue({code:v.custom,message:"Password must be at least 8 characters long.",path:["password"]}),a.match(/[a-z]/)||r.addIssue({code:v.custom,message:"Password must contain at least one lowercase letter.",path:["password"]}),a.match(/\d/)||r.addIssue({code:v.custom,message:"Password must contain at least one number.",path:["password"]}),a!==l&&r.addIssue({code:v.custom,message:"Passwords don't match.",path:["confirmPassword"]}))});function q({currentRow:s,open:a,onOpenChange:l}){const r=!!s,o=He(),t=Z({resolver:Q(ps),defaultValues:r?{...s,company:typeof s.company=="object"?s.company._id:s.company,password:"",confirmPassword:"",isEdit:r}:{firstName:"",lastName:"",username:"",email:"",role:"",adminPanelRole:"",company:null,phoneNumber:"",password:"",confirmPassword:"",isEdit:r}}),g=async n=>{try{if(r&&s){const I={firstName:n.firstName,lastName:n.lastName,email:n.email,phone:n.phoneNumber||"",role:n.role,adminPanelRole:n.adminPanelRole||"",company:n.company||void 0,active:s.active};n.password&&n.password.trim()!==""&&(I.password=n.password),await o.mutateAsync({userId:s._id,data:I}),k.success("User updated successfully")}else k.error("User creation not yet implemented");t.reset(),l(!1)}catch{k.error(r?"Failed to update user":"Failed to create user")}},b=!!t.formState.dirtyFields.password;return e.jsx(X,{open:a,onOpenChange:n=>{t.reset(),l(n)},children:e.jsxs(Y,{className:"sm:max-w-lg",children:[e.jsxs(ee,{className:"text-left",children:[e.jsx(se,{children:r?"Edit User":"Add New User"}),e.jsxs(ae,{children:[r?"Update the user here. ":"Create new user here. ","Click save when you're done."]})]}),e.jsx("div",{className:"-mr-4 h-[26.25rem] w-full overflow-y-auto py-1 pr-4",children:e.jsx(W,{...t,children:e.jsxs("form",{id:"user-form",onSubmit:t.handleSubmit(g),className:"space-y-4 p-0.5",children:[e.jsx(c,{control:t.control,name:"firstName",render:({field:n})=>e.jsxs(d,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(m,{className:"col-span-2 text-right",children:"First Name"}),e.jsx(u,{children:e.jsx(j,{placeholder:"John",className:"col-span-4",autoComplete:"off",...n})}),e.jsx(p,{className:"col-span-4 col-start-3"})]})}),e.jsx(c,{control:t.control,name:"lastName",render:({field:n})=>e.jsxs(d,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(m,{className:"col-span-2 text-right",children:"Last Name"}),e.jsx(u,{children:e.jsx(j,{placeholder:"Doe",className:"col-span-4",autoComplete:"off",...n})}),e.jsx(p,{className:"col-span-4 col-start-3"})]})}),e.jsx(c,{control:t.control,name:"username",render:({field:n})=>e.jsxs(d,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(m,{className:"col-span-2 text-right",children:"Username"}),e.jsx(u,{children:e.jsx(j,{placeholder:"john_doe",className:"col-span-4",...n})}),e.jsx(p,{className:"col-span-4 col-start-3"})]})}),e.jsx(c,{control:t.control,name:"email",render:({field:n})=>e.jsxs(d,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(m,{className:"col-span-2 text-right",children:"Email"}),e.jsx(u,{children:e.jsx(j,{placeholder:"john.doe@gmail.com",className:"col-span-4",...n})}),e.jsx(p,{className:"col-span-4 col-start-3"})]})}),e.jsx(c,{control:t.control,name:"phoneNumber",render:({field:n})=>e.jsxs(d,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(m,{className:"col-span-2 text-right",children:"Phone Number"}),e.jsx(u,{children:e.jsx(j,{placeholder:"+123456789",className:"col-span-4",...n})}),e.jsx(p,{className:"col-span-4 col-start-3"})]})}),e.jsx(c,{control:t.control,name:"role",render:({field:n})=>e.jsxs(d,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(m,{className:"col-span-2 text-right",children:"Role"}),e.jsx(T,{defaultValue:n.value,onValueChange:n.onChange,placeholder:"Select a role",className:"col-span-4",items:[{label:"Owner",value:"owner"},{label:"Manager",value:"manager"},{label:"Agent",value:"agent"}]}),e.jsx(p,{className:"col-span-4 col-start-3"})]})}),e.jsx(c,{control:t.control,name:"adminPanelRole",render:({field:n})=>e.jsxs(d,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(m,{className:"col-span-2 text-right",children:"Admin Panel Role"}),e.jsx(T,{defaultValue:n.value||void 0,onValueChange:n.onChange,placeholder:"Select admin role",className:"col-span-4",items:[{label:"Superadmin",value:"superadmin"},{label:"Admin",value:"admin"},{label:"Leasing Agent",value:"leasingAgent"}]}),e.jsx(p,{className:"col-span-4 col-start-3"})]})}),e.jsx(c,{control:t.control,name:"company",render:({field:n})=>e.jsxs(d,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(m,{className:"col-span-2 text-right",children:"Company"}),e.jsx("div",{className:"col-span-4",children:e.jsx(qe,{value:n.value,onValueChange:n.onChange,placeholder:"Company..."})}),e.jsx(p,{className:"col-span-4 col-start-3"})]})}),e.jsx(c,{control:t.control,name:"password",render:({field:n})=>e.jsxs(d,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(m,{className:"col-span-2 text-right",children:"Password"}),e.jsx(u,{children:e.jsx(E,{placeholder:"e.g., S3cur3P@ssw0rd",className:"col-span-4",...n})}),e.jsx(p,{className:"col-span-4 col-start-3"})]})}),e.jsx(c,{control:t.control,name:"confirmPassword",render:({field:n})=>e.jsxs(d,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(m,{className:"col-span-2 text-right",children:"Confirm Password"}),e.jsx(u,{children:e.jsx(E,{disabled:!b,placeholder:"e.g., S3cur3P@ssw0rd",className:"col-span-4",...n})}),e.jsx(p,{className:"col-span-4 col-start-3"})]})})]})})}),e.jsx(le,{children:e.jsxs(x,{type:"submit",form:"user-form",disabled:o.isPending,children:[o.isPending&&e.jsx(ce,{className:"mr-2 h-4 w-4 animate-spin"}),"Save changes"]})})]})})}function hs({open:s,onOpenChange:a,currentRow:l}){const[r,o]=O.useState(""),t=()=>{r.trim()===l.email&&(a(!1),re(l,"The following user has been deleted:"))};return e.jsx(Me,{open:s,onOpenChange:a,handleConfirm:t,disabled:r.trim()!==l.email,title:e.jsxs("span",{className:"text-destructive",children:[e.jsx(es,{className:"stroke-destructive mr-1 inline-block",size:18})," ","Delete User"]}),desc:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"mb-2",children:["Are you sure you want to delete"," ",e.jsx("span",{className:"font-bold",children:l.email}),"?",e.jsx("br",{}),"This action will permanently remove the user with the role of"," ",e.jsx("span",{className:"font-bold",children:l.role.toUpperCase()})," ","from the system. This cannot be undone."]}),e.jsxs(Ue,{className:"my-2",children:["Email:",e.jsx(j,{value:r,onChange:g=>o(g.target.value),placeholder:"Enter email to confirm deletion."})]}),e.jsxs(ne,{variant:"destructive",children:[e.jsx(Ke,{children:"Warning!"}),e.jsx(te,{children:"Please be carefull, this operation can not be rolled back."})]})]}),confirmText:"Delete",destructive:!0})}const us=S({email:i().min(1,{message:"Email is required."}).email({message:"Email is invalid."}),role:i().min(1,{message:"Role is required."}),desc:i().optional()});function xs({open:s,onOpenChange:a}){const l=Z({resolver:Q(us),defaultValues:{email:"",role:"",desc:""}}),r=o=>{l.reset(),re(o),a(!1)};return e.jsx(X,{open:s,onOpenChange:o=>{l.reset(),a(o)},children:e.jsxs(Y,{className:"sm:max-w-md",children:[e.jsxs(ee,{className:"text-left",children:[e.jsxs(se,{className:"flex items-center gap-2",children:[e.jsx(oe,{})," Invite User"]}),e.jsx(ae,{children:"Invite new user to join your team by sending them an email invitation. Assign a role to define their access level."})]}),e.jsx(W,{...l,children:e.jsxs("form",{id:"user-invite-form",onSubmit:l.handleSubmit(r),className:"space-y-4",children:[e.jsx(c,{control:l.control,name:"email",render:({field:o})=>e.jsxs(d,{children:[e.jsx(m,{children:"Email"}),e.jsx(u,{children:e.jsx(j,{type:"email",placeholder:"eg: john.doe@gmail.com",...o})}),e.jsx(p,{})]})}),e.jsx(c,{control:l.control,name:"role",render:({field:o})=>e.jsxs(d,{className:"space-y-1",children:[e.jsx(m,{children:"Role"}),e.jsx(T,{defaultValue:o.value,onValueChange:o.onChange,placeholder:"Select a role",items:M.map(({label:t,value:g})=>({label:t,value:g}))}),e.jsx(p,{})]})}),e.jsx(c,{control:l.control,name:"desc",render:({field:o})=>e.jsxs(d,{className:"",children:[e.jsx(m,{children:"Description (optional)"}),e.jsx(u,{children:e.jsx($e,{className:"resize-none",placeholder:"Add a personal note to your invitation (optional)",...o})}),e.jsx(p,{})]})})]})}),e.jsxs(le,{className:"gap-y-2",children:[e.jsx(Ve,{asChild:!0,children:e.jsx(x,{variant:"outline",children:"Cancel"})}),e.jsxs(x,{type:"submit",form:"user-invite-form",children:["Invite ",e.jsx(Ge,{})]})]})]})})}function gs(){const{open:s,setOpen:a,currentRow:l,setCurrentRow:r}=F();return e.jsxs(e.Fragment,{children:[e.jsx(q,{open:s==="add",onOpenChange:()=>a("add")},"user-add"),e.jsx(xs,{open:s==="invite",onOpenChange:()=>a("invite")},"user-invite"),l&&e.jsxs(e.Fragment,{children:[e.jsx(q,{open:s==="edit",onOpenChange:()=>{a("edit"),setTimeout(()=>{r(null)},500)},currentRow:l},`user-edit-${l._id}`),e.jsx(hs,{open:s==="delete",onOpenChange:()=>{a("delete"),setTimeout(()=>{r(null)},500)},currentRow:l},`user-delete-${l._id}`)]})]})}function js(){const{setOpen:s}=F();return e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{variant:"outline",className:"space-x-1",onClick:()=>s("invite"),children:[e.jsx("span",{children:"Invite User"})," ",e.jsx(oe,{size:18})]}),e.jsxs(x,{className:"space-x-1",onClick:()=>s("add"),children:[e.jsx("span",{children:"Add User"})," ",e.jsx(Ie,{size:18})]})]})}function H({column:s,title:a,options:l}){const r=s?.getFacetedUniqueValues(),o=new Set(s?.getFilterValue());return e.jsxs(Qe,{children:[e.jsx(We,{asChild:!0,children:e.jsxs(x,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[e.jsx(ye,{className:"h-4 w-4"}),a,o?.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(Ye,{orientation:"vertical",className:"mx-2 h-4"}),e.jsx(w,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:o.size}),e.jsx("div",{className:"hidden space-x-1 lg:flex",children:o.size>2?e.jsxs(w,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[o.size," selected"]}):l.filter(t=>o.has(t.value)).map(t=>e.jsx(w,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:t.label},t.value))})]})]})}),e.jsx(Xe,{className:"w-[200px] p-0",align:"start",children:e.jsxs(ze,{children:[e.jsx(_e,{placeholder:a}),e.jsxs(Re,{children:[e.jsx(Ee,{children:"No results found."}),e.jsx(_,{children:l.map(t=>{const g=o.has(t.value);return e.jsxs(R,{onSelect:()=>{g?o.delete(t.value):o.add(t.value);const b=Array.from(o);s?.setFilterValue(b.length?b:void 0)},children:[e.jsx("div",{className:y("border-primary flex h-4 w-4 items-center justify-center rounded-sm border",g?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(be,{className:y("h-4 w-4")})}),t.icon&&e.jsx(t.icon,{className:"text-muted-foreground h-4 w-4"}),e.jsx("span",{children:t.label}),r?.get?.(t.value)?e.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:r.get(t.value)}):null]},t.value)})}),o.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(Le,{}),e.jsx(_,{children:e.jsx(R,{onSelect:()=>s?.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}function fs({table:s}){return e.jsxs($,{modal:!1,children:[e.jsx(ke,{asChild:!0,children:e.jsxs(x,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsxs(G,{align:"end",className:"w-[150px]",children:[e.jsx(Pe,{children:"Toggle columns"}),e.jsx(J,{}),s.getAllColumns().filter(a=>typeof a.accessorFn<"u"&&a.getCanHide()).map(a=>e.jsx(De,{className:"capitalize",checked:a.getIsVisible(),onCheckedChange:l=>a.toggleVisibility(!!l),children:a.id},a.id))]})]})}function Ns({table:s}){const a=s.getState().columnFilters.length>0;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx(j,{placeholder:"Filter by email...",value:s.getColumn("email")?.getFilterValue()??"",onChange:l=>s.getColumn("email")?.setFilterValue(l.target.value),className:"h-8 w-[150px] lg:w-[250px]"}),e.jsxs("div",{className:"flex gap-x-2",children:[s.getColumn("status")&&e.jsx(H,{column:s.getColumn("status"),title:"Status",options:[{label:"Active",value:"active"},{label:"Inactive",value:"inactive"},{label:"Pending",value:"pending"}]}),s.getColumn("role")&&e.jsx(H,{column:s.getColumn("role"),title:"Role",options:M.map(l=>({...l}))})]}),a&&e.jsxs(x,{variant:"ghost",onClick:()=>s.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(Ce,{className:"ml-2 h-4 w-4"})]})]}),e.jsx(fs,{table:s})]})}function vs({columns:s,data:a=[],isLoading:l}){const{table:r}=Je({data:a,columns:s});return e.jsx(Ze,{table:r,columns:s,isLoading:l,toolbar:e.jsx(Ns,{table:r}),showToolbar:!0})}const ys=(s={})=>me({queryKey:pe.users.list(s),queryFn:()=>Oe(s),staleTime:5*60*1e3});function bs(){const s=de({strict:!1}),{data:a=[],isLoading:l,error:r}=ys({company:s.company});return e.jsxs(cs,{children:[e.jsxs(he,{fixed:!0,children:[e.jsx(ue,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(xe,{}),e.jsx(ge,{}),e.jsx(je,{})]})]}),e.jsxs(fe,{children:[e.jsxs("div",{className:"mb-2 flex flex-wrap items-center justify-between space-y-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"User List"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your users and their roles here."})]}),e.jsx(js,{})]}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-y-0 lg:space-x-12",children:r?e.jsxs(ne,{variant:"destructive",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx(te,{children:"Failed to load users. Please try again later."})]}):e.jsx(vs,{data:a,columns:ms,isLoading:l})})]}),e.jsx(gs,{})]})}const ca=bs;export{ca as component};
