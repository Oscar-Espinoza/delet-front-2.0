import{r as Q,j as e,a4 as G,B as g,d as C,f as J,e as je,t as U,a as fe}from"./index-CsPbyjqq.js";import{A as Z,b as ye,a as W,I as Ne}from"./alert-BtjweUsc.js";import{b as X,q as I,c as D,u as Y,H as ve,S as be,a as we,T as Ce,P as Se,M as Pe}from"./theme-switch-BkO31Og6.js";import{B as S}from"./badge-Dwoct147.js";import{C as z}from"./checkbox-CKYs508e.js";import{D as N}from"./data-table-column-header-CQlxrAjV.js";import{L as _}from"./long-text-Dwtw9Xhu.js";import{c as b}from"./createReactComponent-BW_frDSn.js";import{u as k,l as x,f as ee,s as i,o as T,b as P,a as Ie,Z as f}from"./types-Wky072k2.js";import{D as De,P as ke,C as Te,M as Ue,a as Ae}from"./react-icons.esm-B0xYXpOp.js";import{D as se,e as Fe,f as ae,i as q,p as L,h as ne,J as Me,B as Re,g as Ve,z as ze}from"./avatar-Dwr00yMn.js";import{u as _e,S as F}from"./select-dropdown-DMZeM2zg.js";import{I as qe}from"./IconEdit-CxoO5XKc.js";import{I as Le}from"./IconTrash-CGWt8tjB.js";import{u as re,a as le,F as te,b as m,c as p,d as u,e as y,f as h,L as Ee}from"./form-DKoAMwr-.js";import{D as oe,a as ie,b as ce,c as de,d as me,e as pe,l as Oe,C as He,f as Ke,g as $e,h as Be,i as E,j as O,k as Qe}from"./command-DOxIIFlo.js";import{I as v}from"./input-5SQVrAtH.js";import{C as Ge}from"./company-select-CKLOAwIm.js";import{P as H}from"./password-input-CqajPWVU.js";import{s as ue}from"./show-submitted-data-BHqgJZrc.js";import{C as Je}from"./confirm-dialog-Dps2pcjk.js";import{T as Ze}from"./textarea-DKq9H4p7.js";import{I as We}from"./IconSend-C3wVhvgo.js";import{u as Xe,D as Ye}from"./use-data-table-Cl1qhkDL.js";import{P as es,a as ss,b as as}from"./popover-segQm2pA.js";import{S as ns}from"./separator-c02Ge6Zo.js";import"./select-CcSKRIFJ.js";import"./index-DMPFB69W.js";import"./index-BjDkRKFr.js";import"./index-D3GDyaHS.js";import"./index-DZz0vwHh.js";import"./index-DMmlQz9C.js";import"./index-BWqx2Go7.js";import"./index-BB0IJgGb.js";import"./check-D2987ydO.js";import"./index-DSb8P5hH.js";import"./index-CzDhUyC5.js";import"./IconEye-CgK0acQ6.js";import"./alert-dialog-DWkdR42t.js";import"./table-D4KWq3W4.js";/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var rs=b("outline","alert-triangle","IconAlertTriangle",[["path",{d:"M12 9v4",key:"svg-0"}],["path",{d:"M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ls=b("outline","cash","IconCash",[["path",{d:"M7 15h-3a1 1 0 0 1 -1 -1v-8a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v3",key:"svg-0"}],["path",{d:"M7 9m0 1a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v8a1 1 0 0 1 -1 1h-12a1 1 0 0 1 -1 -1z",key:"svg-1"}],["path",{d:"M12 14a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var he=b("outline","mail-plus","IconMailPlus",[["path",{d:"M12 19h-7a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v5.5",key:"svg-0"}],["path",{d:"M16 19h6",key:"svg-1"}],["path",{d:"M19 16v6",key:"svg-2"}],["path",{d:"M3 7l9 6l9 -6",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ts=b("outline","shield","IconShield",[["path",{d:"M12 3a12 12 0 0 0 8.5 3a12 12 0 0 1 -8.5 15a12 12 0 0 1 -8.5 -15a12 12 0 0 0 8.5 -3",key:"svg-0"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var K=b("outline","user-shield","IconUserShield",[["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h2",key:"svg-0"}],["path",{d:"M22 16c0 4 -2.5 6 -3.5 6s-3.5 -2 -3.5 -6c1 0 2.5 -.5 3.5 -1.5c1 1 2.5 1.5 3.5 1.5z",key:"svg-1"}],["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.34.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var A=b("outline","users-group","IconUsersGroup",[["path",{d:"M10 13a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M8 21v-1a2 2 0 0 1 2 -2h4a2 2 0 0 1 2 2v1",key:"svg-1"}],["path",{d:"M15 5a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-2"}],["path",{d:"M17 10h2a2 2 0 0 1 2 2v1",key:"svg-3"}],["path",{d:"M5 5a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-4"}],["path",{d:"M3 13v-1a2 2 0 0 1 2 -2h2",key:"svg-5"}]]);const os=new Map([["active","bg-teal-100/30 text-teal-900 dark:text-teal-200 border-teal-200"],["inactive","bg-neutral-300/40 border-neutral-300"],["pending","bg-sky-200/40 text-sky-900 dark:text-sky-100 border-sky-300"]]),M=[{label:"Superadmin",value:"superadmin",icon:ts},{label:"Admin",value:"admin",icon:K},{label:"Owner",value:"owner",icon:K},{label:"Organization",value:"org",icon:A},{label:"Manager",value:"manager",icon:A},{label:"Leasing Agent",value:"leasingAgent",icon:A},{label:"Agent",value:"agent",icon:ls}],is=k([x("agent"),x("admin"),x("org"),x("superadmin"),x("owner"),x("leasingAgent"),x("manager")]),cs=k([x("superadmin"),x("leasingAgent"),x("admin"),x(""),ee()]),ds=k([i(),T({_id:i(),name:i()})]),ms=T({_id:i(),email:i().email(),firstName:i().optional(),lastName:i().optional(),role:is,adminPanelRole:cs.optional(),active:P(),pending:P(),phone:i().optional(),jobTitle:i().optional(),profileImage:i().optional(),description:i().optional(),company:ds,createdAt:i(),updatedAt:i()});Ie(ms);const ps=s=>s.active?s.pending?"pending":"active":"inactive",xe=G.createContext(null);function us({children:s}){const[a,n]=_e(null),[l,t]=Q.useState(null);return e.jsx(xe,{value:{open:a,setOpen:n,currentRow:l,setCurrentRow:t},children:s})}const R=()=>{const s=G.useContext(xe);if(!s)throw new Error("useUsers has to be used within <UsersContext>");return s};function hs({row:s}){const{setOpen:a,setCurrentRow:n}=R();return e.jsx(e.Fragment,{children:e.jsxs(se,{modal:!1,children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(g,{variant:"ghost",className:"data-[state=open]:bg-muted flex h-8 w-8 p-0",children:[e.jsx(De,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Open menu"})]})}),e.jsxs(ae,{align:"end",className:"w-[160px]",children:[e.jsxs(q,{onClick:()=>{n(s.original),a("edit")},children:["Edit",e.jsx(L,{children:e.jsx(qe,{size:16})})]}),e.jsx(ne,{}),e.jsxs(q,{onClick:()=>{n(s.original),a("delete")},className:"text-red-500!",children:["Delete",e.jsx(L,{children:e.jsx(Le,{size:16})})]})]})]})})}const xs=[{id:"select",header:({table:s})=>e.jsx(z,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:a=>s.toggleAllPageRowsSelected(!!a),"aria-label":"Select all",className:"translate-y-[2px]"}),meta:{className:C("sticky md:table-cell left-0 z-10 rounded-tl","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted")},cell:({row:s})=>e.jsx(z,{checked:s.getIsSelected(),onCheckedChange:a=>s.toggleSelected(!!a),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"email",header:({column:s})=>e.jsx(N,{column:s,title:"Email"}),cell:({row:s})=>e.jsx(_,{className:"max-w-48",children:s.getValue("email")}),meta:{className:C("drop-shadow-[0_1px_2px_rgb(0_0_0_/_0.1)] dark:drop-shadow-[0_1px_2px_rgb(255_255_255_/_0.1)] lg:drop-shadow-none","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted","sticky left-6 md:table-cell")},enableHiding:!1},{id:"fullName",header:({column:s})=>e.jsx(N,{column:s,title:"Name"}),cell:({row:s})=>{const{firstName:a="",lastName:n=""}=s.original,l=`${a} ${n}`.trim()||"No Name";return e.jsx(_,{className:"max-w-36",children:l})},meta:{className:"w-36"}},{id:"company",header:({column:s})=>e.jsx(N,{column:s,title:"Company"}),cell:({row:s})=>{const a=s.original.company,n=typeof a=="object"?a.name:"N/A";return e.jsx("div",{className:"w-fit text-nowrap",children:n})}},{accessorKey:"phone",header:({column:s})=>e.jsx(N,{column:s,title:"Phone Number"}),cell:({row:s})=>e.jsx("div",{children:s.getValue("phone")||"N/A"}),enableSorting:!1},{accessorKey:"status",accessorFn:s=>ps(s),header:({column:s})=>e.jsx(N,{column:s,title:"Status"}),cell:({row:s})=>{const a=s.getValue("status"),n=os.get(a);return e.jsx("div",{className:"flex space-x-2",children:e.jsx(S,{variant:"outline",className:C("capitalize",n),children:a})})},filterFn:(s,a,n)=>n.includes(s.getValue(a)),enableHiding:!1,enableSorting:!1},{accessorKey:"role",header:({column:s})=>e.jsx(N,{column:s,title:"Role"}),cell:({row:s})=>{const{role:a}=s.original,n=M.find(({value:l})=>l===a);return n?e.jsxs("div",{className:"flex items-center gap-x-2",children:[n.icon&&e.jsx(n.icon,{size:16,className:"text-muted-foreground"}),e.jsx("span",{className:"text-sm capitalize",children:s.getValue("role")})]}):null},filterFn:(s,a,n)=>n.includes(s.getValue(a)),enableSorting:!1,enableHiding:!1},{accessorKey:"adminPanelRole",header:({column:s})=>e.jsx(N,{column:s,title:"Admin Panel Role"}),cell:({row:s})=>{const a=s.getValue("adminPanelRole");return!a||a===""?e.jsx("span",{className:"text-muted-foreground",children:"N/A"}):e.jsx("span",{className:"text-sm capitalize",children:a})},enableSorting:!1},{id:"actions",cell:hs}],gs=async({role:s="",company:a="",active:n=""}={})=>{const l=new URLSearchParams;s&&l.append("role",s),a&&l.append("company",a),n&&l.append("active",n);const t=await D.get(`/api/users/admin/list${l.toString()?`?${l.toString()}`:""}`);return Array.isArray(t)?t.map(o=>({...o,firstName:o.firstName||"",lastName:o.lastName||"",phone:o.phone||"",jobTitle:o.jobTitle||"",profileImage:o.profileImage||"",description:o.description||"",adminPanelRole:o.adminPanelRole||""})):[]},js=async(s,a)=>{const n={id:s,firstName:a.firstName||"",lastName:a.lastName||"",phone:a.phone||"",email:a.email||"",adminPanelRole:a.adminPanelRole||"",active:String(a.active!==!1),role:a.role||"",company:typeof a.company=="object"?a.company._id:a.company||void 0};return a.password&&a.password.trim()!==""&&(n.password=a.password),D.post(`/api/users/admin/${s}`,n)},fs=async s=>D.post("/api/users/admin/create",s),ys=async()=>D.get("/api/users/profile");function Ns(){const s=J();return X({mutationFn:fs,onSuccess:()=>{s.invalidateQueries({queryKey:I.users.all})}})}function vs(){const s=J();return X({mutationFn:({userId:a,data:n})=>js(a,n),onSuccess:()=>{s.invalidateQueries({queryKey:I.users.all})}})}const bs=()=>Y({queryKey:I.users.current,queryFn:ys,staleTime:5*60*1e3,retry:1}),ws=T({firstName:i().min(1,{message:"First Name is required."}),lastName:i().min(1,{message:"Last Name is required."}),phone:i().optional(),email:i().min(1,{message:"Email is required."}).email({message:"Email is invalid."}),password:i().transform(s=>s.trim()),role:i().min(1,{message:"Role is required."}),adminPanelRole:k([i(),ee()]).optional(),company:i().nullable().optional(),confirmPassword:i().transform(s=>s.trim()),isEdit:P(),isSuperAdmin:P().optional()}).superRefine(({isEdit:s,password:a,confirmPassword:n,isSuperAdmin:l,phone:t,company:o},c)=>{(!s||s&&l&&a!=="")&&(a===""&&c.addIssue({code:f.custom,message:"Password is required.",path:["password"]}),a.length<8&&c.addIssue({code:f.custom,message:"Password must be at least 8 characters long.",path:["password"]}),a.match(/[a-z]/)||c.addIssue({code:f.custom,message:"Password must contain at least one lowercase letter.",path:["password"]}),a.match(/\d/)||c.addIssue({code:f.custom,message:"Password must contain at least one number.",path:["password"]}),a!==n&&c.addIssue({code:f.custom,message:"Passwords don't match.",path:["confirmPassword"]})),t&&(/^([+]?[\s0-9]+)?(\d{3}|[(]?[0-9]+[)])?([-]?[\s]?[0-9])+$/.test(t)||c.addIssue({code:f.custom,message:"Please enter a valid phone number.",path:["phone"]}),t.replace(/\D/g,"").length!==10&&c.addIssue({code:f.custom,message:"Phone number must be 10 digits.",path:["phone"]})),!s&&!o&&c.addIssue({code:f.custom,message:"Company is required.",path:["company"]})});function $({currentRow:s,open:a,onOpenChange:n}){const l=!!s,t=vs(),o=Ns(),{data:c}=bs(),j=c?.adminPanelRole==="superadmin",d=re({resolver:le(ws),defaultValues:l?{...s,company:typeof s.company=="object"?s.company._id:s.company,password:"",confirmPassword:"",isEdit:l,isSuperAdmin:j}:{firstName:"",lastName:"",email:"",role:"",adminPanelRole:"",company:null,phone:"",password:"",confirmPassword:"",isEdit:l,isSuperAdmin:j}}),V=async r=>{try{if(l&&s){const w={firstName:r.firstName,lastName:r.lastName,email:r.email,phone:r.phone||"",role:r.role,adminPanelRole:r.adminPanelRole||"",company:r.company||void 0,active:s.active};j&&r.password&&r.password.trim()!==""&&(w.password=r.password),await t.mutateAsync({userId:s._id,data:w}),U.success("User updated successfully")}else{const w={firstName:r.firstName,lastName:r.lastName,phone:r.phone||"",email:r.email,password:r.password,role:r.role,adminPanelRole:r.adminPanelRole||"",company:r.company||void 0};await o.mutateAsync(w),U.success("User created successfully")}d.reset(),n(!1)}catch{U.error(l?"Failed to update user":"Failed to create user")}},ge=!!d.formState.dirtyFields.password;return e.jsx(oe,{open:a,onOpenChange:r=>{d.reset(),n(r)},children:e.jsxs(ie,{className:"sm:max-w-lg",children:[e.jsxs(ce,{className:"text-left",children:[e.jsx(de,{children:l?"Edit User":"Add New User"}),e.jsxs(me,{children:[l?"Update the user here. ":"Create new user here. ","Click save when you're done."]})]}),e.jsx("div",{className:"-mr-4 h-[26.25rem] w-full overflow-y-auto py-1 pr-4",children:e.jsx(te,{...d,children:e.jsxs("form",{id:"user-form",onSubmit:d.handleSubmit(V),className:"space-y-4 p-0.5",children:[e.jsx(m,{control:d.control,name:"firstName",render:({field:r})=>e.jsxs(p,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-right",children:"First Name"}),e.jsx(y,{children:e.jsx(v,{placeholder:"John",className:"col-span-4",autoComplete:"off",...r})}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),e.jsx(m,{control:d.control,name:"lastName",render:({field:r})=>e.jsxs(p,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-right",children:"Last Name"}),e.jsx(y,{children:e.jsx(v,{placeholder:"Doe",className:"col-span-4",autoComplete:"off",...r})}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),e.jsx(m,{control:d.control,name:"email",render:({field:r})=>e.jsxs(p,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-right",children:"Email"}),e.jsx(y,{children:e.jsx(v,{placeholder:"john.doe@gmail.com",className:"col-span-4",...r})}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),e.jsx(m,{control:d.control,name:"phone",render:({field:r})=>e.jsxs(p,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-right",children:"Phone Number"}),e.jsx(y,{children:e.jsx(v,{placeholder:"+123456789",className:"col-span-4",...r})}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),e.jsx(m,{control:d.control,name:"role",render:({field:r})=>e.jsxs(p,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-right",children:"Role"}),e.jsx(F,{defaultValue:r.value,onValueChange:r.onChange,placeholder:"Select a role",className:"col-span-4",items:[{label:"Owner",value:"owner"},{label:"Manager",value:"manager"},{label:"Agent",value:"agent"}]}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),e.jsx(m,{control:d.control,name:"adminPanelRole",render:({field:r})=>e.jsxs(p,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-right",children:"Admin Panel Role"}),e.jsx(F,{defaultValue:r.value||void 0,onValueChange:r.onChange,placeholder:"Select admin role",className:"col-span-4",items:[{label:"Superadmin",value:"superadmin"},{label:"Admin",value:"admin"},{label:"Leasing Agent",value:"leasingAgent"}]}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),e.jsx(m,{control:d.control,name:"company",render:({field:r})=>e.jsxs(p,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-right",children:"Company"}),e.jsx("div",{className:"col-span-4",children:e.jsx(Ge,{value:r.value,onValueChange:r.onChange,placeholder:"Company..."})}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),(!l||j)&&e.jsxs(e.Fragment,{children:[e.jsx(m,{control:d.control,name:"password",render:({field:r})=>e.jsxs(p,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-right",children:"Password"}),e.jsx(y,{children:e.jsx(H,{placeholder:"e.g., S3cur3P@ssw0rd",className:"col-span-4",...r})}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),e.jsx(m,{control:d.control,name:"confirmPassword",render:({field:r})=>e.jsxs(p,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-right",children:"Confirm Password"}),e.jsx(y,{children:e.jsx(H,{disabled:!ge,placeholder:"e.g., S3cur3P@ssw0rd",className:"col-span-4",...r})}),e.jsx(h,{className:"col-span-4 col-start-3"})]})})]})]})})}),e.jsx(pe,{children:e.jsxs(g,{type:"submit",form:"user-form",disabled:t.isPending||o.isPending,children:[(t.isPending||o.isPending)&&e.jsx(je,{className:"mr-2 h-4 w-4 animate-spin"}),l?"Save changes":"Create user"]})})]})})}function Cs({open:s,onOpenChange:a,currentRow:n}){const[l,t]=Q.useState(""),o=()=>{l.trim()===n.email&&(a(!1),ue(n,"The following user has been deleted:"))};return e.jsx(Je,{open:s,onOpenChange:a,handleConfirm:o,disabled:l.trim()!==n.email,title:e.jsxs("span",{className:"text-destructive",children:[e.jsx(rs,{className:"stroke-destructive mr-1 inline-block",size:18})," ","Delete User"]}),desc:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"mb-2",children:["Are you sure you want to delete"," ",e.jsx("span",{className:"font-bold",children:n.email}),"?",e.jsx("br",{}),"This action will permanently remove the user with the role of"," ",e.jsx("span",{className:"font-bold",children:n.role.toUpperCase()})," ","from the system. This cannot be undone."]}),e.jsxs(Ee,{className:"my-2",children:["Email:",e.jsx(v,{value:l,onChange:c=>t(c.target.value),placeholder:"Enter email to confirm deletion."})]}),e.jsxs(Z,{variant:"destructive",children:[e.jsx(ye,{children:"Warning!"}),e.jsx(W,{children:"Please be carefull, this operation can not be rolled back."})]})]}),confirmText:"Delete",destructive:!0})}const Ss=T({email:i().min(1,{message:"Email is required."}).email({message:"Email is invalid."}),role:i().min(1,{message:"Role is required."}),desc:i().optional()});function Ps({open:s,onOpenChange:a}){const n=re({resolver:le(Ss),defaultValues:{email:"",role:"",desc:""}}),l=t=>{n.reset(),ue(t),a(!1)};return e.jsx(oe,{open:s,onOpenChange:t=>{n.reset(),a(t)},children:e.jsxs(ie,{className:"sm:max-w-md",children:[e.jsxs(ce,{className:"text-left",children:[e.jsxs(de,{className:"flex items-center gap-2",children:[e.jsx(he,{})," Invite User"]}),e.jsx(me,{children:"Invite new user to join your team by sending them an email invitation. Assign a role to define their access level."})]}),e.jsx(te,{...n,children:e.jsxs("form",{id:"user-invite-form",onSubmit:n.handleSubmit(l),className:"space-y-4",children:[e.jsx(m,{control:n.control,name:"email",render:({field:t})=>e.jsxs(p,{children:[e.jsx(u,{children:"Email"}),e.jsx(y,{children:e.jsx(v,{type:"email",placeholder:"eg: john.doe@gmail.com",...t})}),e.jsx(h,{})]})}),e.jsx(m,{control:n.control,name:"role",render:({field:t})=>e.jsxs(p,{className:"space-y-1",children:[e.jsx(u,{children:"Role"}),e.jsx(F,{defaultValue:t.value,onValueChange:t.onChange,placeholder:"Select a role",items:M.map(({label:o,value:c})=>({label:o,value:c}))}),e.jsx(h,{})]})}),e.jsx(m,{control:n.control,name:"desc",render:({field:t})=>e.jsxs(p,{className:"",children:[e.jsx(u,{children:"Description (optional)"}),e.jsx(y,{children:e.jsx(Ze,{className:"resize-none",placeholder:"Add a personal note to your invitation (optional)",...t})}),e.jsx(h,{})]})})]})}),e.jsxs(pe,{className:"gap-y-2",children:[e.jsx(Oe,{asChild:!0,children:e.jsx(g,{variant:"outline",children:"Cancel"})}),e.jsxs(g,{type:"submit",form:"user-invite-form",children:["Invite ",e.jsx(We,{})]})]})]})})}function Is(){const{open:s,setOpen:a,currentRow:n,setCurrentRow:l}=R();return e.jsxs(e.Fragment,{children:[e.jsx($,{open:s==="add",onOpenChange:()=>a("add")},"user-add"),e.jsx(Ps,{open:s==="invite",onOpenChange:()=>a("invite")},"user-invite"),n&&e.jsxs(e.Fragment,{children:[e.jsx($,{open:s==="edit",onOpenChange:()=>{a("edit"),setTimeout(()=>{l(null)},500)},currentRow:n},`user-edit-${n._id}`),e.jsx(Cs,{open:s==="delete",onOpenChange:()=>{a("delete"),setTimeout(()=>{l(null)},500)},currentRow:n},`user-delete-${n._id}`)]})]})}function Ds(){const{setOpen:s}=R();return e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(g,{variant:"outline",className:"space-x-1",onClick:()=>s("invite"),children:[e.jsx("span",{children:"Invite User"})," ",e.jsx(he,{size:18})]}),e.jsxs(g,{className:"space-x-1",onClick:()=>s("add"),children:[e.jsx("span",{children:"Add User"})," ",e.jsx(Me,{size:18})]})]})}function B({column:s,title:a,options:n}){const l=s?.getFacetedUniqueValues(),t=new Set(s?.getFilterValue());return e.jsxs(es,{children:[e.jsx(ss,{asChild:!0,children:e.jsxs(g,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[e.jsx(ke,{className:"h-4 w-4"}),a,t?.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(ns,{orientation:"vertical",className:"mx-2 h-4"}),e.jsx(S,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:t.size}),e.jsx("div",{className:"hidden space-x-1 lg:flex",children:t.size>2?e.jsxs(S,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[t.size," selected"]}):n.filter(o=>t.has(o.value)).map(o=>e.jsx(S,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:o.label},o.value))})]})]})}),e.jsx(as,{className:"w-[200px] p-0",align:"start",children:e.jsxs(He,{children:[e.jsx(Ke,{placeholder:a}),e.jsxs($e,{children:[e.jsx(Be,{children:"No results found."}),e.jsx(E,{children:n.map(o=>{const c=t.has(o.value);return e.jsxs(O,{onSelect:()=>{c?t.delete(o.value):t.add(o.value);const j=Array.from(t);s?.setFilterValue(j.length?j:void 0)},children:[e.jsx("div",{className:C("border-primary flex h-4 w-4 items-center justify-center rounded-sm border",c?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(Te,{className:C("h-4 w-4")})}),o.icon&&e.jsx(o.icon,{className:"text-muted-foreground h-4 w-4"}),e.jsx("span",{children:o.label}),l?.get?.(o.value)?e.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:l.get(o.value)}):null]},o.value)})}),t.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(Qe,{}),e.jsx(E,{children:e.jsx(O,{onSelect:()=>s?.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}function ks({table:s}){return e.jsxs(se,{modal:!1,children:[e.jsx(Re,{asChild:!0,children:e.jsxs(g,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[e.jsx(Ue,{className:"mr-2 h-4 w-4"}),"View"]})}),e.jsxs(ae,{align:"end",className:"w-[150px]",children:[e.jsx(Ve,{children:"Toggle columns"}),e.jsx(ne,{}),s.getAllColumns().filter(a=>typeof a.accessorFn<"u"&&a.getCanHide()).map(a=>e.jsx(ze,{className:"capitalize",checked:a.getIsVisible(),onCheckedChange:n=>a.toggleVisibility(!!n),children:a.id},a.id))]})]})}function Ts({table:s}){const a=s.getState().columnFilters.length>0;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 flex-col-reverse items-start gap-y-2 sm:flex-row sm:items-center sm:space-x-2",children:[e.jsx(v,{placeholder:"Filter by email...",value:s.getColumn("email")?.getFilterValue()??"",onChange:n=>s.getColumn("email")?.setFilterValue(n.target.value),className:"h-8 w-[150px] lg:w-[250px]"}),e.jsxs("div",{className:"flex gap-x-2",children:[s.getColumn("status")&&e.jsx(B,{column:s.getColumn("status"),title:"Status",options:[{label:"Active",value:"active"},{label:"Inactive",value:"inactive"},{label:"Pending",value:"pending"}]}),s.getColumn("role")&&e.jsx(B,{column:s.getColumn("role"),title:"Role",options:M.map(n=>({...n}))})]}),a&&e.jsxs(g,{variant:"ghost",onClick:()=>s.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(Ae,{className:"ml-2 h-4 w-4"})]})]}),e.jsx(ks,{table:s})]})}function Us({columns:s,data:a=[],isLoading:n}){const{table:l}=Xe({data:a,columns:s});return e.jsx(Ye,{table:l,columns:s,isLoading:n,toolbar:e.jsx(Ts,{table:l}),showToolbar:!0})}const As=(s={})=>Y({queryKey:I.users.list(s),queryFn:()=>gs(s),staleTime:5*60*1e3});function Fs(){const s=fe({strict:!1}),{data:a=[],isLoading:n,error:l}=As({company:s.company});return e.jsxs(us,{children:[e.jsxs(ve,{fixed:!0,children:[e.jsx(be,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(we,{}),e.jsx(Ce,{}),e.jsx(Se,{})]})]}),e.jsxs(Pe,{children:[e.jsxs("div",{className:"mb-2 flex flex-wrap items-center justify-between space-y-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"User List"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your users and their roles here."})]}),e.jsx(Ds,{})]}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-y-0 lg:space-x-12",children:l?e.jsxs(Z,{variant:"destructive",children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsx(W,{children:"Failed to load users. Please try again later."})]}):e.jsx(Us,{data:a,columns:xs,isLoading:n})})]}),e.jsx(Is,{})]})}const Na=Fs;export{Na as component};
