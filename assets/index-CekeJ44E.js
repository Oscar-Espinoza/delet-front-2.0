import{c as I,r as g,g as W,j as e,B as D,d as F,e as T,t as S}from"./index-LjicKyT0.js";import{d as X,e as Y,f as Z,H as ee,S as se,a as ae,T as ne,P as re,M as oe}from"./theme-switch-cMSK6cqB.js";import{C as U}from"./checkbox-w55iTThu.js";import{D as k}from"./data-table-column-header-NxjSLUJQ.js";import{L}from"./long-text-BEJQdRNd.js";import{D as te,e as le,f as ce,i as v,h as ie}from"./avatar-ZyuV-nlZ.js";import{E as de,P as me}from"./pencil-CMl5EI2J.js";import{U as xe}from"./users-DXKz1J5K.js";import{B as he}from"./building-BX9Rdkod.js";import{u as O,a as V,F as R,b as d,c as t,d as p,e as l,f as c}from"./form-Bf5yBnbc.js";import{D as H,a as B,b as z,c as K,d as $,e as q}from"./command-X9JjFxyP.js";import{I as i}from"./input-Dlu4Ie9G.js";import{T as G}from"./textarea-1eidY_GF.js";import{o as M,i as A,s as C,l as pe}from"./types-Wky072k2.js";import{P as je}from"./plus-D8USiGGy.js";import{u as ue,D as ge}from"./use-data-table-Bb2GNchX.js";/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],Ce=I("calendar-check",ye);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],we=I("house",fe);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],ve=I("package",Ne);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],ke=I("shopping-cart",be);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Pe=I("user-plus",De),J=g.createContext(void 0);function _(){const s=g.useContext(J);if(!s)throw new Error("useCompaniesContext must be used within CompaniesProvider");return s}function Ie({row:s}){const a=s.original,{setEditingCompany:n,setIsEditDialogOpen:j}=_(),u=W(),y=()=>{n(a),j(!0)},h=m=>{u.navigate({to:m,search:{company:a._id}})};return e.jsxs(te,{children:[e.jsx(le,{asChild:!0,children:e.jsxs(D,{variant:"ghost",className:"data-[state=open]:bg-muted h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(de,{className:"h-4 w-4"})]})}),e.jsxs(ce,{align:"end",className:"w-[160px]",children:[e.jsxs(v,{onClick:y,children:[e.jsx(me,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsx(ie,{}),e.jsxs(v,{onClick:()=>h("/users"),children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"Users"]}),e.jsxs(v,{onClick:()=>h("/leads"),children:[e.jsx(Pe,{className:"mr-2 h-4 w-4"}),"Leads"]}),e.jsxs(v,{onClick:()=>h("/bookings"),children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Bookings"]}),e.jsxs(v,{onClick:()=>h("/orders"),children:[e.jsx(ke,{className:"mr-2 h-4 w-4"}),"Orders"]}),e.jsxs(v,{onClick:()=>h("/properties"),children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"Properties"]}),e.jsxs(v,{onClick:()=>h("/structures"),children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),"Buildings"]}),e.jsxs(v,{onClick:()=>h("/kits"),children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),"Kits"]})]})]})}const Se=[{id:"select",header:({table:s})=>e.jsx(U,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:a=>s.toggleAllPageRowsSelected(!!a),"aria-label":"Select all",className:"translate-y-[2px]"}),meta:{className:F("sticky md:table-cell left-0 z-10 rounded-tl","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted")},cell:({row:s})=>e.jsx(U,{checked:s.getIsSelected(),onCheckedChange:a=>s.toggleSelected(!!a),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:({column:s})=>e.jsx(k,{column:s,title:"Company Name"}),cell:({row:s})=>e.jsxs("div",{className:"flex items-center space-x-2",children:[s.original.logoUrl&&e.jsx("img",{src:s.original.logoUrl,alt:s.getValue("name"),className:"h-8 w-8 rounded object-cover"}),e.jsx(L,{className:"max-w-48 font-medium",children:s.getValue("name")})]}),meta:{className:F("drop-shadow-[0_1px_2px_rgb(0_0_0_/_0.1)] dark:drop-shadow-[0_1px_2px_rgb(255_255_255_/_0.1)] lg:drop-shadow-none","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted","sticky left-6 md:table-cell")},enableHiding:!1},{accessorKey:"email",header:({column:s})=>e.jsx(k,{column:s,title:"Email"}),cell:({row:s})=>{const a=s.getValue("email");return a?e.jsx("a",{href:`mailto:${a}`,className:"text-blue-600 hover:underline",children:a}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}},{accessorKey:"phone",header:({column:s})=>e.jsx(k,{column:s,title:"Phone"}),cell:({row:s})=>{const a=s.getValue("phone");return a?e.jsx("div",{className:"text-nowrap",children:a}):e.jsx("span",{className:"text-muted-foreground",children:"-"})},enableSorting:!1},{id:"address",header:({column:s})=>e.jsx(k,{column:s,title:"Location"}),cell:({row:s})=>{const{address:a}=s.original;if(!a||!a.city&&!a.state&&!a.country)return e.jsx("span",{className:"text-muted-foreground",children:"-"});const n=[a.city,a.state,a.country].filter(Boolean);return e.jsx(L,{className:"max-w-48",children:n.join(", ")})},filterFn:(s,a,n)=>{const{address:j}=s.original;if(!j)return!1;const u=n.toLowerCase();return j.city?.toLowerCase().includes(u)||j.state?.toLowerCase().includes(u)||j.country?.toLowerCase().includes(u)||!1}},{accessorKey:"units",header:({column:s})=>e.jsx(k,{column:s,title:"Units"}),cell:({row:s})=>{const a=s.getValue("units");return a?e.jsx("div",{className:"text-center",children:a}):e.jsx("span",{className:"text-muted-foreground text-center",children:"-"})}},{accessorKey:"description",header:({column:s})=>e.jsx(k,{column:s,title:"Description"}),cell:({row:s})=>{const a=s.getValue("description");return a?e.jsx(L,{className:"max-w-64",children:a}):e.jsx("span",{className:"text-muted-foreground",children:"-"})},enableSorting:!1},{id:"actions",cell:Ie}],Q=M({name:C().min(1,"Company name is required").trim(),idImage:A(File).optional(),units:C().optional(),address:M({street:C().optional(),city:C().optional(),state:C().optional(),postalCode:C().optional(),country:C().optional()}).optional(),phone:C().optional(),email:C().email("Invalid email address").optional().or(pe("")),description:C().optional(),users:C().optional(),logo:A(File).optional()});function _e(){const{isCreateDialogOpen:s,setIsCreateDialogOpen:a}=_(),n=X(),[j,u]=g.useState(null),[y,h]=g.useState(null),m=O({resolver:V(Q),defaultValues:{name:"",units:"",address:{street:"",city:"",state:"",postalCode:"",country:""},phone:"",email:"",description:"",users:""}}),P=async r=>{try{await n.mutateAsync(r),S.success("Company created successfully"),m.reset(),u(null),h(null),a(!1)}catch{S.error("Failed to create company")}},x=r=>{const f=r.target.files?.[0];if(f){m.setValue("logo",f);const w=new FileReader;w.onloadend=()=>{u(w.result)},w.readAsDataURL(f)}},E=r=>{const f=r.target.files?.[0];if(f){m.setValue("idImage",f);const w=new FileReader;w.onloadend=()=>{h(w.result)},w.readAsDataURL(f)}};return e.jsx(H,{open:s,onOpenChange:a,children:e.jsxs(B,{className:"sm:max-w-[625px]",children:[e.jsxs(z,{children:[e.jsx(K,{children:"Create Company"}),e.jsx($,{children:"Add a new company to your system. Fill in the company details below."})]}),e.jsx(R,{...m,children:e.jsxs("form",{onSubmit:m.handleSubmit(P),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(d,{control:m.control,name:"name",render:({field:r})=>e.jsxs(t,{className:"col-span-2",children:[e.jsx(p,{children:"Company Name *"}),e.jsx(l,{children:e.jsx(i,{placeholder:"Enter company name",...r})}),e.jsx(c,{})]})}),e.jsx(d,{control:m.control,name:"email",render:({field:r})=>e.jsxs(t,{children:[e.jsx(p,{children:"Email"}),e.jsx(l,{children:e.jsx(i,{type:"email",placeholder:"company@example.com",...r})}),e.jsx(c,{})]})}),e.jsx(d,{control:m.control,name:"phone",render:({field:r})=>e.jsxs(t,{children:[e.jsx(p,{children:"Phone"}),e.jsx(l,{children:e.jsx(i,{placeholder:"+1 (555) 000-0000",...r})}),e.jsx(c,{})]})}),e.jsx(d,{control:m.control,name:"units",render:({field:r})=>e.jsxs(t,{children:[e.jsx(p,{children:"Units"}),e.jsx(l,{children:e.jsx(i,{placeholder:"Number of units",...r})}),e.jsx(c,{})]})}),e.jsx(d,{control:m.control,name:"users",render:({field:r})=>e.jsxs(t,{children:[e.jsx(p,{children:"Users"}),e.jsx(l,{children:e.jsx(i,{placeholder:"Users information",...r})}),e.jsx(c,{})]})}),e.jsxs(t,{className:"col-span-2",children:[e.jsx(p,{children:"ID Image"}),e.jsx(l,{children:e.jsx(i,{type:"file",accept:"image/*",onChange:E})}),y&&e.jsx("img",{src:y,alt:"ID Image preview",className:"mt-2 h-20 w-20 rounded object-cover"}),e.jsx(c,{})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(p,{children:"Address"}),e.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-4",children:[e.jsx(d,{control:m.control,name:"address.street",render:({field:r})=>e.jsxs(t,{className:"col-span-2",children:[e.jsx(l,{children:e.jsx(i,{placeholder:"Street address",...r})}),e.jsx(c,{})]})}),e.jsx(d,{control:m.control,name:"address.city",render:({field:r})=>e.jsxs(t,{children:[e.jsx(l,{children:e.jsx(i,{placeholder:"City",...r})}),e.jsx(c,{})]})}),e.jsx(d,{control:m.control,name:"address.state",render:({field:r})=>e.jsxs(t,{children:[e.jsx(l,{children:e.jsx(i,{placeholder:"State/Province",...r})}),e.jsx(c,{})]})}),e.jsx(d,{control:m.control,name:"address.postalCode",render:({field:r})=>e.jsxs(t,{children:[e.jsx(l,{children:e.jsx(i,{placeholder:"Postal code",...r})}),e.jsx(c,{})]})}),e.jsx(d,{control:m.control,name:"address.country",render:({field:r})=>e.jsxs(t,{children:[e.jsx(l,{children:e.jsx(i,{placeholder:"Country",...r})}),e.jsx(c,{})]})})]})]}),e.jsx(d,{control:m.control,name:"description",render:({field:r})=>e.jsxs(t,{className:"col-span-2",children:[e.jsx(p,{children:"Description"}),e.jsx(l,{children:e.jsx(G,{placeholder:"Enter company description",className:"resize-none",rows:3,...r})}),e.jsx(c,{})]})}),e.jsxs(t,{className:"col-span-2",children:[e.jsx(p,{children:"Company Logo"}),e.jsx(l,{children:e.jsx(i,{type:"file",accept:"image/*",onChange:x})}),j&&e.jsx("img",{src:j,alt:"Logo preview",className:"mt-2 h-20 w-20 rounded object-cover"}),e.jsx(c,{})]})]}),e.jsxs(q,{children:[e.jsx(D,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsxs(D,{type:"submit",disabled:n.isPending,children:[n.isPending&&e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Company"]})]})]})})]})})}function Ee(){const{isEditDialogOpen:s,setIsEditDialogOpen:a,editingCompany:n,setEditingCompany:j}=_(),u=Y(),[y,h]=g.useState(null),[m,P]=g.useState(null),x=O({resolver:V(Q),defaultValues:{name:"",units:"",address:{street:"",city:"",state:"",postalCode:"",country:""},phone:"",email:"",description:"",users:""}});g.useEffect(()=>{n&&(x.reset({name:n.name||"",units:n.units||"",address:{street:n.address?.street||"",city:n.address?.city||"",state:n.address?.state||"",postalCode:n.address?.postalCode||"",country:n.address?.country||""},phone:n.phone||"",email:n.email||"",description:n.description||"",users:n.users||""}),h(n.logoUrl||null),P(n.idImage||null))},[n,x]);const E=async o=>{if(n)try{await u.mutateAsync({_id:n._id,...o}),S.success("Company updated successfully"),w()}catch{S.error("Failed to update company")}},r=o=>{const N=o.target.files?.[0];if(N){x.setValue("logo",N);const b=new FileReader;b.onloadend=()=>{h(b.result)},b.readAsDataURL(N)}},f=o=>{const N=o.target.files?.[0];if(N){x.setValue("idImage",N);const b=new FileReader;b.onloadend=()=>{P(b.result)},b.readAsDataURL(N)}},w=()=>{a(!1),j(null),x.reset(),h(null),P(null)};return e.jsx(H,{open:s,onOpenChange:a,children:e.jsxs(B,{className:"sm:max-w-[625px]",children:[e.jsxs(z,{children:[e.jsx(K,{children:"Edit Company"}),e.jsx($,{children:"Update company details. Changes will be saved immediately."})]}),e.jsx(R,{...x,children:e.jsxs("form",{onSubmit:x.handleSubmit(E),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(d,{control:x.control,name:"name",render:({field:o})=>e.jsxs(t,{className:"col-span-2",children:[e.jsx(p,{children:"Company Name *"}),e.jsx(l,{children:e.jsx(i,{placeholder:"Enter company name",...o})}),e.jsx(c,{})]})}),e.jsx(d,{control:x.control,name:"email",render:({field:o})=>e.jsxs(t,{children:[e.jsx(p,{children:"Email"}),e.jsx(l,{children:e.jsx(i,{type:"email",placeholder:"company@example.com",...o})}),e.jsx(c,{})]})}),e.jsx(d,{control:x.control,name:"phone",render:({field:o})=>e.jsxs(t,{children:[e.jsx(p,{children:"Phone"}),e.jsx(l,{children:e.jsx(i,{placeholder:"+1 (555) 000-0000",...o})}),e.jsx(c,{})]})}),e.jsx(d,{control:x.control,name:"units",render:({field:o})=>e.jsxs(t,{children:[e.jsx(p,{children:"Units"}),e.jsx(l,{children:e.jsx(i,{placeholder:"Number of units",...o})}),e.jsx(c,{})]})}),e.jsx(d,{control:x.control,name:"users",render:({field:o})=>e.jsxs(t,{children:[e.jsx(p,{children:"Users"}),e.jsx(l,{children:e.jsx(i,{placeholder:"Users information",...o})}),e.jsx(c,{})]})}),e.jsxs(t,{className:"col-span-2",children:[e.jsx(p,{children:"ID Image"}),e.jsx(l,{children:e.jsx(i,{type:"file",accept:"image/*",onChange:f})}),m&&e.jsx("img",{src:m,alt:"ID Image preview",className:"mt-2 h-20 w-20 rounded object-cover"}),e.jsx(c,{})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(p,{children:"Address"}),e.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-4",children:[e.jsx(d,{control:x.control,name:"address.street",render:({field:o})=>e.jsxs(t,{className:"col-span-2",children:[e.jsx(l,{children:e.jsx(i,{placeholder:"Street address",...o})}),e.jsx(c,{})]})}),e.jsx(d,{control:x.control,name:"address.city",render:({field:o})=>e.jsxs(t,{children:[e.jsx(l,{children:e.jsx(i,{placeholder:"City",...o})}),e.jsx(c,{})]})}),e.jsx(d,{control:x.control,name:"address.state",render:({field:o})=>e.jsxs(t,{children:[e.jsx(l,{children:e.jsx(i,{placeholder:"State/Province",...o})}),e.jsx(c,{})]})}),e.jsx(d,{control:x.control,name:"address.postalCode",render:({field:o})=>e.jsxs(t,{children:[e.jsx(l,{children:e.jsx(i,{placeholder:"Postal code",...o})}),e.jsx(c,{})]})}),e.jsx(d,{control:x.control,name:"address.country",render:({field:o})=>e.jsxs(t,{children:[e.jsx(l,{children:e.jsx(i,{placeholder:"Country",...o})}),e.jsx(c,{})]})})]})]}),e.jsx(d,{control:x.control,name:"description",render:({field:o})=>e.jsxs(t,{className:"col-span-2",children:[e.jsx(p,{children:"Description"}),e.jsx(l,{children:e.jsx(G,{placeholder:"Enter company description",className:"resize-none",rows:3,...o})}),e.jsx(c,{})]})}),e.jsxs(t,{className:"col-span-2",children:[e.jsx(p,{children:"Company Logo"}),e.jsx(l,{children:e.jsx(i,{type:"file",accept:"image/*",onChange:r})}),y&&e.jsx("img",{src:y,alt:"Logo preview",className:"mt-2 h-20 w-20 rounded object-cover"}),e.jsx(c,{})]})]}),e.jsxs(q,{children:[e.jsx(D,{type:"button",variant:"outline",onClick:w,children:"Cancel"}),e.jsxs(D,{type:"submit",disabled:u.isPending,children:[u.isPending&&e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Company"]})]})]})})]})})}function Le(){return e.jsxs(e.Fragment,{children:[e.jsx(_e,{}),e.jsx(Ee,{})]})}function Fe(){const{setIsCreateDialogOpen:s}=_();return e.jsxs(D,{size:"sm",onClick:()=>s(!0),children:[e.jsx(je,{className:"mr-2 h-4 w-4"}),"Add Company"]})}function Ue({columns:s,data:a,isLoading:n}){const{table:j}=ue({data:a,columns:s});return e.jsx(ge,{table:j,columns:s,isLoading:n,searchColumn:"name",searchPlaceholder:"Filter companies..."})}function Me({children:s}){const[a,n]=g.useState(!1),[j,u]=g.useState(!1),[y,h]=g.useState(null);return e.jsx(J.Provider,{value:{isCreateDialogOpen:a,setIsCreateDialogOpen:n,isEditDialogOpen:j,setIsEditDialogOpen:u,editingCompany:y,setEditingCompany:h},children:s})}function Ye(){const[s,a]=g.useState(1),[n]=g.useState(10),{data:j,isLoading:u,error:y}=Z({page:s,limit:n,isAdmin:!0}),h=j?.companies||[];return y?e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Error loading companies"}),e.jsx("p",{className:"text-muted-foreground",children:"Please try again later"})]})}):e.jsxs(Me,{children:[e.jsxs(ee,{fixed:!0,children:[e.jsx(se,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(ae,{}),e.jsx(ne,{}),e.jsx(re,{})]})]}),e.jsxs(oe,{children:[e.jsxs("div",{className:"mb-2 flex flex-wrap items-center justify-between space-y-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Companies"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your companies and their information here."})]}),e.jsx(Fe,{})]}),e.jsx("div",{className:"-mx-4 flex-1 overflow-auto px-4 py-1 lg:flex-row lg:space-y-0 lg:space-x-12",children:e.jsx(Ue,{data:h,columns:Se,isLoading:u})})]}),e.jsx(Le,{})]})}export{Ye as C};
