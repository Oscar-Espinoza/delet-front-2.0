import{l as we,D as je,J as Pe,m as Ie,n as Ae,v as Me,w as Re,x as ke,y as Te,z as Ne,C as Oe,E as De,H as Ce,c as Ke,r,j as o,d as Z,k as Qe,a as Xe,h as Ye,B as Se,t as k,L as et}from"./index-LjicKyT0.js";import{C as tt,a as nt,b as rt,c as at,d as ot,e as it}from"./card-COJmpkDS.js";import{A as st}from"./auth-layout-onepyk7M.js";import{u as lt,a as ct,F as ut,b as dt,c as pt,d as mt,e as ft,f as gt}from"./form-Bf5yBnbc.js";import{a as oe,A as ie}from"./assertValidationError-DSHwLRL8.js";import{a as be,r as ht}from"./autoSignIn-BMLW60Lb.js";import{o as vt,s as xt}from"./types-Wky072k2.js";import"./index-BWm_iZMh.js";const Ct=e=>we(Ae,Ie("ResendConfirmationCode"),Pe(),{...je,...e});async function St(e){const{username:t}=e;oe(!!t,ie.EmptySignUpUsername);const n=Me.getConfig().Auth?.Cognito;Re(n);const{userPoolClientId:s,userPoolId:p,userPoolEndpoint:l}=n,x=e.options?.clientMetadata,C=ke({username:t,userPoolId:p,userPoolClientId:s}),y=Ct({endpointResolver:De({endpointOverride:l})}),{CodeDeliveryDetails:S}=await y({region:Ne(n.userPoolId),userAgentValue:Te(Oe.ResendSignUpCode)},{Username:t,ClientMetadata:x,ClientId:n.userPoolClientId,UserContextData:C}),{DeliveryMedium:I,AttributeName:b,Destination:m}={...S};return{destination:m,deliveryMedium:I,attributeName:b||void 0}}const bt=e=>we(Ae,Ie("ConfirmSignUp"),Pe(),{...je,...e});async function Et(e){const{username:t,confirmationCode:n,options:s}=e,p=Me.getConfig().Auth?.Cognito;Re(p);const{userPoolId:l,userPoolClientId:x,userPoolEndpoint:C}=p,y=s?.clientMetadata;oe(!!t,ie.EmptyConfirmSignUpUsername),oe(!!n,ie.EmptyConfirmSignUpCode);const S=ke({username:t,userPoolId:l,userPoolClientId:x}),I=bt({endpointResolver:De({endpointOverride:C})}),{Session:b}=await I({region:Ne(p.userPoolId),userAgentValue:Te(Oe.ConfirmSignUp)},{Username:t,ConfirmationCode:n,ClientMetadata:y,ForceAliasCreation:s?.forceAliasCreation,ClientId:p.userPoolClientId,UserContextData:S});return new Promise((m,f)=>{try{const c={isSignUpComplete:!0,nextStep:{signUpStep:"DONE"}},w=be.getState();if(!w.active||w.username!==t){m(c),ht();return}be.dispatch({type:"SET_SESSION",value:b});const T=Ce.listen("auth-internal",({payload:u})=>{switch(u.event){case"autoSignIn":m({isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"}}),T()}});Ce.dispatch("auth-internal",{event:"confirmSignUp",data:c})}catch(c){f(c)}})}/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=[["path",{d:"M5 12h14",key:"1ays0h"}]],wt=Ke("minus",yt);var jt=Object.defineProperty,Pt=Object.defineProperties,It=Object.getOwnPropertyDescriptors,X=Object.getOwnPropertySymbols,Ue=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable,Ee=(e,t,n)=>t in e?jt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,At=(e,t)=>{for(var n in t||(t={}))Ue.call(t,n)&&Ee(e,n,t[n]);if(X)for(var n of X(t))Fe.call(t,n)&&Ee(e,n,t[n]);return e},Mt=(e,t)=>Pt(e,It(t)),Rt=(e,t)=>{var n={};for(var s in e)Ue.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(e!=null&&X)for(var s of X(e))t.indexOf(s)<0&&Fe.call(e,s)&&(n[s]=e[s]);return n};function kt(e){let t=setTimeout(e,0),n=setTimeout(e,10),s=setTimeout(e,50);return[t,n,s]}function Tt(e){let t=r.useRef();return r.useEffect(()=>{t.current=e}),t.current}var Nt=18,_e=40,Ot=`${_e}px`,Dt=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function Ut({containerRef:e,inputRef:t,pushPasswordManagerStrategy:n,isFocused:s}){let[p,l]=r.useState(!1),[x,C]=r.useState(!1),[y,S]=r.useState(!1),I=r.useMemo(()=>n==="none"?!1:(n==="increase-width"||n==="experimental-no-flickering")&&p&&x,[p,x,n]),b=r.useCallback(()=>{let m=e.current,f=t.current;if(!m||!f||y||n==="none")return;let c=m,w=c.getBoundingClientRect().left+c.offsetWidth,T=c.getBoundingClientRect().top+c.offsetHeight/2,u=w-Nt,V=T;document.querySelectorAll(Dt).length===0&&document.elementFromPoint(u,V)===m||(l(!0),S(!0))},[e,t,y,n]);return r.useEffect(()=>{let m=e.current;if(!m||n==="none")return;function f(){let w=window.innerWidth-m.getBoundingClientRect().right;C(w>=_e)}f();let c=setInterval(f,1e3);return()=>{clearInterval(c)}},[e,n]),r.useEffect(()=>{let m=s||document.activeElement===t.current;if(n==="none"||!m)return;let f=setTimeout(b,0),c=setTimeout(b,2e3),w=setTimeout(b,5e3),T=setTimeout(()=>{S(!0)},6e3);return()=>{clearTimeout(f),clearTimeout(c),clearTimeout(w),clearTimeout(T)}},[t,s,n,b]),{hasPWMBadge:p,willPushPWMBadge:I,PWM_BADGE_SPACE_WIDTH:Ot}}var Le=r.createContext({}),Be=r.forwardRef((e,t)=>{var n=e,{value:s,onChange:p,maxLength:l,textAlign:x="left",pattern:C,placeholder:y,inputMode:S="numeric",onComplete:I,pushPasswordManagerStrategy:b="increase-width",pasteTransformer:m,containerClassName:f,noScriptCSSFallback:c=Ft,render:w,children:T}=n,u=Rt(n,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),V,se,le,ce,ue;let[We,He]=r.useState(typeof u.defaultValue=="string"?u.defaultValue:""),g=s??We,D=Tt(g),z=r.useCallback(a=>{p?.(a),He(a)},[p]),M=r.useMemo(()=>C?typeof C=="string"?new RegExp(C):C:null,[C]),h=r.useRef(null),Y=r.useRef(null),ee=r.useRef({value:g,onChange:z,isIOS:typeof window<"u"&&((se=(V=window?.CSS)==null?void 0:V.supports)==null?void 0:se.call(V,"-webkit-touch-callout","none"))}),K=r.useRef({prev:[(le=h.current)==null?void 0:le.selectionStart,(ce=h.current)==null?void 0:ce.selectionEnd,(ue=h.current)==null?void 0:ue.selectionDirection]});r.useImperativeHandle(t,()=>h.current,[]),r.useEffect(()=>{let a=h.current,i=Y.current;if(!a||!i)return;ee.current.value!==a.value&&ee.current.onChange(a.value),K.current.prev=[a.selectionStart,a.selectionEnd,a.selectionDirection];function v(){if(document.activeElement!==a){$(null),q(null);return}let d=a.selectionStart,E=a.selectionEnd,Q=a.selectionDirection,A=a.maxLength,F=a.value,R=K.current.prev,N=-1,O=-1,_;if(F.length!==0&&d!==null&&E!==null){let qe=d===E,Je=d===F.length&&F.length<A;if(qe&&!Je){let L=d;if(L===0)N=0,O=1,_="forward";else if(L===A)N=L-1,O=L,_="backward";else if(A>1&&F.length>1){let re=0;if(R[0]!==null&&R[1]!==null){_=L<R[1]?"backward":"forward";let Ze=R[0]===R[1]&&R[0]<A;_==="backward"&&!Ze&&(re=-1)}N=re+L,O=re+L+1}}N!==-1&&O!==-1&&N!==O&&h.current.setSelectionRange(N,O,_)}let ve=N!==-1?N:d,xe=O!==-1?O:E,$e=_??Q;$(ve),q(xe),K.current.prev=[ve,xe,$e]}if(document.addEventListener("selectionchange",v,{capture:!0}),v(),document.activeElement===a&&te(!0),!document.getElementById("input-otp-style")){let d=document.createElement("style");if(d.id="input-otp-style",document.head.appendChild(d),d.sheet){let E="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";J(d.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),J(d.sheet,`[data-input-otp]:autofill { ${E} }`),J(d.sheet,`[data-input-otp]:-webkit-autofill { ${E} }`),J(d.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),J(d.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let j=()=>{i&&i.style.setProperty("--root-height",`${a.clientHeight}px`)};j();let P=new ResizeObserver(j);return P.observe(a),()=>{document.removeEventListener("selectionchange",v,{capture:!0}),P.disconnect()}},[]);let[de,pe]=r.useState(!1),[G,te]=r.useState(!1),[U,$]=r.useState(null),[B,q]=r.useState(null);r.useEffect(()=>{kt(()=>{var a,i,v,j;(a=h.current)==null||a.dispatchEvent(new Event("input"));let P=(i=h.current)==null?void 0:i.selectionStart,d=(v=h.current)==null?void 0:v.selectionEnd,E=(j=h.current)==null?void 0:j.selectionDirection;P!==null&&d!==null&&($(P),q(d),K.current.prev=[P,d,E])})},[g,G]),r.useEffect(()=>{D!==void 0&&g!==D&&D.length<l&&g.length===l&&I?.(g)},[l,I,D,g]);let W=Ut({containerRef:Y,inputRef:h,pushPasswordManagerStrategy:b,isFocused:G}),me=r.useCallback(a=>{let i=a.currentTarget.value.slice(0,l);if(i.length>0&&M&&!M.test(i)){a.preventDefault();return}typeof D=="string"&&i.length<D.length&&document.dispatchEvent(new Event("selectionchange")),z(i)},[l,z,D,M]),fe=r.useCallback(()=>{var a;if(h.current){let i=Math.min(h.current.value.length,l-1),v=h.current.value.length;(a=h.current)==null||a.setSelectionRange(i,v),$(i),q(v)}te(!0)},[l]),ge=r.useCallback(a=>{var i,v;let j=h.current;if(!m&&(!ee.current.isIOS||!a.clipboardData||!j))return;let P=a.clipboardData.getData("text/plain"),d=m?m(P):P;a.preventDefault();let E=(i=h.current)==null?void 0:i.selectionStart,Q=(v=h.current)==null?void 0:v.selectionEnd,A=(E!==Q?g.slice(0,E)+d+g.slice(Q):g.slice(0,E)+d+g.slice(E)).slice(0,l);if(A.length>0&&M&&!M.test(A))return;j.value=A,z(A);let F=Math.min(A.length,l-1),R=A.length;j.setSelectionRange(F,R),$(F),q(R)},[l,z,M,g]),Ve=r.useMemo(()=>({position:"relative",cursor:u.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[u.disabled]),he=r.useMemo(()=>({position:"absolute",inset:0,width:W.willPushPWMBadge?`calc(100% + ${W.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:W.willPushPWMBadge?`inset(0 ${W.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:x,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[W.PWM_BADGE_SPACE_WIDTH,W.willPushPWMBadge,x]),ze=r.useMemo(()=>r.createElement("input",Mt(At({autoComplete:u.autoComplete||"one-time-code"},u),{"data-input-otp":!0,"data-input-otp-placeholder-shown":g.length===0||void 0,"data-input-otp-mss":U,"data-input-otp-mse":B,inputMode:S,pattern:M?.source,"aria-placeholder":y,style:he,maxLength:l,value:g,ref:h,onPaste:a=>{var i;ge(a),(i=u.onPaste)==null||i.call(u,a)},onChange:me,onMouseOver:a=>{var i;pe(!0),(i=u.onMouseOver)==null||i.call(u,a)},onMouseLeave:a=>{var i;pe(!1),(i=u.onMouseLeave)==null||i.call(u,a)},onFocus:a=>{var i;fe(),(i=u.onFocus)==null||i.call(u,a)},onBlur:a=>{var i;te(!1),(i=u.onBlur)==null||i.call(u,a)}})),[me,fe,ge,S,he,l,B,U,u,M?.source,g]),ne=r.useMemo(()=>({slots:Array.from({length:l}).map((a,i)=>{var v;let j=G&&U!==null&&B!==null&&(U===B&&i===U||i>=U&&i<B),P=g[i]!==void 0?g[i]:null,d=g[0]!==void 0?null:(v=y?.[i])!=null?v:null;return{char:P,placeholderChar:d,isActive:j,hasFakeCaret:j&&P===null}}),isFocused:G,isHovering:!u.disabled&&de}),[G,de,l,B,U,u.disabled,g]),Ge=r.useMemo(()=>w?w(ne):r.createElement(Le.Provider,{value:ne},T),[T,ne,w]);return r.createElement(r.Fragment,null,c!==null&&r.createElement("noscript",null,r.createElement("style",null,c)),r.createElement("div",{ref:Y,"data-input-otp-container":!0,style:Ve,className:f},Ge,r.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},ze)))});Be.displayName="Input";function J(e,t){try{e.insertRule(t)}catch{console.error("input-otp could not insert CSS rule:",t)}}var Ft=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;function _t({className:e,containerClassName:t,...n}){return o.jsx(Be,{"data-slot":"input-otp",containerClassName:Z("flex items-center gap-2 has-disabled:opacity-50",t),className:Z("disabled:cursor-not-allowed",e),...n})}function ae({className:e,...t}){return o.jsx("div",{"data-slot":"input-otp-group",className:Z("flex items-center",e),...t})}function H({index:e,className:t,...n}){const s=r.useContext(Le),{char:p,hasFakeCaret:l,isActive:x}=s?.slots[e]??{};return o.jsxs("div",{"data-slot":"input-otp-slot","data-active":x,className:Z("data-[active=true]:border-ring data-[active=true]:ring-ring/50 data-[active=true]:aria-invalid:ring-destructive/20 dark:data-[active=true]:aria-invalid:ring-destructive/40 aria-invalid:border-destructive data-[active=true]:aria-invalid:border-destructive dark:bg-input/30 border-input relative flex h-9 w-9 items-center justify-center border-y border-r text-sm shadow-xs transition-all outline-none first:rounded-l-md first:border-l last:rounded-r-md data-[active=true]:z-10 data-[active=true]:ring-[3px]",t),...n,children:[p,l&&o.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:o.jsx("div",{className:"animate-caret-blink bg-foreground h-4 w-px duration-1000"})})]})}function ye({...e}){return o.jsx("div",{"data-slot":"input-otp-separator",role:"separator",...e,children:o.jsx(wt,{})})}const Lt=vt({otp:xt().min(1,{message:"Please enter your otp code."})});function Bt({className:e,...t}){const n=Qe(),s=Xe({strict:!1}),[p,l]=r.useState(!1),[x,C]=r.useState(!1),{checkAuthStatus:y}=Ye(f=>f.auth),S=lt({resolver:ct(Lt),defaultValues:{otp:""}}),I=S.watch("otp");async function b(f){if(!s.email){k.error("Email is required for verification");return}l(!0);try{await Et({username:s.email,confirmationCode:f.otp}),await y(),k.success("Email verified successfully!"),n({to:"/"})}catch(c){c instanceof Error&&c.name==="CodeMismatchException"?k.error("Invalid verification code"):c instanceof Error&&c.name==="ExpiredCodeException"?k.error("Verification code has expired"):c instanceof Error&&c.name==="NotAuthorizedException"?k.error("User is already confirmed"):k.error(c instanceof Error?c.message:"Failed to verify code")}finally{l(!1)}}async function m(){if(!s.email){k.error("Email is required");return}C(!0);try{await St({username:s.email}),k.success("Verification code resent to your email")}catch(f){k.error(f instanceof Error?f.message:"Failed to resend code")}finally{C(!1)}}return o.jsx(ut,{...S,children:o.jsxs("form",{onSubmit:S.handleSubmit(b),className:Z("grid gap-2",e),...t,children:[o.jsx(dt,{control:S.control,name:"otp",render:({field:f})=>o.jsxs(pt,{children:[o.jsx(mt,{className:"sr-only",children:"One-Time Password"}),o.jsx(ft,{children:o.jsxs(_t,{maxLength:6,...f,containerClassName:'justify-between sm:[&>[data-slot="input-otp-group"]>div]:w-12',children:[o.jsxs(ae,{children:[o.jsx(H,{index:0}),o.jsx(H,{index:1})]}),o.jsx(ye,{}),o.jsxs(ae,{children:[o.jsx(H,{index:2}),o.jsx(H,{index:3})]}),o.jsx(ye,{}),o.jsxs(ae,{children:[o.jsx(H,{index:4}),o.jsx(H,{index:5})]})]})}),o.jsx(gt,{})]})}),o.jsx(Se,{className:"mt-2",disabled:I.length<6||p,children:p?"Verifying...":"Verify"}),o.jsx("div",{className:"mt-4 text-center",children:o.jsx(Se,{type:"button",variant:"outline",onClick:m,disabled:x,className:"text-sm",children:x?"Resending...":"Resend Code"})})]})})}function Wt(){return o.jsx(st,{children:o.jsxs(tt,{className:"gap-4",children:[o.jsxs(nt,{children:[o.jsx(rt,{className:"text-base tracking-tight",children:"Two-factor Authentication"}),o.jsxs(at,{children:["Please enter the authentication code. ",o.jsx("br",{})," We have sent the authentication code to your email."]})]}),o.jsx(ot,{children:o.jsx(Bt,{})}),o.jsx(it,{children:o.jsxs("p",{className:"text-muted-foreground px-8 text-center text-sm",children:["Haven't received it?"," ",o.jsx(et,{to:"/sign-in",className:"hover:text-primary underline underline-offset-4",children:"Resend a new code."}),"."]})})]})})}const Kt=Wt;export{Kt as component};
