import{c as D,r as i,j as s,f as R,A as _,t as w,B as U,d as M,a as oe}from"./index-LjicKyT0.js";import{u as le,b as q,q as F,c as h,H as ce,S as de,a as pe,T as ue,P as me,M as he}from"./theme-switch-cMSK6cqB.js";import{D as $,a as L,b as B,c as G,X as ge,C as xe,f as ye,g as fe,h as je,i as Y,j as W,k as Ce,S as we}from"./command-X9JjFxyP.js";import{A as Ne,a as ve,b as Pe,c as De,d as Se,e as be,f as Ie,g as Te}from"./alert-dialog-DavZlUbV.js";import{o as Ee,a as ke,i as Z,s as x,b as Me,c as Ae,e as X,l as Fe}from"./types-Wky072k2.js";import{P as Ve}from"./plus-D8USiGGy.js";import{u as Oe,g as Re,a as _e,b as Ue,c as qe,d as He,e as ze,T as Ke,f as $e,h as O,i as Le,j as J,k as Be,l as z}from"./table-zh_l_sMN.js";import{D as C,a as Ge,S as Qe,b as Ye}from"./data-table-column-header-NxjSLUJQ.js";import{B as A}from"./badge-4kjocfwo.js";import{C as ee}from"./checkbox-w55iTThu.js";import{L as We}from"./long-text-BEJQdRNd.js";import{D as Ze,e as Xe,f as Je,i as v,h as se}from"./avatar-ZyuV-nlZ.js";import{E as es,P as ss}from"./pencil-CMl5EI2J.js";import{E as ts}from"./eye-D5U1iGxZ.js";import{T as rs}from"./trash-2-BnkWnZhX.js";import{C as as}from"./check-D7e09AXV.js";import{U as ns}from"./users-DXKz1J5K.js";import{C as is}from"./calendar-aOaMqUqa.js";import{f as os}from"./format-BvUxDbfm.js";import{P as ls,C as cs,a as ds}from"./react-icons.esm-_L3V94na.js";import{I as ps}from"./input-Dlu4Ie9G.js";import{P as us,a as ms,b as hs}from"./popover-Bpz0jySH.js";import{S as gs}from"./separator-CLg1W5b9.js";import"./select-w6OWzPxW.js";import"./index-DbJ88n5W.js";import"./index-BWm_iZMh.js";import"./index-CVPNRdpP.js";import"./index-CJhIcW8r.js";import"./index-BqMrZ-WO.js";import"./index-BK3YptDx.js";import"./index-BvwaI8vX.js";import"./createReactComponent-Dm51iCRd.js";import"./index-DgBTolnX.js";import"./index-DVkuEz9K.js";/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],ys=D("archive",xs);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],js=D("building-2",fs);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ws=D("copy",Cs);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],vs=D("dollar-sign",Ns);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],te=D("link",Ps);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Ss=D("rotate-cw",Ds),re=i.createContext(void 0),Q=()=>{const e=i.useContext(re);if(!e)throw new Error("usePropertiesContext must be used within a PropertiesProvider");return e};function bs({open:e,onOpenChange:t}){return s.jsx($,{open:e,onOpenChange:t,children:s.jsxs(L,{className:"max-w-2xl",children:[s.jsx(B,{children:s.jsx(G,{children:"Create Property"})}),s.jsx("div",{className:"py-4",children:s.jsx("p",{className:"text-muted-foreground",children:"Create property form will be implemented here."})})]})})}const V={getProperties:async e=>{const t={page:e?.page?e.page-1:0,limit:e?.limit||10,filters:{},sort:{},select:[]};return e?.search&&(t.filters.search=e.search),e?.status&&e.status.length>0&&(t.filters.status=e.status),e?.type&&e.type.length>0&&(t.filters.propertyType=e.type),e?.companiesIds&&e.companiesIds.length>0&&(t.filters.companies=e.companiesIds),e?.classification&&e.classification.length>0&&(t.filters.classification=e.classification),e?.sortBy&&(t.sort[e.sortBy]=e.sortOrder==="desc"?-1:1),await h.post("/api/property/admin/search",t)},getProperty:async e=>await h.get(`/api/property/${e}`),createProperty:async e=>{const t=new FormData;return e.shortAddress&&t.append("shortAddress",e.shortAddress),e.street&&t.append("street",e.street),e.unit&&t.append("unit",e.unit),e.city&&t.append("city",e.city),e.state&&t.append("state",e.state),e.zipCode&&t.append("zipCode",e.zipCode),t.append("type",e.type),t.append("status",e.status),e.price&&t.append("price",e.price.toString()),t.append("isManaged",e.isManaged.toString()),e.redirectUrl&&t.append("redirectUrl",e.redirectUrl),e.company&&t.append("company",e.company),e.kit&&t.append("kit",e.kit),e.primaryImage&&t.append("primaryImage",e.primaryImage),e.images?.length&&e.images.forEach(o=>{t.append("images",o)}),await h.post("/api/property",t,{headers:{"Content-Type":"multipart/form-data"}})},updateProperty:async({_id:e,...t})=>{const r=new FormData;return t.shortAddress!==void 0&&r.append("shortAddress",t.shortAddress||""),t.street!==void 0&&r.append("street",t.street),t.unit!==void 0&&r.append("unit",t.unit||""),t.city!==void 0&&r.append("city",t.city),t.state!==void 0&&r.append("state",t.state),t.zipCode!==void 0&&r.append("zipCode",t.zipCode),t.type!==void 0&&r.append("type",t.type),t.status!==void 0&&r.append("status",t.status),t.price!==void 0&&r.append("price",t.price.toString()),t.isManaged!==void 0&&r.append("isManaged",t.isManaged.toString()),t.redirectUrl!==void 0&&r.append("redirectUrl",t.redirectUrl||""),t.company!==void 0&&r.append("company",t.company||""),t.kit!==void 0&&r.append("kit",t.kit||""),t.primaryImage&&r.append("primaryImage",t.primaryImage),t.images?.length&&t.images.forEach(a=>{r.append("images",a)}),await h.put(`/api/property/${e}`,r,{headers:{"Content-Type":"multipart/form-data"}})},updatePropertyStatus:async(e,t)=>await h.patch(`/api/property/status/${e}/${t}`,{}),deleteProperty:async e=>{await h.delete(`/api/property/${e}`)},archiveProperty:async e=>await h.post(`/api/property/${e}/archive`),restoreProperty:async e=>await h.post(`/api/property/${e}/restore`),duplicateProperty:async e=>await h.post(`/api/property/${e}/duplicate`),assignProperty:async(e,t)=>await h.post(`/api/property/${e}/assign`,{userId:t}),updateManagement:async(e,t)=>await h.patch(`/api/property/update-management/${e}`,{isManaged:t})},Is=e=>le({queryKey:F.properties.list(e),queryFn:()=>V.getProperties(e)}),Ts=()=>{const e=R();return q({mutationFn:V.deleteProperty,onSuccess:()=>{e.invalidateQueries({queryKey:F.properties.all}),w.success("Property deleted successfully")},onError:t=>{const r=t instanceof _&&t.response?.data?.message||"Failed to delete property";w.error(r)}})},Es=()=>{const e=R();return q({mutationFn:V.archiveProperty,onSuccess:()=>{e.invalidateQueries({queryKey:F.properties.all}),w.success("Property archived successfully")},onError:t=>{const r=t instanceof _&&t.response?.data?.message||"Failed to archive property";w.error(r)}})},ks=()=>{const e=R();return q({mutationFn:V.restoreProperty,onSuccess:()=>{e.invalidateQueries({queryKey:F.properties.all}),w.success("Property restored successfully")},onError:t=>{const r=t instanceof _&&t.response?.data?.message||"Failed to restore property";w.error(r)}})},Ms=()=>{const e=R();return q({mutationFn:V.duplicateProperty,onSuccess:()=>{e.invalidateQueries({queryKey:F.properties.all}),w.success("Property duplicated successfully")},onError:t=>{const r=t instanceof _&&t.response?.data?.message||"Failed to duplicate property";w.error(r)}})},p={ACTIVE:"active",PENDING:"pending",ARCHIVED:"archived",INACTIVE:"inactive"},k={HOUSE:"house",APARTMENT:"apartment",CONDO:"condo",TOWNHOUSE:"townhouse",OTHER:"other"},As=Ee({shortAddress:x().optional(),street:x().min(1,"Street is required"),unit:x().optional(),city:x().min(1,"City is required"),state:x().min(1,"State is required"),zipCode:x().min(5,"Valid zip code is required"),type:X([k.HOUSE,k.APARTMENT,k.CONDO,k.TOWNHOUSE,k.OTHER]),status:X([p.ACTIVE,p.PENDING,p.ARCHIVED,p.INACTIVE]).default(p.PENDING),price:Ae().optional(),isManaged:Me().default(!1),redirectUrl:x().url("Invalid URL").optional().or(Fe("")),company:x().optional(),kit:x().optional(),primaryImage:Z(File).optional(),images:ke(Z(File)).optional()});As.partial().extend({_id:x()});const ae=e=>{if(e.shortAddress)return e.shortAddress;const t=[];e.street&&t.push(e.street),e.unit&&t.push(`Unit ${e.unit}`);const r=[];return e.city&&r.push(e.city),e.state&&r.push(e.state),e.zipCode&&r.push(e.zipCode),r.length>0&&t.push(r.join(", ")),t.join(", ")},Fs=e=>{switch(e){case p.ACTIVE:return"text-green-600 bg-green-50";case p.PENDING:return"text-yellow-600 bg-yellow-50";case p.ARCHIVED:return"text-gray-600 bg-gray-50";case p.INACTIVE:return"text-red-600 bg-red-50";default:return"text-gray-400 bg-gray-50"}},ne=e=>{switch(e){case p.ACTIVE:return"Active";case p.PENDING:return"Pending";case p.ARCHIVED:return"Archived";case p.INACTIVE:return"Inactive";default:return"Unknown"}};function Vs({open:e,onOpenChange:t,property:r}){const o=Ts(),a=async()=>{try{await o.mutateAsync(r._id),t(!1)}catch{}},n=ae(r);return s.jsx(Ne,{open:e,onOpenChange:t,children:s.jsxs(ve,{children:[s.jsxs(Pe,{children:[s.jsx(De,{children:"Are you sure?"}),s.jsxs(Se,{children:["This will permanently delete the property at"," ",s.jsx("span",{className:"font-semibold",children:n}),". This action cannot be undone."]})]}),s.jsxs(be,{children:[s.jsx(Ie,{children:"Cancel"}),s.jsx(Te,{onClick:a,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})}function Os({open:e,onOpenChange:t,property:r}){return s.jsx($,{open:e,onOpenChange:t,children:s.jsxs(L,{className:"max-w-2xl",children:[s.jsx(B,{children:s.jsx(G,{children:"Edit Property"})}),s.jsx("div",{className:"py-4",children:s.jsxs("p",{className:"text-muted-foreground",children:["Edit property form for ",r._id," will be implemented here."]})})]})})}function Rs({open:e,onOpenChange:t,property:r}){return s.jsx($,{open:e,onOpenChange:t,children:s.jsxs(L,{className:"max-w-2xl",children:[s.jsx(B,{children:s.jsx(G,{children:"Property Details"})}),s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsxs("p",{className:"text-muted-foreground",children:["Property details for ",r._id," will be implemented here."]})})]})})}function _s(){const{isCreateDialogOpen:e,setIsCreateDialogOpen:t,isEditDialogOpen:r,setIsEditDialogOpen:o,editingProperty:a,isViewDialogOpen:n,setIsViewDialogOpen:u,viewingProperty:m,isDeleteDialogOpen:y,setIsDeleteDialogOpen:l,deletingProperty:g}=Q();return s.jsxs(s.Fragment,{children:[s.jsx(bs,{open:e,onOpenChange:t}),a&&s.jsx(Os,{open:r,onOpenChange:o,property:a}),m&&s.jsx(Rs,{open:n,onOpenChange:u,property:m}),g&&s.jsx(Vs,{open:y,onOpenChange:l,property:g})]})}function Us(){const{setIsCreateDialogOpen:e}=Q();return s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(U,{onClick:()=>e(!0),children:[s.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Add Property"]})})}function qs({row:e}){const t=e.original,{setEditingProperty:r,setIsEditDialogOpen:o,setViewingProperty:a,setIsViewDialogOpen:n,setDeletingProperty:u,setIsDeleteDialogOpen:m}=Q(),y=Es(),l=ks(),g=Ms(),P=()=>{r(t),o(!0)},f=()=>{a(t),n(!0)},S=()=>{u(t),m(!0)},b=()=>{y.mutate(t._id)},j=()=>{l.mutate(t._id)},I=()=>{g.mutate(t._id)},T=()=>{t.redirectUrl&&window.open(t.redirectUrl,"_blank")},H=t.status===p.ARCHIVED;return s.jsxs(Ze,{children:[s.jsx(Xe,{asChild:!0,children:s.jsxs(U,{variant:"ghost",className:"data-[state=open]:bg-muted h-8 w-8 p-0",children:[s.jsx("span",{className:"sr-only",children:"Open menu"}),s.jsx(es,{className:"h-4 w-4"})]})}),s.jsxs(Je,{align:"end",className:"w-[160px]",children:[s.jsxs(v,{onClick:f,children:[s.jsx(ts,{className:"mr-2 h-4 w-4"}),"View Details"]}),s.jsxs(v,{onClick:P,children:[s.jsx(ss,{className:"mr-2 h-4 w-4"}),"Edit"]}),s.jsxs(v,{onClick:I,children:[s.jsx(ws,{className:"mr-2 h-4 w-4"}),"Duplicate"]}),t.redirectUrl&&s.jsxs(s.Fragment,{children:[s.jsx(se,{}),s.jsxs(v,{onClick:T,children:[s.jsx(te,{className:"mr-2 h-4 w-4"}),"Open URL"]})]}),s.jsx(se,{}),H?s.jsxs(v,{onClick:j,children:[s.jsx(Ss,{className:"mr-2 h-4 w-4"}),"Restore"]}):s.jsxs(v,{onClick:b,children:[s.jsx(ys,{className:"mr-2 h-4 w-4"}),"Archive"]}),s.jsxs(v,{onClick:S,className:"text-destructive",children:[s.jsx(rs,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})}const K=[{id:"select",header:({table:e})=>s.jsx(ee,{checked:e.getIsAllPageRowsSelected()||e.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:t=>e.toggleAllPageRowsSelected(!!t),"aria-label":"Select all",className:"translate-y-[2px]"}),meta:{className:M("sticky md:table-cell left-0 z-10 rounded-tl","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted")},cell:({row:e})=>s.jsx(ee,{checked:e.getIsSelected(),onCheckedChange:t=>e.toggleSelected(!!t),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"isManaged",header:({column:e})=>s.jsx(C,{column:e,title:"Managed"}),cell:({row:e})=>{const t=e.getValue("isManaged");return s.jsx("div",{className:"flex items-center justify-center",children:t?s.jsx(as,{className:"h-4 w-4 text-green-600"}):s.jsx(ge,{className:"text-muted-foreground/50 h-4 w-4"})})}},{id:"details",header:({column:e})=>s.jsx(C,{column:e,title:"Details"}),cell:({row:e})=>{const t=e.original,r=ae(t);return s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0",children:t.primaryImage?s.jsx("img",{src:t.primaryImage,alt:r,className:"h-16 w-16 rounded-md object-cover"}):s.jsx("div",{className:"bg-muted flex h-16 w-16 items-center justify-center rounded-md",children:s.jsx(js,{className:"text-muted-foreground h-6 w-6"})})}),s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsx(We,{className:"max-w-xs font-medium",children:r}),t.propertyType&&s.jsx("span",{className:"text-muted-foreground text-xs capitalize",children:t.propertyType})]})]})},meta:{className:M("drop-shadow-[0_1px_2px_rgb(0_0_0_/_0.1)] dark:drop-shadow-[0_1px_2px_rgb(255_255_255_/_0.1)] lg:drop-shadow-none","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted","sticky left-6 md:table-cell")},enableSorting:!1,enableHiding:!1},{accessorKey:"user.company.name",header:({column:e})=>s.jsx(C,{column:e,title:"Company"}),cell:({row:e})=>{const t=e.original.user?.company;return t?.name?s.jsx(A,{variant:"outline",className:"font-normal",children:t.name}):s.jsx("span",{className:"text-muted-foreground",children:"-"})}},{accessorKey:"redirectUrl",header:({column:e})=>s.jsx(C,{column:e,title:"Redirect URL"}),cell:({row:e})=>{const t=e.getValue("redirectUrl");return t?s.jsxs("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-blue-600 hover:underline",children:[s.jsx(te,{className:"h-3 w-3"}),s.jsx("span",{className:"max-w-[200px] truncate text-sm",children:t})]}):s.jsx("span",{className:"text-muted-foreground",children:"-"})}},{accessorKey:"price",header:({column:e})=>s.jsx(C,{column:e,title:"Price"}),cell:({row:e})=>{const t=e.getValue("price");return t?s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(vs,{className:"text-muted-foreground h-3 w-3"}),s.jsx("span",{className:"font-medium",children:t.toLocaleString()})]}):s.jsx("span",{className:"text-muted-foreground",children:"-"})}},{accessorKey:"leadsCount",header:({column:e})=>s.jsx(C,{column:e,title:"Leads"}),cell:({row:e})=>{const t=e.getValue("leadsCount");return s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(ns,{className:"text-muted-foreground h-3 w-3"}),s.jsx("span",{className:"font-medium",children:t||0})]})}},{accessorKey:"listedDate",header:({column:e})=>s.jsx(C,{column:e,title:"Listed Date"}),cell:({row:e})=>{const t=e.getValue("listedDate");return t?s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(is,{className:"text-muted-foreground h-3 w-3"}),s.jsx("span",{className:"text-sm",children:os(new Date(t),"MMM d, yyyy")})]}):s.jsx("span",{className:"text-muted-foreground",children:"-"})}},{accessorKey:"status",header:({column:e})=>s.jsx(C,{column:e,title:"Status"}),cell:({row:e})=>{const t=e.getValue("status");return s.jsx(A,{className:M("font-normal",Fs(t)),children:ne(t)})}},{id:"actions",cell:({row:e})=>s.jsx(qs,{row:e})},{accessorKey:"propertyType",enableHiding:!0,enableColumnFilter:!0},{accessorKey:"user.company._id",id:"company",enableHiding:!0,enableColumnFilter:!0}];function Hs({column:e,title:t,options:r}){const o=e?.getFacetedUniqueValues(),a=new Set(e?.getFilterValue());return s.jsxs(us,{children:[s.jsx(ms,{asChild:!0,children:s.jsxs(U,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[s.jsx(ls,{className:"mr-2 h-4 w-4"}),t,a?.size>0&&s.jsxs(s.Fragment,{children:[s.jsx(gs,{orientation:"vertical",className:"mx-2 h-4"}),s.jsx(A,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:a.size}),s.jsx("div",{className:"hidden space-x-1 lg:flex",children:a.size>2?s.jsxs(A,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[a.size," selected"]}):r.filter(n=>a.has(n.value)).map(n=>s.jsx(A,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:n.label},n.value))})]})]})}),s.jsx(hs,{className:"w-[200px] p-0",align:"start",children:s.jsxs(xe,{children:[s.jsx(ye,{placeholder:t}),s.jsxs(fe,{children:[s.jsx(je,{children:"No results found."}),s.jsx(Y,{children:r.map(n=>{const u=a.has(n.value);return s.jsxs(W,{onSelect:()=>{u?a.delete(n.value):a.add(n.value);const m=Array.from(a);e?.setFilterValue(m.length?m:void 0)},children:[s.jsx("div",{className:M("border-primary mr-2 flex h-4 w-4 items-center justify-center rounded-sm border",u?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:s.jsx(cs,{className:M("h-4 w-4")})}),n.icon&&s.jsx(n.icon,{className:"text-muted-foreground mr-2 h-4 w-4"}),s.jsx("span",{children:n.label}),o?.get(n.value)&&s.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:o.get(n.value)})]},n.value)})}),a.size>0&&s.jsxs(s.Fragment,{children:[s.jsx(Ce,{}),s.jsx(Y,{children:s.jsx(W,{onSelect:()=>e?.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}function zs({table:e,onSearchChange:t,searchValue:r=""}){const[o,a]=i.useState(r),n=e.getState().columnFilters.length>0||r,u=Object.entries(p).map(([,l])=>({value:l,label:ne(l)}));i.useEffect(()=>{const l=e.getColumn("status");l&&!l.getFilterValue()&&l.setFilterValue([p.ACTIVE])},[e]);const m=l=>{l.key==="Enter"&&t(o)},y=()=>{e.resetColumnFilters(),a(""),t("")};return s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex flex-1 items-center space-x-2",children:[s.jsxs("div",{className:"relative",children:[s.jsx(we,{className:"text-muted-foreground absolute top-1/2 left-2 h-4 w-4 -translate-y-1/2"}),s.jsx(ps,{placeholder:"Search properties by address...",value:o,onChange:l=>a(l.target.value),onKeyPress:m,className:"h-8 w-[150px] pl-8 lg:w-[250px]"})]}),e.getColumn("status")&&s.jsx(Hs,{column:e.getColumn("status"),title:"Status",options:u}),n&&s.jsxs(U,{variant:"ghost",onClick:y,className:"h-8 px-2 lg:px-3",children:["Reset",s.jsx(ds,{className:"ml-2 h-4 w-4"})]})]}),s.jsx(Ge,{table:e})]})}function Ks({companyId:e}){const[t,r]=i.useState([]),[o,a]=i.useState([]),[n,u]=i.useState({propertyType:!1,company:!1}),[m,y]=i.useState({}),[l,g]=i.useState({pageIndex:0,pageSize:10}),[P,f]=i.useState({page:1,limit:10,companiesIds:e?[e]:void 0}),[S,b]=i.useState(1),{data:j,isLoading:I}=Is(P),T=j?.properties||[],H=j?.totalPages||S;i.useEffect(()=>{j?.totalPages&&b(j.totalPages)},[j?.totalPages]),i.useEffect(()=>{f(d=>({...d,page:l.pageIndex+1,limit:l.pageSize}))},[l]),i.useEffect(()=>{if(t.length>0){const d=t[0];f(c=>({...c,sortBy:d.id,sortOrder:d.desc?"desc":"asc"}))}else f(d=>({...d,sortBy:void 0,sortOrder:void 0}))},[t]),i.useEffect(()=>{const d=o.find(N=>N.id==="status"),c=o.find(N=>N.id==="propertyType");f(N=>({...N,status:d?.value||void 0,type:c?.value||void 0,companiesIds:e?[e]:void 0,page:1})),g(N=>({...N,pageIndex:0}))},[o,e]);const E=Oe({data:T,columns:K,pageCount:H,state:{sorting:t,columnFilters:o,columnVisibility:n,rowSelection:m,pagination:l},onSortingChange:r,onColumnFiltersChange:a,onColumnVisibilityChange:u,onRowSelectionChange:y,onPaginationChange:g,getCoreRowModel:ze(),getFilteredRowModel:He(),getPaginationRowModel:qe(),getSortedRowModel:Ue(),getFacetedRowModel:_e(),getFacetedUniqueValues:Re(),manualPagination:!0,manualSorting:!0,manualFiltering:!0}),ie=d=>{f(c=>({...c,search:d,page:1})),g(c=>({...c,pageIndex:0}))};return s.jsxs("div",{className:"space-y-4",children:[s.jsx(zs,{table:E,onSearchChange:ie,searchValue:P.search}),s.jsx("div",{className:"rounded-md border",children:s.jsxs(Ke,{children:[s.jsx($e,{children:E.getHeaderGroups().map(d=>s.jsx(O,{children:d.headers.map(c=>s.jsx(Le,{className:c.column.columnDef.meta?.className,children:c.isPlaceholder?null:J(c.column.columnDef.header,c.getContext())},c.id))},d.id))}),s.jsx(Be,{children:I?Array.from({length:5}).map((d,c)=>s.jsx(O,{children:s.jsx(z,{colSpan:K.length,children:s.jsx(Qe,{className:"h-12 w-full"})})},c)):E.getRowModel().rows?.length?E.getRowModel().rows.map(d=>s.jsx(O,{"data-state":d.getIsSelected()&&"selected",className:"group/row",children:d.getVisibleCells().map(c=>s.jsx(z,{className:c.column.columnDef.meta?.className,children:J(c.column.columnDef.cell,c.getContext())},c.id))},d.id)):s.jsx(O,{children:s.jsx(z,{colSpan:K.length,className:"h-24 text-center",children:"No results."})})})]})}),s.jsx(Ye,{table:E})]})}function $s({children:e}){const[t,r]=i.useState(!1),[o,a]=i.useState(!1),[n,u]=i.useState(null),[m,y]=i.useState(!1),[l,g]=i.useState(null),[P,f]=i.useState(!1),[S,b]=i.useState(null),[j,I]=i.useState([]),T={isCreateDialogOpen:t,setIsCreateDialogOpen:r,isEditDialogOpen:o,setIsEditDialogOpen:a,editingProperty:n,setEditingProperty:u,isViewDialogOpen:m,setIsViewDialogOpen:y,viewingProperty:l,setViewingProperty:g,isDeleteDialogOpen:P,setIsDeleteDialogOpen:f,deletingProperty:S,setDeletingProperty:b,selectedProperties:j,setSelectedProperties:I};return s.jsx(re.Provider,{value:T,children:e})}function Ls(){const e=oe({strict:!1});return s.jsxs($s,{children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Properties"}),s.jsx("p",{className:"text-muted-foreground",children:"Manage your property listings and details."})]}),s.jsx(Us,{})]}),s.jsx(Ks,{companyId:e.company})]}),s.jsx(_s,{})]})}const St=function(){return s.jsxs(s.Fragment,{children:[s.jsxs(ce,{fixed:!0,children:[s.jsx(de,{}),s.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[s.jsx(pe,{}),s.jsx(ue,{}),s.jsx(me,{})]})]}),s.jsx(he,{children:s.jsx(Ls,{})})]})};export{St as component};
