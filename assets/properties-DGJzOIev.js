import{c as P,r as i,j as s,k as R,A as _,t as w,B as q,d as M,a as oe}from"./index-CvyRkeE5.js";import{u as le,b as H,q as F,c as h,H as ce,S as de,a as pe,T as ue,P as me,M as he}from"./header-company-dropdown-CQYbnI8v.js";import{u as ge,g as xe,a as ye,b as fe,c as je,d as Ce,e as we,T as Ne,f as ve,h as O,i as Pe,j as Y,k as De,l as z}from"./table-CtXYL8Fg.js";import{D as C,a as Se,S as be,b as Ie}from"./data-table-column-header-DAw5f9Xg.js";import{C as W}from"./checkbox-DQAukn5y.js";import{B as A}from"./badge-Ce5hJyxp.js";import{L as ke}from"./long-text-B2UXBo_g.js";import{o as Te,a as Ee,i as Z,s as x,b as Me,c as Ae,e as X,l as Fe}from"./types-Wky072k2.js";import{D as Ve,e as Oe,f as Re,i as v,h as J}from"./avatar-_2VmutPB.js";import{E as _e,P as qe}from"./pencil-CAZF0lsn.js";import{E as He}from"./eye-xnJlvzOX.js";import{T as Ue}from"./trash-2-DYCyaPxF.js";import{C as ze}from"./check-DOj7a-5i.js";import{X as $e,C as Ke,a as Le,b as Be,c as Ge,d as ee,e as se,f as Qe,S as Ye,D as K,g as L,h as B,i as G}from"./command-DTdQs4HX.js";import{C as We}from"./calendar-CN8C_RNY.js";import{f as Ze}from"./format-BvUxDbfm.js";import{P as Xe,C as Je,a as es}from"./react-icons.esm-hx67oMTw.js";import{I as ss}from"./input-5vX5qBNK.js";import{P as ts,a as rs,b as as}from"./popover-NdNb9ebW.js";import{S as ns}from"./separator-D1ovcUFg.js";import{A as is,a as os,b as ls,c as cs,d as ds,e as ps,f as us,g as ms}from"./alert-dialog-DBJIasGu.js";import{P as hs}from"./plus-CTHQPs9u.js";import"./createReactComponent-DcxUhOxs.js";import"./select-yRulkKwZ.js";import"./index-Bb0YeX9p.js";import"./index-DCzpbC7R.js";import"./index-bd6ufVwP.js";import"./index-Bt6K678h.js";import"./index-fHPixuyN.js";import"./index-Qfb_IjkA.js";import"./index-BYO_HMiJ.js";import"./index-ChHWVpPk.js";import"./index-rpDruwTI.js";/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],xs=P("archive",gs);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],fs=P("building-2",ys);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Cs=P("copy",js);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ns=P("dollar-sign",ws);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],te=P("link",vs);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Ds=P("rotate-cw",Ps);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],bs=P("users",Ss),re=i.createContext(void 0);function Is({children:e}){const[t,r]=i.useState(!1),[o,a]=i.useState(!1),[n,u]=i.useState(null),[m,y]=i.useState(!1),[l,g]=i.useState(null),[D,f]=i.useState(!1),[S,b]=i.useState(null),[j,I]=i.useState([]),k={isCreateDialogOpen:t,setIsCreateDialogOpen:r,isEditDialogOpen:o,setIsEditDialogOpen:a,editingProperty:n,setEditingProperty:u,isViewDialogOpen:m,setIsViewDialogOpen:y,viewingProperty:l,setViewingProperty:g,isDeleteDialogOpen:D,setIsDeleteDialogOpen:f,deletingProperty:S,setDeletingProperty:b,selectedProperties:j,setSelectedProperties:I};return s.jsx(re.Provider,{value:k,children:e})}const p={ACTIVE:"active",PENDING:"pending",ARCHIVED:"archived",INACTIVE:"inactive"},E={HOUSE:"house",APARTMENT:"apartment",CONDO:"condo",TOWNHOUSE:"townhouse",OTHER:"other"},ks=Te({shortAddress:x().optional(),street:x().min(1,"Street is required"),unit:x().optional(),city:x().min(1,"City is required"),state:x().min(1,"State is required"),zipCode:x().min(5,"Valid zip code is required"),type:X([E.HOUSE,E.APARTMENT,E.CONDO,E.TOWNHOUSE,E.OTHER]),status:X([p.ACTIVE,p.PENDING,p.ARCHIVED,p.INACTIVE]).default(p.PENDING),price:Ae().optional(),isManaged:Me().default(!1),redirectUrl:x().url("Invalid URL").optional().or(Fe("")),company:x().optional(),kit:x().optional(),primaryImage:Z(File).optional(),images:Ee(Z(File)).optional()});ks.partial().extend({_id:x()});const ae=e=>{if(e.shortAddress)return e.shortAddress;const t=[];e.street&&t.push(e.street),e.unit&&t.push(`Unit ${e.unit}`);const r=[];return e.city&&r.push(e.city),e.state&&r.push(e.state),e.zipCode&&r.push(e.zipCode),r.length>0&&t.push(r.join(", ")),t.join(", ")},Ts=e=>{switch(e){case p.ACTIVE:return"text-green-600 bg-green-50";case p.PENDING:return"text-yellow-600 bg-yellow-50";case p.ARCHIVED:return"text-gray-600 bg-gray-50";case p.INACTIVE:return"text-red-600 bg-red-50";default:return"text-gray-400 bg-gray-50"}},ne=e=>{switch(e){case p.ACTIVE:return"Active";case p.PENDING:return"Pending";case p.ARCHIVED:return"Archived";case p.INACTIVE:return"Inactive";default:return"Unknown"}},Q=()=>{const e=i.useContext(re);if(!e)throw new Error("usePropertiesContext must be used within a PropertiesProvider");return e},V={getProperties:async e=>{const t={page:e?.page?e.page-1:0,limit:e?.limit||10,filters:{},sort:{},select:[]};return e?.search&&(t.filters.search=e.search),e?.status&&e.status.length>0&&(t.filters.status=e.status),e?.type&&e.type.length>0&&(t.filters.propertyType=e.type),e?.companiesIds&&e.companiesIds.length>0&&(t.filters.companies=e.companiesIds),e?.classification&&e.classification.length>0&&(t.filters.classification=e.classification),e?.sortBy&&(t.sort[e.sortBy]=e.sortOrder==="desc"?-1:1),await h.post("/api/property/admin/search",t)},getProperty:async e=>await h.get(`/api/property/${e}`),createProperty:async e=>{const t=new FormData;return e.shortAddress&&t.append("shortAddress",e.shortAddress),e.street&&t.append("street",e.street),e.unit&&t.append("unit",e.unit),e.city&&t.append("city",e.city),e.state&&t.append("state",e.state),e.zipCode&&t.append("zipCode",e.zipCode),t.append("type",e.type),t.append("status",e.status),e.price&&t.append("price",e.price.toString()),t.append("isManaged",e.isManaged.toString()),e.redirectUrl&&t.append("redirectUrl",e.redirectUrl),e.company&&t.append("company",e.company),e.kit&&t.append("kit",e.kit),e.primaryImage&&t.append("primaryImage",e.primaryImage),e.images?.length&&e.images.forEach(o=>{t.append("images",o)}),await h.post("/api/property",t,{headers:{"Content-Type":"multipart/form-data"}})},updateProperty:async({_id:e,...t})=>{const r=new FormData;return t.shortAddress!==void 0&&r.append("shortAddress",t.shortAddress||""),t.street!==void 0&&r.append("street",t.street),t.unit!==void 0&&r.append("unit",t.unit||""),t.city!==void 0&&r.append("city",t.city),t.state!==void 0&&r.append("state",t.state),t.zipCode!==void 0&&r.append("zipCode",t.zipCode),t.type!==void 0&&r.append("type",t.type),t.status!==void 0&&r.append("status",t.status),t.price!==void 0&&r.append("price",t.price.toString()),t.isManaged!==void 0&&r.append("isManaged",t.isManaged.toString()),t.redirectUrl!==void 0&&r.append("redirectUrl",t.redirectUrl||""),t.company!==void 0&&r.append("company",t.company||""),t.kit!==void 0&&r.append("kit",t.kit||""),t.primaryImage&&r.append("primaryImage",t.primaryImage),t.images?.length&&t.images.forEach(a=>{r.append("images",a)}),await h.put(`/api/property/${e}`,r,{headers:{"Content-Type":"multipart/form-data"}})},updatePropertyStatus:async(e,t)=>await h.patch(`/api/property/status/${e}/${t}`,{}),deleteProperty:async e=>{await h.delete(`/api/property/${e}`)},archiveProperty:async e=>await h.post(`/api/property/${e}/archive`),restoreProperty:async e=>await h.post(`/api/property/${e}/restore`),duplicateProperty:async e=>await h.post(`/api/property/${e}/duplicate`),assignProperty:async(e,t)=>await h.post(`/api/property/${e}/assign`,{userId:t}),updateManagement:async(e,t)=>await h.patch(`/api/property/update-management/${e}`,{isManaged:t})},Es=e=>le({queryKey:F.properties.list(e),queryFn:()=>V.getProperties(e)}),Ms=()=>{const e=R();return H({mutationFn:V.deleteProperty,onSuccess:()=>{e.invalidateQueries({queryKey:F.properties.all}),w.success("Property deleted successfully")},onError:t=>{const r=t instanceof _&&t.response?.data?.message||"Failed to delete property";w.error(r)}})},As=()=>{const e=R();return H({mutationFn:V.archiveProperty,onSuccess:()=>{e.invalidateQueries({queryKey:F.properties.all}),w.success("Property archived successfully")},onError:t=>{const r=t instanceof _&&t.response?.data?.message||"Failed to archive property";w.error(r)}})},Fs=()=>{const e=R();return H({mutationFn:V.restoreProperty,onSuccess:()=>{e.invalidateQueries({queryKey:F.properties.all}),w.success("Property restored successfully")},onError:t=>{const r=t instanceof _&&t.response?.data?.message||"Failed to restore property";w.error(r)}})},Vs=()=>{const e=R();return H({mutationFn:V.duplicateProperty,onSuccess:()=>{e.invalidateQueries({queryKey:F.properties.all}),w.success("Property duplicated successfully")},onError:t=>{const r=t instanceof _&&t.response?.data?.message||"Failed to duplicate property";w.error(r)}})};function Os({row:e}){const t=e.original,{setEditingProperty:r,setIsEditDialogOpen:o,setViewingProperty:a,setIsViewDialogOpen:n,setDeletingProperty:u,setIsDeleteDialogOpen:m}=Q(),y=As(),l=Fs(),g=Vs(),D=()=>{r(t),o(!0)},f=()=>{a(t),n(!0)},S=()=>{u(t),m(!0)},b=()=>{y.mutate(t._id)},j=()=>{l.mutate(t._id)},I=()=>{g.mutate(t._id)},k=()=>{t.redirectUrl&&window.open(t.redirectUrl,"_blank")},U=t.status===p.ARCHIVED;return s.jsxs(Ve,{children:[s.jsx(Oe,{asChild:!0,children:s.jsxs(q,{variant:"ghost",className:"h-8 w-8 p-0 data-[state=open]:bg-muted",children:[s.jsx("span",{className:"sr-only",children:"Open menu"}),s.jsx(_e,{className:"h-4 w-4"})]})}),s.jsxs(Re,{align:"end",className:"w-[160px]",children:[s.jsxs(v,{onClick:f,children:[s.jsx(He,{className:"mr-2 h-4 w-4"}),"View Details"]}),s.jsxs(v,{onClick:D,children:[s.jsx(qe,{className:"mr-2 h-4 w-4"}),"Edit"]}),s.jsxs(v,{onClick:I,children:[s.jsx(Cs,{className:"mr-2 h-4 w-4"}),"Duplicate"]}),t.redirectUrl&&s.jsxs(s.Fragment,{children:[s.jsx(J,{}),s.jsxs(v,{onClick:k,children:[s.jsx(te,{className:"mr-2 h-4 w-4"}),"Open URL"]})]}),s.jsx(J,{}),U?s.jsxs(v,{onClick:j,children:[s.jsx(Ds,{className:"mr-2 h-4 w-4"}),"Restore"]}):s.jsxs(v,{onClick:b,children:[s.jsx(xs,{className:"mr-2 h-4 w-4"}),"Archive"]}),s.jsxs(v,{onClick:S,className:"text-destructive",children:[s.jsx(Ue,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})}const $=[{id:"select",header:({table:e})=>s.jsx(W,{checked:e.getIsAllPageRowsSelected()||e.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:t=>e.toggleAllPageRowsSelected(!!t),"aria-label":"Select all",className:"translate-y-[2px]"}),meta:{className:M("sticky md:table-cell left-0 z-10 rounded-tl","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted")},cell:({row:e})=>s.jsx(W,{checked:e.getIsSelected(),onCheckedChange:t=>e.toggleSelected(!!t),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"isManaged",header:({column:e})=>s.jsx(C,{column:e,title:"Managed"}),cell:({row:e})=>{const t=e.getValue("isManaged");return s.jsx("div",{className:"flex items-center justify-center",children:t?s.jsx(ze,{className:"h-4 w-4 text-green-600"}):s.jsx($e,{className:"h-4 w-4 text-muted-foreground/50"})})}},{id:"details",header:({column:e})=>s.jsx(C,{column:e,title:"Details"}),cell:({row:e})=>{const t=e.original,r=ae(t);return s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0",children:t.primaryImage?s.jsx("img",{src:t.primaryImage,alt:r,className:"h-16 w-16 rounded-md object-cover"}):s.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-md bg-muted",children:s.jsx(fs,{className:"h-6 w-6 text-muted-foreground"})})}),s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsx(ke,{className:"max-w-xs font-medium",children:r}),t.propertyType&&s.jsx("span",{className:"text-xs text-muted-foreground capitalize",children:t.propertyType})]})]})},meta:{className:M("drop-shadow-[0_1px_2px_rgb(0_0_0_/_0.1)] dark:drop-shadow-[0_1px_2px_rgb(255_255_255_/_0.1)] lg:drop-shadow-none","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted","sticky left-6 md:table-cell")},enableSorting:!1,enableHiding:!1},{accessorKey:"user.company.name",header:({column:e})=>s.jsx(C,{column:e,title:"Company"}),cell:({row:e})=>{const t=e.original.user?.company;return t?.name?s.jsx(A,{variant:"outline",className:"font-normal",children:t.name}):s.jsx("span",{className:"text-muted-foreground",children:"-"})}},{accessorKey:"redirectUrl",header:({column:e})=>s.jsx(C,{column:e,title:"Redirect URL"}),cell:({row:e})=>{const t=e.getValue("redirectUrl");return t?s.jsxs("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-blue-600 hover:underline",children:[s.jsx(te,{className:"h-3 w-3"}),s.jsx("span",{className:"max-w-[200px] truncate text-sm",children:t})]}):s.jsx("span",{className:"text-muted-foreground",children:"-"})}},{accessorKey:"price",header:({column:e})=>s.jsx(C,{column:e,title:"Price"}),cell:({row:e})=>{const t=e.getValue("price");return t?s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Ns,{className:"h-3 w-3 text-muted-foreground"}),s.jsx("span",{className:"font-medium",children:t.toLocaleString()})]}):s.jsx("span",{className:"text-muted-foreground",children:"-"})}},{accessorKey:"leadsCount",header:({column:e})=>s.jsx(C,{column:e,title:"Leads"}),cell:({row:e})=>{const t=e.getValue("leadsCount");return s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(bs,{className:"h-3 w-3 text-muted-foreground"}),s.jsx("span",{className:"font-medium",children:t||0})]})}},{accessorKey:"listedDate",header:({column:e})=>s.jsx(C,{column:e,title:"Listed Date"}),cell:({row:e})=>{const t=e.getValue("listedDate");return t?s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(We,{className:"h-3 w-3 text-muted-foreground"}),s.jsx("span",{className:"text-sm",children:Ze(new Date(t),"MMM d, yyyy")})]}):s.jsx("span",{className:"text-muted-foreground",children:"-"})}},{accessorKey:"status",header:({column:e})=>s.jsx(C,{column:e,title:"Status"}),cell:({row:e})=>{const t=e.getValue("status");return s.jsx(A,{className:M("font-normal",Ts(t)),children:ne(t)})}},{id:"actions",cell:({row:e})=>s.jsx(Os,{row:e})},{accessorKey:"propertyType",enableHiding:!0,enableColumnFilter:!0},{accessorKey:"user.company._id",id:"company",enableHiding:!0,enableColumnFilter:!0}];function Rs({column:e,title:t,options:r}){const o=e?.getFacetedUniqueValues(),a=new Set(e?.getFilterValue());return s.jsxs(ts,{children:[s.jsx(rs,{asChild:!0,children:s.jsxs(q,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[s.jsx(Xe,{className:"mr-2 h-4 w-4"}),t,a?.size>0&&s.jsxs(s.Fragment,{children:[s.jsx(ns,{orientation:"vertical",className:"mx-2 h-4"}),s.jsx(A,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:a.size}),s.jsx("div",{className:"hidden space-x-1 lg:flex",children:a.size>2?s.jsxs(A,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[a.size," selected"]}):r.filter(n=>a.has(n.value)).map(n=>s.jsx(A,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:n.label},n.value))})]})]})}),s.jsx(as,{className:"w-[200px] p-0",align:"start",children:s.jsxs(Ke,{children:[s.jsx(Le,{placeholder:t}),s.jsxs(Be,{children:[s.jsx(Ge,{children:"No results found."}),s.jsx(ee,{children:r.map(n=>{const u=a.has(n.value);return s.jsxs(se,{onSelect:()=>{u?a.delete(n.value):a.add(n.value);const m=Array.from(a);e?.setFilterValue(m.length?m:void 0)},children:[s.jsx("div",{className:M("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",u?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:s.jsx(Je,{className:M("h-4 w-4")})}),n.icon&&s.jsx(n.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),s.jsx("span",{children:n.label}),o?.get(n.value)&&s.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:o.get(n.value)})]},n.value)})}),a.size>0&&s.jsxs(s.Fragment,{children:[s.jsx(Qe,{}),s.jsx(ee,{children:s.jsx(se,{onSelect:()=>e?.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}function _s({table:e,onSearchChange:t,searchValue:r=""}){const[o,a]=i.useState(r),n=e.getState().columnFilters.length>0||r,u=Object.entries(p).map(([,l])=>({value:l,label:ne(l)}));i.useEffect(()=>{const l=e.getColumn("status");l&&!l.getFilterValue()&&l.setFilterValue([p.ACTIVE])},[e]);const m=l=>{l.key==="Enter"&&t(o)},y=()=>{e.resetColumnFilters(),a(""),t("")};return s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex flex-1 items-center space-x-2",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Ye,{className:"absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),s.jsx(ss,{placeholder:"Search properties by address...",value:o,onChange:l=>a(l.target.value),onKeyPress:m,className:"h-8 w-[150px] pl-8 lg:w-[250px]"})]}),e.getColumn("status")&&s.jsx(Rs,{column:e.getColumn("status"),title:"Status",options:u}),n&&s.jsxs(q,{variant:"ghost",onClick:y,className:"h-8 px-2 lg:px-3",children:["Reset",s.jsx(es,{className:"ml-2 h-4 w-4"})]})]}),s.jsx(Se,{table:e})]})}function qs({companyId:e}){const[t,r]=i.useState([]),[o,a]=i.useState([]),[n,u]=i.useState({propertyType:!1,company:!1}),[m,y]=i.useState({}),[l,g]=i.useState({pageIndex:0,pageSize:10}),[D,f]=i.useState({page:1,limit:10,companiesIds:e?[e]:void 0}),[S,b]=i.useState(1),{data:j,isLoading:I}=Es(D),k=j?.properties||[],U=j?.totalPages||S;i.useEffect(()=>{j?.totalPages&&b(j.totalPages)},[j?.totalPages]),i.useEffect(()=>{f(d=>({...d,page:l.pageIndex+1,limit:l.pageSize}))},[l]),i.useEffect(()=>{if(t.length>0){const d=t[0];f(c=>({...c,sortBy:d.id,sortOrder:d.desc?"desc":"asc"}))}else f(d=>({...d,sortBy:void 0,sortOrder:void 0}))},[t]),i.useEffect(()=>{const d=o.find(N=>N.id==="status"),c=o.find(N=>N.id==="propertyType");f(N=>({...N,status:d?.value||void 0,type:c?.value||void 0,companiesIds:e?[e]:void 0,page:1})),g(N=>({...N,pageIndex:0}))},[o,e]);const T=ge({data:k,columns:$,pageCount:U,state:{sorting:t,columnFilters:o,columnVisibility:n,rowSelection:m,pagination:l},onSortingChange:r,onColumnFiltersChange:a,onColumnVisibilityChange:u,onRowSelectionChange:y,onPaginationChange:g,getCoreRowModel:we(),getFilteredRowModel:Ce(),getPaginationRowModel:je(),getSortedRowModel:fe(),getFacetedRowModel:ye(),getFacetedUniqueValues:xe(),manualPagination:!0,manualSorting:!0,manualFiltering:!0}),ie=d=>{f(c=>({...c,search:d,page:1})),g(c=>({...c,pageIndex:0}))};return s.jsxs("div",{className:"space-y-4",children:[s.jsx(_s,{table:T,onSearchChange:ie,searchValue:D.search}),s.jsx("div",{className:"rounded-md border",children:s.jsxs(Ne,{children:[s.jsx(ve,{children:T.getHeaderGroups().map(d=>s.jsx(O,{children:d.headers.map(c=>s.jsx(Pe,{className:c.column.columnDef.meta?.className,children:c.isPlaceholder?null:Y(c.column.columnDef.header,c.getContext())},c.id))},d.id))}),s.jsx(De,{children:I?Array.from({length:5}).map((d,c)=>s.jsx(O,{children:s.jsx(z,{colSpan:$.length,children:s.jsx(be,{className:"h-12 w-full"})})},c)):T.getRowModel().rows?.length?T.getRowModel().rows.map(d=>s.jsx(O,{"data-state":d.getIsSelected()&&"selected",className:"group/row",children:d.getVisibleCells().map(c=>s.jsx(z,{className:c.column.columnDef.meta?.className,children:Y(c.column.columnDef.cell,c.getContext())},c.id))},d.id)):s.jsx(O,{children:s.jsx(z,{colSpan:$.length,className:"h-24 text-center",children:"No results."})})})]})}),s.jsx(Ie,{table:T})]})}function Hs({open:e,onOpenChange:t}){return s.jsx(K,{open:e,onOpenChange:t,children:s.jsxs(L,{className:"max-w-2xl",children:[s.jsx(B,{children:s.jsx(G,{children:"Create Property"})}),s.jsx("div",{className:"py-4",children:s.jsx("p",{className:"text-muted-foreground",children:"Create property form will be implemented here."})})]})})}function Us({open:e,onOpenChange:t,property:r}){return s.jsx(K,{open:e,onOpenChange:t,children:s.jsxs(L,{className:"max-w-2xl",children:[s.jsx(B,{children:s.jsx(G,{children:"Edit Property"})}),s.jsx("div",{className:"py-4",children:s.jsxs("p",{className:"text-muted-foreground",children:["Edit property form for ",r._id," will be implemented here."]})})]})})}function zs({open:e,onOpenChange:t,property:r}){return s.jsx(K,{open:e,onOpenChange:t,children:s.jsxs(L,{className:"max-w-2xl",children:[s.jsx(B,{children:s.jsx(G,{children:"Property Details"})}),s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsxs("p",{className:"text-muted-foreground",children:["Property details for ",r._id," will be implemented here."]})})]})})}function $s({open:e,onOpenChange:t,property:r}){const o=Ms(),a=async()=>{try{await o.mutateAsync(r._id),t(!1)}catch{}},n=ae(r);return s.jsx(is,{open:e,onOpenChange:t,children:s.jsxs(os,{children:[s.jsxs(ls,{children:[s.jsx(cs,{children:"Are you sure?"}),s.jsxs(ds,{children:["This will permanently delete the property at"," ",s.jsx("span",{className:"font-semibold",children:n}),". This action cannot be undone."]})]}),s.jsxs(ps,{children:[s.jsx(us,{children:"Cancel"}),s.jsx(ms,{onClick:a,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})}function Ks(){const{isCreateDialogOpen:e,setIsCreateDialogOpen:t,isEditDialogOpen:r,setIsEditDialogOpen:o,editingProperty:a,isViewDialogOpen:n,setIsViewDialogOpen:u,viewingProperty:m,isDeleteDialogOpen:y,setIsDeleteDialogOpen:l,deletingProperty:g}=Q();return s.jsxs(s.Fragment,{children:[s.jsx(Hs,{open:e,onOpenChange:t}),a&&s.jsx(Us,{open:r,onOpenChange:o,property:a}),m&&s.jsx(zs,{open:n,onOpenChange:u,property:m}),g&&s.jsx($s,{open:y,onOpenChange:l,property:g})]})}function Ls(){const{setIsCreateDialogOpen:e}=Q();return s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(q,{onClick:()=>e(!0),children:[s.jsx(hs,{className:"mr-2 h-4 w-4"}),"Add Property"]})})}function Bs(){const e=oe({strict:!1});return s.jsxs(Is,{children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Properties"}),s.jsx("p",{className:"text-muted-foreground",children:"Manage your property listings and details."})]}),s.jsx(Ls,{})]}),s.jsx(qs,{companyId:e.company})]}),s.jsx(Ks,{})]})}const St=function(){return s.jsxs(s.Fragment,{children:[s.jsxs(ce,{fixed:!0,children:[s.jsx(de,{}),s.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[s.jsx(pe,{}),s.jsx(ue,{}),s.jsx(me,{})]})]}),s.jsx(he,{children:s.jsx(Bs,{})})]})};export{St as component};
