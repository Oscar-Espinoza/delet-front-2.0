import{c as P,r as o,j as e,k as O,A as _,t as v,B as U,d as A,a as ue}from"./index-Dv1JWxNr.js";import{u as he,b as q,q as F,c as h,H as xe,S as ge,a as ye,T as je,P as fe,M as Ne}from"./header-company-dropdown--Awgxzay.js";import{u as ve,g as we,a as Ce,b as Pe,c as De,d as Se,e as be,T as Ie,f as Me,h as V,i as ke,j as ee,k as Te,l as z}from"./table-CR31dl_A.js";import{D as N,a as Ee,S as Ae,b as Fe}from"./data-table-column-header-BQ28lyg8.js";import{C as se}from"./checkbox-9cVOoBuM.js";import{B as S}from"./badge-KVwFvJ3A.js";import{L as Re}from"./long-text-29-VbLTc.js";import{o as Ve,a as Oe,i as te,s as g,b as _e,c as Ue,e as ae,l as qe}from"./types-Wky072k2.js";import{D as He,e as ze,f as Le,i as C,h as re}from"./avatar-BAwvz_Zl.js";import{E as $e,P as Ke}from"./pencil-BThf48U0.js";import{E as Be}from"./eye-kPwYJfHv.js";import{T as Ge}from"./trash-2-46cHvozB.js";import{C as oe}from"./check-BqR35Gvj.js";import{X as le,C as Qe,a as Ye,b as We,c as Ze,d as ne,e as ie,f as Xe,S as Je,D as B,g as G,h as Q,i as Y}from"./command-DcTOLZl5.js";import{C as $,M as es}from"./map-pin-DlQzezPx.js";import{f as K}from"./format-BvUxDbfm.js";import{P as ss,C as ts,a as as}from"./react-icons.esm-BLmnETz0.js";import{I as rs}from"./input-B_unVzQI.js";import{P as ns,a as is,b as os}from"./popover-UlTbB9Ed.js";import{S as ls}from"./separator-C7xfAAuo.js";import{A as cs,a as ds,b as ms,c as ps,d as us,e as hs,f as xs,g as gs}from"./alert-dialog-7a_uNcYv.js";import{P as ys}from"./plus-DFeVdjI_.js";import"./createReactComponent-DEfHJg2M.js";import"./select-C_Vy9nNB.js";import"./index-BmzB4KP7.js";import"./index-CHnWnazZ.js";import"./index-DF1ouENV.js";import"./index-D-kAnGCt.js";import"./index-CEbF_H-L.js";import"./index-GwslycKq.js";import"./index-Bx3FAcJY.js";import"./index-jslwB8KE.js";import"./index-mCotDcwq.js";/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],fs=P("archive",js);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],vs=P("building-2",Ns);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Cs=P("copy",ws);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],ce=P("dollar-sign",Ps);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],W=P("link",Ds);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],bs=P("rotate-cw",Ss);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],de=P("users",Is),me=o.createContext(void 0);function Ms({children:s}){const[t,a]=o.useState(!1),[i,n]=o.useState(!1),[r,p]=o.useState(null),[u,y]=o.useState(!1),[l,x]=o.useState(null),[D,j]=o.useState(!1),[b,I]=o.useState(null),[f,M]=o.useState([]),k={isCreateDialogOpen:t,setIsCreateDialogOpen:a,isEditDialogOpen:i,setIsEditDialogOpen:n,editingProperty:r,setEditingProperty:p,isViewDialogOpen:u,setIsViewDialogOpen:y,viewingProperty:l,setViewingProperty:x,isDeleteDialogOpen:D,setIsDeleteDialogOpen:j,deletingProperty:b,setDeletingProperty:I,selectedProperties:f,setSelectedProperties:M};return e.jsx(me.Provider,{value:k,children:s})}const m={ACTIVE:"active",PENDING:"pending",ARCHIVED:"archived",INACTIVE:"inactive"},E={HOUSE:"house",APARTMENT:"apartment",CONDO:"condo",TOWNHOUSE:"townhouse",OTHER:"other"},ks=Ve({shortAddress:g().optional(),street:g().min(1,"Street is required"),unit:g().optional(),city:g().min(1,"City is required"),state:g().min(1,"State is required"),zipCode:g().min(5,"Valid zip code is required"),type:ae([E.HOUSE,E.APARTMENT,E.CONDO,E.TOWNHOUSE,E.OTHER]),status:ae([m.ACTIVE,m.PENDING,m.ARCHIVED,m.INACTIVE]).default(m.PENDING),price:Ue().optional(),isManaged:_e().default(!1),redirectUrl:g().url("Invalid URL").optional().or(qe("")),company:g().optional(),kit:g().optional(),primaryImage:te(File).optional(),images:Oe(te(File)).optional()});ks.partial().extend({_id:g()});const Z=s=>{if(s.shortAddress)return s.shortAddress;const t=[];s.street&&t.push(s.street),s.unit&&t.push(`Unit ${s.unit}`);const a=[];return s.city&&a.push(s.city),s.state&&a.push(s.state),s.zipCode&&a.push(s.zipCode),a.length>0&&t.push(a.join(", ")),t.join(", ")},Ts=s=>{switch(s){case m.ACTIVE:return"text-green-600 bg-green-50";case m.PENDING:return"text-yellow-600 bg-yellow-50";case m.ARCHIVED:return"text-gray-600 bg-gray-50";case m.INACTIVE:return"text-red-600 bg-red-50";default:return"text-gray-400 bg-gray-50"}},X=s=>{switch(s){case m.ACTIVE:return"Active";case m.PENDING:return"Pending";case m.ARCHIVED:return"Archived";case m.INACTIVE:return"Inactive";default:return"Unknown"}},J=()=>{const s=o.useContext(me);if(!s)throw new Error("usePropertiesContext must be used within a PropertiesProvider");return s},R={getProperties:async s=>{const t={page:s?.page?s.page-1:0,limit:s?.limit||10,filters:{},sort:{},select:[]};return s?.search&&(t.filters.search=s.search),s?.status&&s.status.length>0&&(t.filters.status=s.status),s?.type&&s.type.length>0&&(t.filters.propertyType=s.type),s?.companiesIds&&s.companiesIds.length>0&&(t.filters.companies=s.companiesIds),s?.classification&&s.classification.length>0&&(t.filters.classification=s.classification),s?.sortBy&&(t.sort[s.sortBy]=s.sortOrder==="desc"?-1:1),await h.post("/api/property/admin/search",t)},getProperty:async s=>await h.get(`/api/property/${s}`),createProperty:async s=>{const t=new FormData;return s.shortAddress&&t.append("shortAddress",s.shortAddress),s.street&&t.append("street",s.street),s.unit&&t.append("unit",s.unit),s.city&&t.append("city",s.city),s.state&&t.append("state",s.state),s.zipCode&&t.append("zipCode",s.zipCode),t.append("type",s.type),t.append("status",s.status),s.price&&t.append("price",s.price.toString()),t.append("isManaged",s.isManaged.toString()),s.redirectUrl&&t.append("redirectUrl",s.redirectUrl),s.company&&t.append("company",s.company),s.kit&&t.append("kit",s.kit),s.primaryImage&&t.append("primaryImage",s.primaryImage),s.images?.length&&s.images.forEach(i=>{t.append("images",i)}),await h.post("/api/property",t,{headers:{"Content-Type":"multipart/form-data"}})},updateProperty:async({_id:s,...t})=>{const a=new FormData;return t.shortAddress!==void 0&&a.append("shortAddress",t.shortAddress||""),t.street!==void 0&&a.append("street",t.street),t.unit!==void 0&&a.append("unit",t.unit||""),t.city!==void 0&&a.append("city",t.city),t.state!==void 0&&a.append("state",t.state),t.zipCode!==void 0&&a.append("zipCode",t.zipCode),t.type!==void 0&&a.append("type",t.type),t.status!==void 0&&a.append("status",t.status),t.price!==void 0&&a.append("price",t.price.toString()),t.isManaged!==void 0&&a.append("isManaged",t.isManaged.toString()),t.redirectUrl!==void 0&&a.append("redirectUrl",t.redirectUrl||""),t.company!==void 0&&a.append("company",t.company||""),t.kit!==void 0&&a.append("kit",t.kit||""),t.primaryImage&&a.append("primaryImage",t.primaryImage),t.images?.length&&t.images.forEach(n=>{a.append("images",n)}),await h.put(`/api/property/${s}`,a,{headers:{"Content-Type":"multipart/form-data"}})},updatePropertyStatus:async(s,t)=>await h.patch(`/api/property/status/${s}/${t}`,{}),deleteProperty:async s=>{await h.delete(`/api/property/${s}`)},archiveProperty:async s=>await h.post(`/api/property/${s}/archive`),restoreProperty:async s=>await h.post(`/api/property/${s}/restore`),duplicateProperty:async s=>await h.post(`/api/property/${s}/duplicate`),assignProperty:async(s,t)=>await h.post(`/api/property/${s}/assign`,{userId:t}),updateManagement:async(s,t)=>await h.patch(`/api/property/update-management/${s}`,{isManaged:t})},Es=s=>he({queryKey:F.properties.list(s),queryFn:()=>R.getProperties(s)}),As=()=>{const s=O();return q({mutationFn:R.deleteProperty,onSuccess:()=>{s.invalidateQueries({queryKey:F.properties.all}),v.success("Property deleted successfully")},onError:t=>{const a=t instanceof _&&t.response?.data?.message||"Failed to delete property";v.error(a)}})},Fs=()=>{const s=O();return q({mutationFn:R.archiveProperty,onSuccess:()=>{s.invalidateQueries({queryKey:F.properties.all}),v.success("Property archived successfully")},onError:t=>{const a=t instanceof _&&t.response?.data?.message||"Failed to archive property";v.error(a)}})},Rs=()=>{const s=O();return q({mutationFn:R.restoreProperty,onSuccess:()=>{s.invalidateQueries({queryKey:F.properties.all}),v.success("Property restored successfully")},onError:t=>{const a=t instanceof _&&t.response?.data?.message||"Failed to restore property";v.error(a)}})},Vs=()=>{const s=O();return q({mutationFn:R.duplicateProperty,onSuccess:()=>{s.invalidateQueries({queryKey:F.properties.all}),v.success("Property duplicated successfully")},onError:t=>{const a=t instanceof _&&t.response?.data?.message||"Failed to duplicate property";v.error(a)}})};function Os({row:s}){const t=s.original,{setEditingProperty:a,setIsEditDialogOpen:i,setViewingProperty:n,setIsViewDialogOpen:r,setDeletingProperty:p,setIsDeleteDialogOpen:u}=J(),y=Fs(),l=Rs(),x=Vs(),D=()=>{a(t),i(!0)},j=()=>{n(t),r(!0)},b=()=>{p(t),u(!0)},I=()=>{y.mutate(t._id)},f=()=>{l.mutate(t._id)},M=()=>{x.mutate(t._id)},k=()=>{t.redirectUrl&&window.open(t.redirectUrl,"_blank")},H=t.status===m.ARCHIVED;return e.jsxs(He,{children:[e.jsx(ze,{asChild:!0,children:e.jsxs(U,{variant:"ghost",className:"h-8 w-8 p-0 data-[state=open]:bg-muted",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx($e,{className:"h-4 w-4"})]})}),e.jsxs(Le,{align:"end",className:"w-[160px]",children:[e.jsxs(C,{onClick:j,children:[e.jsx(Be,{className:"mr-2 h-4 w-4"}),"View Details"]}),e.jsxs(C,{onClick:D,children:[e.jsx(Ke,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(C,{onClick:M,children:[e.jsx(Cs,{className:"mr-2 h-4 w-4"}),"Duplicate"]}),t.redirectUrl&&e.jsxs(e.Fragment,{children:[e.jsx(re,{}),e.jsxs(C,{onClick:k,children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"Open URL"]})]}),e.jsx(re,{}),H?e.jsxs(C,{onClick:f,children:[e.jsx(bs,{className:"mr-2 h-4 w-4"}),"Restore"]}):e.jsxs(C,{onClick:I,children:[e.jsx(fs,{className:"mr-2 h-4 w-4"}),"Archive"]}),e.jsxs(C,{onClick:b,className:"text-destructive",children:[e.jsx(Ge,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})}const L=[{id:"select",header:({table:s})=>e.jsx(se,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:t=>s.toggleAllPageRowsSelected(!!t),"aria-label":"Select all",className:"translate-y-[2px]"}),meta:{className:A("sticky md:table-cell left-0 z-10 rounded-tl","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted")},cell:({row:s})=>e.jsx(se,{checked:s.getIsSelected(),onCheckedChange:t=>s.toggleSelected(!!t),"aria-label":"Select row",className:"translate-y-[2px]"}),enableSorting:!1,enableHiding:!1},{accessorKey:"isManaged",header:({column:s})=>e.jsx(N,{column:s,title:"Managed"}),cell:({row:s})=>{const t=s.getValue("isManaged");return e.jsx("div",{className:"flex items-center justify-center",children:t?e.jsx(oe,{className:"h-4 w-4 text-green-600"}):e.jsx(le,{className:"h-4 w-4 text-muted-foreground/50"})})}},{id:"details",header:({column:s})=>e.jsx(N,{column:s,title:"Details"}),cell:({row:s})=>{const t=s.original,a=Z(t);return e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:t.primaryImage?e.jsx("img",{src:t.primaryImage,alt:a,className:"h-16 w-16 rounded-md object-cover"}):e.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-md bg-muted",children:e.jsx(vs,{className:"h-6 w-6 text-muted-foreground"})})}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx(Re,{className:"max-w-xs font-medium",children:a}),t.propertyType&&e.jsx("span",{className:"text-xs text-muted-foreground capitalize",children:t.propertyType})]})]})},meta:{className:A("drop-shadow-[0_1px_2px_rgb(0_0_0_/_0.1)] dark:drop-shadow-[0_1px_2px_rgb(255_255_255_/_0.1)] lg:drop-shadow-none","bg-background transition-colors duration-200 group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted","sticky left-6 md:table-cell")},enableSorting:!1,enableHiding:!1},{accessorKey:"user.company.name",header:({column:s})=>e.jsx(N,{column:s,title:"Company"}),cell:({row:s})=>{const t=s.original.user?.company;return t?.name?e.jsx(S,{variant:"outline",className:"font-normal",children:t.name}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}},{accessorKey:"redirectUrl",header:({column:s})=>e.jsx(N,{column:s,title:"Redirect URL"}),cell:({row:s})=>{const t=s.getValue("redirectUrl");return t?e.jsxs("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-blue-600 hover:underline",children:[e.jsx(W,{className:"h-3 w-3"}),e.jsx("span",{className:"max-w-[200px] truncate text-sm",children:t})]}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}},{accessorKey:"price",header:({column:s})=>e.jsx(N,{column:s,title:"Price"}),cell:({row:s})=>{const t=s.getValue("price");return t?e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ce,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:t.toLocaleString()})]}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}},{accessorKey:"leadsCount",header:({column:s})=>e.jsx(N,{column:s,title:"Leads"}),cell:({row:s})=>{const t=s.getValue("leadsCount");return e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(de,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:t||0})]})}},{accessorKey:"listedDate",header:({column:s})=>e.jsx(N,{column:s,title:"Listed Date"}),cell:({row:s})=>{const t=s.getValue("listedDate");return t?e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx($,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:K(new Date(t),"MMM d, yyyy")})]}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}},{accessorKey:"status",header:({column:s})=>e.jsx(N,{column:s,title:"Status"}),cell:({row:s})=>{const t=s.getValue("status");return e.jsx(S,{className:A("font-normal",Ts(t)),children:X(t)})}},{id:"actions",cell:({row:s})=>e.jsx(Os,{row:s})},{accessorKey:"propertyType",enableHiding:!0,enableColumnFilter:!0},{accessorKey:"user.company._id",id:"company",enableHiding:!0,enableColumnFilter:!0}];function _s({column:s,title:t,options:a}){const i=s?.getFacetedUniqueValues(),n=new Set(s?.getFilterValue());return e.jsxs(ns,{children:[e.jsx(is,{asChild:!0,children:e.jsxs(U,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[e.jsx(ss,{className:"mr-2 h-4 w-4"}),t,n?.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(ls,{orientation:"vertical",className:"mx-2 h-4"}),e.jsx(S,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:n.size}),e.jsx("div",{className:"hidden space-x-1 lg:flex",children:n.size>2?e.jsxs(S,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[n.size," selected"]}):a.filter(r=>n.has(r.value)).map(r=>e.jsx(S,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:r.label},r.value))})]})]})}),e.jsx(os,{className:"w-[200px] p-0",align:"start",children:e.jsxs(Qe,{children:[e.jsx(Ye,{placeholder:t}),e.jsxs(We,{children:[e.jsx(Ze,{children:"No results found."}),e.jsx(ne,{children:a.map(r=>{const p=n.has(r.value);return e.jsxs(ie,{onSelect:()=>{p?n.delete(r.value):n.add(r.value);const u=Array.from(n);s?.setFilterValue(u.length?u:void 0)},children:[e.jsx("div",{className:A("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",p?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:e.jsx(ts,{className:A("h-4 w-4")})}),r.icon&&e.jsx(r.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:r.label}),i?.get(r.value)&&e.jsx("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:i.get(r.value)})]},r.value)})}),n.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(Xe,{}),e.jsx(ne,{children:e.jsx(ie,{onSelect:()=>s?.setFilterValue(void 0),className:"justify-center text-center",children:"Clear filters"})})]})]})]})})]})}function Us({table:s,onSearchChange:t,searchValue:a=""}){const[i,n]=o.useState(a),r=s.getState().columnFilters.length>0||a,p=Object.entries(m).map(([,l])=>({value:l,label:X(l)}));o.useEffect(()=>{const l=s.getColumn("status");l&&!l.getFilterValue()&&l.setFilterValue([m.ACTIVE])},[s]);const u=l=>{l.key==="Enter"&&t(i)},y=()=>{s.resetColumnFilters(),n(""),t("")};return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-1 items-center space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Je,{className:"absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(rs,{placeholder:"Search properties by address...",value:i,onChange:l=>n(l.target.value),onKeyPress:u,className:"h-8 w-[150px] pl-8 lg:w-[250px]"})]}),s.getColumn("status")&&e.jsx(_s,{column:s.getColumn("status"),title:"Status",options:p}),r&&e.jsxs(U,{variant:"ghost",onClick:y,className:"h-8 px-2 lg:px-3",children:["Reset",e.jsx(as,{className:"ml-2 h-4 w-4"})]})]}),e.jsx(Ee,{table:s})]})}function qs({companyId:s}){const[t,a]=o.useState([]),[i,n]=o.useState([]),[r,p]=o.useState({propertyType:!1,company:!1}),[u,y]=o.useState({}),[l,x]=o.useState({pageIndex:0,pageSize:10}),[D,j]=o.useState({page:1,limit:10,companiesIds:s?[s]:void 0}),[b,I]=o.useState(1),{data:f,isLoading:M}=Es(D),k=f?.properties||[],H=f?.totalPages||b;o.useEffect(()=>{f?.totalPages&&I(f.totalPages)},[f?.totalPages]),o.useEffect(()=>{j(d=>({...d,page:l.pageIndex+1,limit:l.pageSize}))},[l]),o.useEffect(()=>{if(t.length>0){const d=t[0];j(c=>({...c,sortBy:d.id,sortOrder:d.desc?"desc":"asc"}))}else j(d=>({...d,sortBy:void 0,sortOrder:void 0}))},[t]),o.useEffect(()=>{const d=i.find(w=>w.id==="status"),c=i.find(w=>w.id==="propertyType");j(w=>({...w,status:d?.value||void 0,type:c?.value||void 0,companiesIds:s?[s]:void 0,page:1})),x(w=>({...w,pageIndex:0}))},[i,s]);const T=ve({data:k,columns:L,pageCount:H,state:{sorting:t,columnFilters:i,columnVisibility:r,rowSelection:u,pagination:l},onSortingChange:a,onColumnFiltersChange:n,onColumnVisibilityChange:p,onRowSelectionChange:y,onPaginationChange:x,getCoreRowModel:be(),getFilteredRowModel:Se(),getPaginationRowModel:De(),getSortedRowModel:Pe(),getFacetedRowModel:Ce(),getFacetedUniqueValues:we(),manualPagination:!0,manualSorting:!0,manualFiltering:!0}),pe=d=>{j(c=>({...c,search:d,page:1})),x(c=>({...c,pageIndex:0}))};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(Us,{table:T,onSearchChange:pe,searchValue:D.search}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(Ie,{children:[e.jsx(Me,{children:T.getHeaderGroups().map(d=>e.jsx(V,{children:d.headers.map(c=>e.jsx(ke,{className:c.column.columnDef.meta?.className,children:c.isPlaceholder?null:ee(c.column.columnDef.header,c.getContext())},c.id))},d.id))}),e.jsx(Te,{children:M?Array.from({length:5}).map((d,c)=>e.jsx(V,{children:e.jsx(z,{colSpan:L.length,children:e.jsx(Ae,{className:"h-12 w-full"})})},c)):T.getRowModel().rows?.length?T.getRowModel().rows.map(d=>e.jsx(V,{"data-state":d.getIsSelected()&&"selected",className:"group/row",children:d.getVisibleCells().map(c=>e.jsx(z,{className:c.column.columnDef.meta?.className,children:ee(c.column.columnDef.cell,c.getContext())},c.id))},d.id)):e.jsx(V,{children:e.jsx(z,{colSpan:L.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx(Fe,{table:T})]})}function Hs({open:s,onOpenChange:t}){return e.jsx(B,{open:s,onOpenChange:t,children:e.jsxs(G,{className:"max-w-2xl",children:[e.jsx(Q,{children:e.jsx(Y,{children:"Create Property"})}),e.jsx("div",{className:"py-4",children:e.jsx("p",{className:"text-muted-foreground",children:"Create property form will be implemented here."})})]})})}function zs({open:s,onOpenChange:t,property:a}){return e.jsx(B,{open:s,onOpenChange:t,children:e.jsxs(G,{className:"max-w-2xl",children:[e.jsx(Q,{children:e.jsx(Y,{children:"Edit Property"})}),e.jsx("div",{className:"py-4",children:e.jsxs("p",{className:"text-muted-foreground",children:["Edit property form for ",a._id," will be implemented here."]})})]})})}function Ls({open:s,onOpenChange:t,property:a}){const i=Z(a);return e.jsx(B,{open:s,onOpenChange:t,children:e.jsxs(G,{className:"max-w-2xl",children:[e.jsx(Q,{children:e.jsx(Y,{children:"Property Details"})}),e.jsxs("div",{className:"space-y-6",children:[(a.primaryImage||a.images?.length)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Images"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.primaryImage&&e.jsx("img",{src:a.primaryImage,alt:"Primary",className:"h-24 w-full rounded-md object-cover"}),a.images?.map((n,r)=>e.jsx("img",{src:n,alt:`Image ${r+1}`,className:"h-24 w-full rounded-md object-cover"},r))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Address"}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(es,{className:"mt-0.5 h-4 w-4 text-muted-foreground"}),e.jsx("p",{className:"text-sm",children:i})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Type"}),e.jsx("p",{className:"text-sm",children:a.propertyType||"-"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Status"}),e.jsx(S,{variant:"outline",children:X(a.status)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Company"}),e.jsx("p",{className:"text-sm",children:a.user?.company?.name||"-"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Managed"}),e.jsx("div",{className:"flex items-center",children:a.isManaged?e.jsx(oe,{className:"h-4 w-4 text-green-600"}):e.jsx(le,{className:"h-4 w-4 text-muted-foreground"})})]})]}),a.price&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Price"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("p",{className:"text-sm font-medium",children:a.price.toLocaleString()})]})]}),a.redirectUrl&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Redirect URL"}),e.jsxs("a",{href:a.redirectUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-2 text-sm text-blue-600 hover:underline",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx("span",{children:a.redirectUrl})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Leads"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(de,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("p",{className:"text-sm",children:a.leadsCount||0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Redirects"}),e.jsx("p",{className:"text-sm",children:a.redirectCount||0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.listedDate&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Listed Date"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("p",{className:"text-sm",children:K(new Date(a.listedDate),"MMM d, yyyy")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Created"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("p",{className:"text-sm",children:K(new Date(a.createdAt),"MMM d, yyyy")})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Owner"}),e.jsxs("p",{className:"text-sm",children:[a.user.firstName," ",a.user.lastName," (",a.user.email,")"]})]}),a.kit&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Assigned Kit"}),e.jsx("p",{className:"text-sm",children:a.kit.name})]})]})]})})}function $s({open:s,onOpenChange:t,property:a}){const i=As(),n=async()=>{try{await i.mutateAsync(a._id),t(!1)}catch{}},r=Z(a);return e.jsx(cs,{open:s,onOpenChange:t,children:e.jsxs(ds,{children:[e.jsxs(ms,{children:[e.jsx(ps,{children:"Are you sure?"}),e.jsxs(us,{children:["This will permanently delete the property at"," ",e.jsx("span",{className:"font-semibold",children:r}),". This action cannot be undone."]})]}),e.jsxs(hs,{children:[e.jsx(xs,{children:"Cancel"}),e.jsx(gs,{onClick:n,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})}function Ks(){const{isCreateDialogOpen:s,setIsCreateDialogOpen:t,isEditDialogOpen:a,setIsEditDialogOpen:i,editingProperty:n,isViewDialogOpen:r,setIsViewDialogOpen:p,viewingProperty:u,isDeleteDialogOpen:y,setIsDeleteDialogOpen:l,deletingProperty:x}=J();return e.jsxs(e.Fragment,{children:[e.jsx(Hs,{open:s,onOpenChange:t}),n&&e.jsx(zs,{open:a,onOpenChange:i,property:n}),u&&e.jsx(Ls,{open:r,onOpenChange:p,property:u}),x&&e.jsx($s,{open:y,onOpenChange:l,property:x})]})}function Bs(){const{setIsCreateDialogOpen:s}=J();return e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(U,{onClick:()=>s(!0),children:[e.jsx(ys,{className:"mr-2 h-4 w-4"}),"Add Property"]})})}function Gs(){const s=ue({strict:!1});return e.jsxs(Ms,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Properties"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your property listings and details."})]}),e.jsx(Bs,{})]}),e.jsx(qs,{companyId:s.company})]}),e.jsx(Ks,{})]})}const bt=function(){return e.jsxs(e.Fragment,{children:[e.jsxs(xe,{fixed:!0,children:[e.jsx(ge,{}),e.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[e.jsx(ye,{}),e.jsx(je,{}),e.jsx(fe,{})]})]}),e.jsx(Ne,{children:e.jsx(Gs,{})})]})};export{bt as component};
