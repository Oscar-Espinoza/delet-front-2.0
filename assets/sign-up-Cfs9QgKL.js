import{H as w,l as D,D as L,m as V,n as R,p as k,o as G,q as E,s as H,v as B,w as z,x as q,y as J,z as W,C as X,E as K,r as Q,k as Y,j as e,d as Z,B as $,t as m,L as ee}from"./index-LjicKyT0.js";import{C as se,a as te,b as re,c as ne,d as ae,e as oe}from"./card-COJmpkDS.js";import{A as ie}from"./auth-layout-onepyk7M.js";import{u as ce,a as le,F as me,b as f,c as h,d as S,e as x,f as C}from"./form-Bf5yBnbc.js";import{I as de}from"./input-Dlu4Ie9G.js";import{P as A}from"./password-input-Dd8k8BA2.js";import{A as b,v as pe,a as ue}from"./assertValidationError-DSHwLRL8.js";import{r as ge,a as p}from"./autoSignIn-BMLW60Lb.js";import{S as fe}from"./errors-CS9alWEK.js";import{o as he,s as U}from"./types-Wky072k2.js";import"./index-BWm_iZMh.js";import"./IconEye-C-p98rEo.js";import"./createReactComponent-Dm51iCRd.js";function N(t){return Object.entries(t).map(([s,n])=>({Name:s,Value:n}))}const Se=3*60*1e3;function xe(t){const s=w.listen("auth-internal",async({payload:a})=>{switch(a.event){case"confirmSignUp":a.data?.isSignUpComplete&&(w.dispatch("auth-internal",{event:"autoSignIn"}),s())}}),n=setTimeout(()=>{s(),clearTimeout(n),ge()},Se)}const Ce=()=>async t=>{if(t.statusCode>=300){const s=await k(t);if(G(s),s.name===fe.InvalidParameterException&&/'password'/.test(s.message)&&/Member must not be null/.test(s.message)){const n=b.EmptySignUpPassword,{message:a,recoverySuggestion:o}=pe[n];throw new E({name:n,message:a,recoverySuggestion:o})}throw new E({name:s.name,message:s.message})}return H(t)},Ue=t=>D(R,V("SignUp"),Ce(),{...L,...t});async function Ie(t){const{username:s,password:n,options:a}=t,o=B.getConfig().Auth?.Cognito,i=o?.signUpVerificationMethod??"code",{clientMetadata:u,validationData:r,autoSignIn:l}=t.options??{};z(o),ue(!!s,b.EmptySignUpUsername);const c=typeof l!="boolean"?l:void 0;c?.authFlowType;const{userPoolId:I,userPoolClientId:j,userPoolEndpoint:T}=o,_=Ue({endpointResolver:K({endpointOverride:T})}),y={Username:s,Password:void 0,UserAttributes:a?.userAttributes&&N(a?.userAttributes),ClientMetadata:u,ValidationData:r&&N(r),ClientId:j,UserContextData:q({username:s,userPoolId:I,userPoolClientId:j})};n&&(y.Password=n);const{UserSub:d,CodeDeliveryDetails:g,UserConfirmed:F,Session:M}=await _({region:W(I),userAgentValue:J(X.SignUp)},y);(c||l===!0)&&(p.dispatch({type:"START"}),p.dispatch({type:"SET_USERNAME",value:s}),p.dispatch({type:"SET_SESSION",value:M}));const v={destination:g?.Destination,deliveryMedium:g?.DeliveryMedium,attributeName:g?.AttributeName},O=!!F,P=p.getState().active;if(O)return P?{isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"},userId:d}:{isSignUpComplete:!0,nextStep:{signUpStep:"DONE"},userId:d};if(P){if(i==="link")return{isSignUpComplete:!1,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN",codeDeliveryDetails:v},userId:d};xe()}return{isSignUpComplete:!1,nextStep:{signUpStep:"CONFIRM_SIGN_UP",codeDeliveryDetails:v},userId:d}}const je=he({email:U().min(1,{message:"Please enter your email"}).email({message:"Invalid email address"}),password:U().min(1,{message:"Please enter your password"}).min(7,{message:"Password must be at least 7 characters long"}),confirmPassword:U()}).refine(t=>t.password===t.confirmPassword,{message:"Passwords don't match.",path:["confirmPassword"]});function ye({className:t,...s}){const[n,a]=Q.useState(!1),o=Y(),i=ce({resolver:le(je),defaultValues:{email:"",password:"",confirmPassword:""}});async function u(r){a(!0);try{await Ie({username:r.email,password:r.password,options:{userAttributes:{email:r.email}}}),m.success("Account created! Please check your email for verification code."),o({to:"/otp",search:{email:r.email}})}catch(l){const c=l;c.name==="UsernameExistsException"?m.error("An account with this email already exists"):c.name==="InvalidPasswordException"?m.error("Password does not meet requirements"):c.name==="InvalidParameterException"?m.error("Invalid email format"):m.error(c.message||"Failed to create account")}finally{a(!1)}}return e.jsx(me,{...i,children:e.jsxs("form",{onSubmit:i.handleSubmit(u),className:Z("grid gap-3",t),...s,children:[e.jsx(f,{control:i.control,name:"email",render:({field:r})=>e.jsxs(h,{children:[e.jsx(S,{children:"Email"}),e.jsx(x,{children:e.jsx(de,{placeholder:"name@example.com",...r})}),e.jsx(C,{})]})}),e.jsx(f,{control:i.control,name:"password",render:({field:r})=>e.jsxs(h,{children:[e.jsx(S,{children:"Password"}),e.jsx(x,{children:e.jsx(A,{placeholder:"********",...r})}),e.jsx(C,{})]})}),e.jsx(f,{control:i.control,name:"confirmPassword",render:({field:r})=>e.jsxs(h,{children:[e.jsx(S,{children:"Confirm Password"}),e.jsx(x,{children:e.jsx(A,{placeholder:"********",...r})}),e.jsx(C,{})]})}),e.jsx($,{className:"mt-2",disabled:n,children:n?"Creating Account...":"Create Account"})]})})}function ve(){return e.jsx(ie,{children:e.jsxs(se,{className:"gap-4",children:[e.jsxs(te,{children:[e.jsx(re,{className:"text-lg tracking-tight",children:"Create an account"}),e.jsxs(ne,{children:["Enter your email and password to create an account. ",e.jsx("br",{}),"Already have an account?"," ",e.jsx(ee,{to:"/sign-in",className:"hover:text-primary underline underline-offset-4",children:"Sign In"})]})]}),e.jsx(ae,{children:e.jsx(ye,{})}),e.jsx(oe,{children:e.jsxs("p",{className:"text-muted-foreground px-8 text-center text-sm",children:["By creating an account, you agree to our"," ",e.jsx("a",{href:"/terms",className:"hover:text-primary underline underline-offset-4",children:"Terms of Service"})," ","and"," ",e.jsx("a",{href:"/privacy",className:"hover:text-primary underline underline-offset-4",children:"Privacy Policy"}),"."]})})]})})}const Ve=ve;export{Ve as component};
